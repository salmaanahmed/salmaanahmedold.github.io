!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("MediaImageStudio",[],e):"object"==typeof exports?exports.MediaImageStudio=e():t.MediaImageStudio=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://static.parastorage.com/services/media-image-studio-opener/1.174.0/",r(r.s=23)}([function(t,e,r){"use strict";r.r(e),r.d(e,"__extends",(function(){return o})),r.d(e,"__assign",(function(){return i})),r.d(e,"__rest",(function(){return s})),r.d(e,"__decorate",(function(){return a})),r.d(e,"__param",(function(){return u})),r.d(e,"__metadata",(function(){return c})),r.d(e,"__awaiter",(function(){return f})),r.d(e,"__generator",(function(){return l})),r.d(e,"__exportStar",(function(){return p})),r.d(e,"__values",(function(){return d})),r.d(e,"__read",(function(){return h})),r.d(e,"__spread",(function(){return y})),r.d(e,"__spreadArrays",(function(){return m})),r.d(e,"__await",(function(){return v})),r.d(e,"__asyncGenerator",(function(){return g})),r.d(e,"__asyncDelegator",(function(){return b})),r.d(e,"__asyncValues",(function(){return w})),r.d(e,"__makeTemplateObject",(function(){return _})),r.d(e,"__importStar",(function(){return S})),r.d(e,"__importDefault",(function(){return I}));var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var i=function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function a(t,e,r,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function u(t,e){return function(r,n){e(r,n,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function f(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new r((function(e){e(t.value)})).then(s,a)}u((n=n.apply(t,e||[])).next())}))}function l(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function p(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function d(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function h(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(h(arguments[e]));return t}function m(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function v(t){return this instanceof v?(this.v=t,this):new v(t)}function g(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(t){o[t]&&(n[t]=function(e){return new Promise((function(r,n){i.push([t,e,r,n])>1||a(t,e)}))})}function a(t,e){try{(r=o[t](e)).value instanceof v?Promise.resolve(r.value.v).then(u,c):f(i[0][2],r)}catch(t){f(i[0][3],t)}var r}function u(t){a("next",t)}function c(t){a("throw",t)}function f(t,e){t(e),i.shift(),i.length&&a(i[0][0],i[0][1])}}function b(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:v(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=d(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}}function _(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function S(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function I(t){return t&&t.__esModule?t:{default:t}}},function(t,e,r){var n={EventEmitter:r(6),EmitterSubscription:r(2)};t.exports=n},function(t,e,r){"use strict";var n=function(t){function e(r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,r),this.listener=n,this.context=o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(r(7));t.exports=n},function(t,e,r){"use strict";var n=function(t){};t.exports=function(t,e,r,o,i,s,a,u){if(n(e),!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[r,o,i,s,a,u],l=0;(c=new Error(e.replace(/%s/g,(function(){return f[l++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(t,e,r){var n=r(10);"string"==typeof n&&(n=[[t.i,n,""]]);var o={singleton:!0,hmr:!0,transform:void 0,insertInto:void 0};r(12)(n,o);n.locals&&(t.exports=n.locals)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),o=r(14);e.urlParams=o;var i=r(19);e.hexToRgb=i.hexToRgb,e.rgbToHex=i.rgbToHex;var s=r(20);e.getImageUrl=s.getImageUrl,n.__exportStar(r(21),e)},function(t,e,r){"use strict";var n=r(2),o=r(8),i=r(9),s=r(3),a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._subscriber=new o,this._currentSubscription=null}return t.prototype.addListener=function(t,e,r){return this._subscriber.addSubscription(t,new n(this._subscriber,e,r))},t.prototype.once=function(t,e,r){var n=this;return this.addListener(t,(function(){n.removeCurrentListener(),e.apply(r,arguments)}))},t.prototype.removeAllListeners=function(t){this._subscriber.removeAllSubscriptions(t)},t.prototype.removeCurrentListener=function(){this._currentSubscription||s(!1),this._subscriber.removeSubscription(this._currentSubscription)},t.prototype.listeners=function(t){var e=this._subscriber.getSubscriptionsForType(t);return e?e.filter(i.thatReturnsTrue).map((function(t){return t.listener})):[]},t.prototype.emit=function(t){var e=this._subscriber.getSubscriptionsForType(t);if(e){for(var r=Object.keys(e),n=0;n<r.length;n++){var o=r[n],i=e[o];i&&(this._currentSubscription=i,this.__emitToSubscription.apply(this,[i].concat(Array.prototype.slice.call(arguments))))}this._currentSubscription=null}},t.prototype.__emitToSubscription=function(t,e){var r=Array.prototype.slice.call(arguments,2);t.listener.apply(t.context,r)},t}();t.exports=a},function(t,e,r){"use strict";var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.subscriber=e}return t.prototype.remove=function(){this.subscriber&&(this.subscriber.removeSubscription(this),this.subscriber=null)},t}();t.exports=n},function(t,e,r){"use strict";var n=r(3),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._subscriptionsForType={},this._currentSubscription=null}return t.prototype.addSubscription=function(t,e){e.subscriber!==this&&n(!1),this._subscriptionsForType[t]||(this._subscriptionsForType[t]=[]);var r=this._subscriptionsForType[t].length;return this._subscriptionsForType[t].push(e),e.eventType=t,e.key=r,e},t.prototype.removeAllSubscriptions=function(t){void 0===t?this._subscriptionsForType={}:delete this._subscriptionsForType[t]},t.prototype.removeSubscription=function(t){var e=t.eventType,r=t.key,n=this._subscriptionsForType[e];n&&delete n[r]},t.prototype.getSubscriptionsForType=function(t){return this._subscriptionsForType[t]},t}();t.exports=o},function(t,e,r){"use strict";function n(t){return function(){return t}}var o=function(){};o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(t){return t},t.exports=o},function(t,e,r){(e=t.exports=r(11)(!1)).push([t.i,"._1NZ04{position:fixed;top:0;left:0;z-index:6001;width:100%;height:100%;border:0}\n",""]),e.locals={mediaImageStudio:"_1NZ04"}},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var o=(s=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),i=n.sources.map((function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"}));return[r].concat(i).concat([o]).join("\n")}var s;return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r})).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];null!=i&&(n[i]=!0)}for(o=0;o<t.length;o++){var s=t[o];null!=s[0]&&n[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),e.push(s))}},e}},function(t,e,r){var n,o,i={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=n.apply(this,arguments)),o}),a=function(t,e){return e?e.querySelector(t):document.querySelector(t)},u=function(t){var e={};return function(t,r){if("function"==typeof t)return t();if(void 0===e[t]){var n=a.call(this,t,r);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),c=null,f=0,l=[],p=r(13);function d(t,e){for(var r=0;r<t.length;r++){var n=t[r],o=i[n.id];if(o){o.refs++;for(var s=0;s<o.parts.length;s++)o.parts[s](n.parts[s]);for(;s<n.parts.length;s++)o.parts.push(b(n.parts[s],e))}else{var a=[];for(s=0;s<n.parts.length;s++)a.push(b(n.parts[s],e));i[n.id]={id:n.id,refs:1,parts:a}}}}function h(t,e){for(var r=[],n={},o=0;o<t.length;o++){var i=t[o],s=e.base?i[0]+e.base:i[0],a={css:i[1],media:i[2],sourceMap:i[3]};n[s]?n[s].parts.push(a):r.push(n[s]={id:s,parts:[a]})}return r}function y(t,e){var r=u(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=l[l.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),l.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=u(t.insertAt.before,r);r.insertBefore(e,o)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=l.indexOf(t);e>=0&&l.splice(e,1)}function v(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=function(){0;return r.nc}();n&&(t.attrs.nonce=n)}return g(e,t.attrs),y(t,e),e}function g(t,e){Object.keys(e).forEach((function(r){t.setAttribute(r,e[r])}))}function b(t,e){var r,n,o,i;if(e.transform&&t.css){if(!(i="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=i}if(e.singleton){var s=f++;r=c||(c=v(e)),n=S.bind(null,r,s,!1),o=S.bind(null,r,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",g(e,t.attrs),y(t,e),e}(e),n=O.bind(null,r,e),o=function(){m(r),r.href&&URL.revokeObjectURL(r.href)}):(r=v(e),n=I.bind(null,r),o=function(){m(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=h(t,e);return d(r,e),function(t){for(var n=[],o=0;o<r.length;o++){var s=r[o];(a=i[s.id]).refs--,n.push(a)}t&&d(h(t,e),e);for(o=0;o<n.length;o++){var a;if(0===(a=n[o]).refs){for(var u=0;u<a.parts.length;u++)a.parts[u]();delete i[a.id]}}}};var w,_=(w=[],function(t,e){return w[t]=e,w.filter(Boolean).join("\n")});function S(t,e,r,n){var o=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=_(e,o);else{var i=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(i,s[e]):t.appendChild(i)}}function I(t,e){var r=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}function O(t,e,r){var n=r.css,o=r.sourceMap,i=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||i)&&(n=p(n)),o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var s=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,n=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var o,i=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?t:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?r+i:n+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(15),o="@json";e.encode=function(t){return n.stringify(Object.keys(t).reduce((function(e,r){var n;return e[r]="object"==typeof(n=t[r])?""+o+JSON.stringify(n):n,e}),{}))},e.decode=function(t){void 0===t&&(t=location.search);var e=n.parse(t);return Object.keys(e).forEach((function(t){var r;e[t]=0===(r=e[t]).indexOf(o)?JSON.parse(r.slice(o.length)):r})),e}},function(t,e,r){"use strict";const n=r(16),o=r(17),i=r(18);function s(t,e){return e.encode?e.strict?n(t):encodeURIComponent(t):t}function a(t,e){return e.decode?o(t):t}function u(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function c(t){const e=(t=u(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function f(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?t=Number(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()||(t="true"===t.toLowerCase()),t}function l(t,e){const r=function(t){let e;switch(t.arrayFormat){case"index":return(t,r,n)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===n[t]&&(n[t]={}),n[t][e[1]]=r):n[t]=r};case"bracket":return(t,r,n)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==n[t]?n[t]=[].concat(n[t],r):n[t]=[r]:n[t]=r};case"comma":return(t,e,r)=>{const n="string"==typeof e&&e.split("").indexOf(",")>-1?e.split(","):e;r[t]=n};default:return(t,e,r)=>{void 0!==r[t]?r[t]=[].concat(r[t],e):r[t]=e}}}(e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",parseNumbers:!1,parseBooleans:!1},e)),n=Object.create(null);if("string"!=typeof t)return n;if(!(t=t.trim().replace(/^[?#&]/,"")))return n;for(const o of t.split("&")){let[t,s]=i(o.replace(/\+/g," "),"=");s=void 0===s?null:a(s,e),r(a(t,e),s,n)}for(const t of Object.keys(n)){const r=n[t];if("object"==typeof r&&null!==r)for(const t of Object.keys(r))r[t]=f(r[t],e);else n[t]=f(r,e)}return!1===e.sort?n:(!0===e.sort?Object.keys(n).sort():Object.keys(n).sort(e.sort)).reduce((t,e)=>{const r=n[e];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort((t,e)=>Number(t)-Number(e)).map(t=>e[t]):e}(r):t[e]=r,t},Object.create(null))}e.extract=c,e.parse=l,e.stringify=(t,e)=>{if(!t)return"";const r=function(t){switch(t.arrayFormat){case"index":return e=>(r,n)=>{const o=r.length;return void 0===n?r:null===n?[...r,[s(e,t),"[",o,"]"].join("")]:[...r,[s(e,t),"[",s(o,t),"]=",s(n,t)].join("")]};case"bracket":return e=>(r,n)=>void 0===n?r:null===n?[...r,[s(e,t),"[]"].join("")]:[...r,[s(e,t),"[]=",s(n,t)].join("")];case"comma":return e=>(r,n,o)=>null==n||0===n.length?r:0===o?[[s(e,t),"=",s(n,t)].join("")]:[[r,s(n,t)].join(",")];default:return e=>(r,n)=>void 0===n?r:null===n?[...r,s(e,t)]:[...r,[s(e,t),"=",s(n,t)].join("")]}}(e=Object.assign({encode:!0,strict:!0,arrayFormat:"none"},e)),n=Object.keys(t);return!1!==e.sort&&n.sort(e.sort),n.map(n=>{const o=t[n];return void 0===o?"":null===o?s(n,e):Array.isArray(o)?o.reduce(r(n),[]).join("&"):s(n,e)+"="+s(o,e)}).filter(t=>t.length>0).join("&")},e.parseUrl=(t,e)=>({url:u(t).split("?")[0]||"",query:l(c(t),e)})},function(t,e,r){"use strict";t.exports=t=>encodeURIComponent(t).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`)},function(t,e,r){"use strict";var n=new RegExp("%[a-f0-9]{2}","gi"),o=new RegExp("(%[a-f0-9]{2})+","gi");function i(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],i(r),i(n))}function s(t){try{return decodeURIComponent(t)}catch(o){for(var e=t.match(n),r=1;r<e.length;r++)e=(t=i(e,r).join("")).match(n);return t}}t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},r=o.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var n=s(r[0]);n!==r[0]&&(e[r[0]]=n)}r=o.exec(t)}e["%C2"]="\ufffd";for(var i=Object.keys(e),a=0;a<i.length;a++){var u=i[a];t=t.replace(new RegExp(u,"g"),e[u])}return t}(t)}}},function(t,e,r){"use strict";t.exports=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const r=t.indexOf(e);return-1===r?[t]:[t.slice(0,r),t.slice(r+e.length)]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hexToRgb=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:void 0},e.rgbToHex=function(t){if(t){var e=t[0],r=t[1];return"#"+(16777216+(t[2]|r<<8|e<<16)).toString(16).slice(1)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getImageUrl=function(t){return"https://static.wixstatic.com/media/"+encodeURIComponent(t)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(22);e.resizeImage=function(t,r){void 0===r&&(r=n.MAX_IMAGE_SIZE);var o=e.limitImageSize({width:t.width,height:t.height},r),i=o.width,s=o.height,a=document.createElement("canvas");a.width=i,a.height=s;var u=a.getContext("2d");if(!u)throw new Error("unexpected error");return u.drawImage(t,0,0,a.width,a.height),a},e.fitSize=function(t,e){var r=Math.max(t.width/e.width,t.height/e.height);return{width:t.width/r,height:t.height/r}},e.fillSize=function(t,e){var r=Math.min(t.width/e.width,t.height/e.height);return{width:t.width/r,height:t.height/r}},e.limitImageSize=function(t,r){void 0===r&&(r=n.MAX_IMAGE_SIZE);var o=t.width,i=t.height,s=e.fitSize(t,{width:Math.min(n.MAX_IMAGE_SIZE,r),height:Math.min(n.MAX_IMAGE_SIZE,r)}),a=e.fillSize(t,{width:n.MIN_IMAGE_SIZE,height:n.MIN_IMAGE_SIZE});return o<a.width||i<a.height?a:o>s.width||i>s.height?s:{width:o,height:i}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_IMAGE_SIZE=3e3,e.MIN_IMAGE_SIZE=100},function(t,e,r){"use strict";r.r(e);var n,o,i,s,a,u,c,f,l=r(0);!function(t){t.UpdateSettings="updateSettings",t.IframeRequested="iframeRequested",t.IframeAppeared="iframeAppeared",t.IframeDisappeared="iframeDisappeared"}(n||(n={})),function(t){t.Free="free",t.Original="original",t.Square="square",t.R16_9="16:9",t.R4_3="4:3",t.R3_2="3:2"}(o||(o={})),function(t){t.Private="private",t.PrivateUser="privateUser",t.Public="public"}(i||(i={})),function(t){t.Default="",t.Transform="transform",t.Filters="filters",t.Adjust="adjust",t.Cutout="cutout"}(s||(s={})),function(t){t.v1_0="1.0.1",t.v1_1="1.1",t.v1_3="1.3"}(a||(a={})),function(t){t.Default="default",t.Upload="upload"}(u||(u={})),function(t){t.Portrait="Portrait",t.Object="Object",t.Logo="Logo",t.None="None"}(c||(c={})),function(t){t.Horizontal="horizontal_orientation",t.Vertical="vertical_orientation"}(f||(f={}));var p,d=r(1);!function(t){t.ImageData="imageData",t.UploadedFile="uploadedFile",t.Close="close"}(p||(p={}));var h,y=r(4);!function(t){t.FRAME_CLOSE="MEDIA_IMAGE_STUDIO.FRAME_CLOSE",t.IMAGE_DATA="MEDIA_IMAGE_STUDIO.IMAGE_DATA",t.UPLOADED_IMAGE="MEDIA_IMAGE_STUDIO.UPLOADED_IMAGE",t.READY="MEDIA_IMAGE_STUDIO.READY"}(h||(h={}));var m,v=["http://local.wix.com:3010","https://apps.wix.com",""],g=function(t){return t.data},b=function(){function t(t,e){var r=this;void 0===e&&(e={debug:!1}),this.targetFrame=t,this.options=e,this.messagesEmitter=new d.EventEmitter,this.readyPromise=void 0,this.handleMessage=function(t){if(-1!==v.indexOf(t.origin)){var e=g(t),n=e.type,o=e.data;r.messagesEmitter.emit(n,o)}}}return t.prototype.init=function(){window.addEventListener("message",this.handleMessage),this.waitForReady().catch((function(t){console.error("There was an error waiting for ready",t)}))},t.prototype.destroy=function(){window.removeEventListener("message",this.handleMessage)},t.prototype.sendMessage=function(t){var e=this,r=this.targetFrame.contentWindow;if(!r)throw Error('can not send message "'+JSON.stringify(t)+'", no contentWindow');this.waitForReady().then((function(){r.postMessage(t,e.getTargetOrigin())})).catch((function(t){console.error("There was an error waiting for ready",t)}))},t.prototype.waitForMessage=function(t){var e=this;return new Promise((function(r){e.messagesEmitter.once(t,(function(t){r(t)}))}))},t.prototype.waitForClose=function(){return this.waitForMessage(h.FRAME_CLOSE)},t.prototype.waitForImageData=function(){var t=this;return new Promise((function(e){t.messagesEmitter.once(h.IMAGE_DATA,(function(t){var r=t.imageBuffer,n=t.mime;e(new Blob([new Uint8Array(r)],{type:n}))}))}))},t.prototype.waitForUploadedImage=function(){return this.waitForMessage(h.UPLOADED_IMAGE)},t.prototype.waitForReady=function(){return this.readyPromise||(this.readyPromise=this.waitForMessage(h.READY)),this.readyPromise},t.prototype.getTargetOrigin=function(){return this.options.debug?"http://local.wix.com:3010":"https://apps.wix.com/media-image-studio"},t}(),w=r(5);!function(t){t.Prod="https://apps.wix.com/media-image-studio",t.Local="http://local.wix.com:3010"}(m||(m={}));var _=function(){function t(t){var e=t.url,r=void 0===e?m.Prod:e,n=t.appendTo,a=void 0===n?document.body:n,f=t.title,l=void 0===f?"Media Image Studio":f,p=t.saveStrategy,h=void 0===p?u.Default:p,y=t.targetFolder,v=t.segmentationType,g=void 0===v?c.Portrait:v,b=t.siteToken,w=t.mediaRoot,_=void 0===w?"":w,S=t.initiator,I=void 0===S?"Unknown":S,O=t.metasiteId,E=void 0===O?"":O,x=t.isUserLevelFile,M=void 0!==x&&x,j=t.mode,A=void 0===j?s.Default:j,T=t.fileId,R=t.fileSource,U=void 0===R?i.Private:R,F=t.defaultRatio,P=void 0===F?o.Free:F,C=t.isFixedRatio,L=void 0!==C&&C,D=t.locale,N=t.crop,k=t.instance,G=t.isSiteVisitorMode;this.transport=void 0,this.iframe=void 0,this.messageEmitter=new d.EventEmitter,this.requestId=0,this.iframeOptions={url:r,appendTo:a,title:l},this.permanentOptions={initiator:I,metasiteId:E,siteToken:b,mediaRoot:_,saveStrategy:h,segmentationType:g,isUserLevelFile:M,locale:D,instance:k,isSiteVisitorMode:G},this.showOptions={fileId:T,fileSource:U,mode:A,isFixedRatio:L,defaultRatio:P,crop:N,targetFolder:y}}return t.prototype.preload=function(){this.iframe||(this.iframe=this.init(this.showOptions),this.hide())},t.prototype.sendClose=function(){this.emitMessage({type:p.Close,payload:void 0})},t.prototype.hide=function(){this.iframe&&(this.sendClose(),this.iframe.style.display="none",this.transport&&this.transport.sendMessage({type:n.IframeDisappeared,data:{requestId:this.requestId,ts:Date.now()}}))},t.prototype.kill=function(){if(this.iframe){var t=this.iframe.parentNode;t&&t.removeChild(this.iframe),this.iframe=void 0,this.transport&&(this.transport.destroy(),this.transport=void 0),this.sendClose(),this.messageEmitter.removeAllListeners()}},t.needsSendOptions=function(t){return Object.keys(t).some((function(e){return void 0!==t[e]}))},t.prepareShowOptions=function(t){void 0===t&&(t={});var e=t.fileId,r=t.fileUrl,n=(t.isUpload,l.__rest(t,["fileId","fileUrl","isUpload"]));return e?l.__assign({fileId:e},n):r?l.__assign({fileUrl:r},n):t},t.prototype.show=function(e){var r=this;void 0===e&&(e={});var o=t.prepareShowOptions(e);this.requestId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);var i=Date.now(),s=Boolean(this.iframe)&&t.needsSendOptions(o);this.iframe||(this.iframe=this.init(o));var a=this.iframe;if(s){if(!this.transport)throw Error("transport is not created when showing iframe");this.transport.sendMessage({type:n.UpdateSettings,data:o})}this.transport||(this.transport=this.initTransport(a)),this.transport.sendMessage({type:n.IframeRequested,data:{requestId:this.requestId,ts:i}}),this.transport.waitForClose().then((function(){r.hide()})).catch((function(t){console.error("Error waiting for close",t)})),this.transport.waitForImageData().then((function(t){r.emitMessage({type:p.ImageData,payload:t})})).catch((function(t){console.error("Error waiting for image",t)})),this.transport.waitForUploadedImage().then((function(t){r.emitMessage({type:p.UploadedFile,payload:t})})).catch((function(t){console.error("Error waiting for upload image",t)})),setTimeout((function(){var t=Date.now();if(!r.transport)throw new Error("transport is not inited");r.transport.sendMessage({type:n.IframeAppeared,data:{requestId:r.requestId,ts:t}}),a.style.display="block";var e=a.contentWindow;e&&e.focus()}),100)},t.prototype.on=function(t,e){return this.messageEmitter.addListener(t,e)},t.prototype.once=function(t,e){return this.messageEmitter.once(t,e)},t.prototype.emitMessage=function(t){this.messageEmitter.emit(t.type,t.payload)},t.prototype.getURL=function(t){return function(t,e,r){var n=t.replace(/\/$/,""),o=r.mode,i=l.__rest(r,["mode"]);void 0!==o&&o!==s.Default&&(n=n+"/"+o);var a=l.__assign({},e,i);return n+"?"+w.urlParams.encode(a)}(this.iframeOptions.url,this.permanentOptions,t)},t.prototype.initTransport=function(t){var e,r,n=(e=t,void 0===(r={debug:this.iframeOptions.url===m.Local})&&(r={debug:!1}),new b(e,r));return n.init(),n},t.prototype.init=function(t){this.permanentOptions.isUserLevelFile&&console.warn("isUserLevelFile is deprecated. Use fileSource=FileSource.PrivateUser instead");var e=document.createElement("iframe");return e.src=this.getURL(t),e.id="mediaImageStudio",e.className=y.mediaImageStudio,e.title=this.iframeOptions.title,this.iframeOptions.appendTo.appendChild(e),this.transport=this.initTransport(e),e},t}();r.d(e,"MediaImageStudio",(function(){return _})),r.d(e,"MediaImageStudioURL",(function(){return m})),r.d(e,"MediaImageStudioEvents",(function(){return p})),r.d(e,"MediaImageStudioMode",(function(){return s})),r.d(e,"SaveStrategy",(function(){return u})),r.d(e,"SegmentationType",(function(){return c})),r.d(e,"CropRatio",(function(){return o}));e.default=_}])}));
//# sourceMappingURL=MediaImageStudio.bundle.min.js.map