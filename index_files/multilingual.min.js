var _slicedToArray=function(e,a){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,a){var n=[],t=!0,l=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(t=(o=s.next()).done)&&(n.push(o.value),!a||n.length!==a);t=!0);}catch(e){l=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(l)throw i}}return n}(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")};define("multilingual/panels/multilingualManage/multilingualManagePanelMapper",["constants","lodash","stateManagement"],function(e,g,p){"use strict";var a=p.multilingual,n=a.actions,c=a.selectors,t=p.panels.actions.closePanelByName,l=n.addLanguageThunk,i=n.loadSupportedLanguagesThunk,o=n.initializeLanguagesThunk,s=n.updateLanguageStatusThunk,u=n.addLanguageSelectorToSiteHeaderThunk,r=n.openLanguageSelectorThunk,d=n.loadLanguagesThunk,m=n.initializeAppThunk,h=n.sendOpenOnboardingEventThunk,L=n.loadSupportedLanguagesSuccess,f=e.MULTILINGUAL.linguistDefId;return{mapStateToProps:function(e){var a=e.state,n=e.dsRead.language,t=c.supportedLanguages(a),l=c.loading(a),i=n.original.get(),o=n.get(),s=g.differenceBy(t,o,"languageCode"),u=p.editorPlugins.appsStore.selectors.getAppStore(a,f),r=void 0;return r=i.languageCode?g.differenceBy(s,[i],"languageCode"):s,{isEnabled:n.multilingual.isEnabled(),nonDeletedTranslationLanguages:o,choicesForOriginalLanguages:s,supportedLanguages:t,availableLanguages:r,originalLanguage:i,loading:l,tpaMlState:u}},mapDispatchToProps:function(n){return{addLanguage:function(e){return n(l(e))},updateMultilingual:function(){return n(d())},initMultilingualPlatformApp:function(){return n(m())},loadSupportedLanguages:function(){return n(i())},resetSupportedLanguages:function(){return n(L([]))},updateLanguageStatus:function(e,a){return n(s(e,a))},initializeLanguages:function(e,a){return n(o(e,a))},closePanelByName:function(e,a){return n(t(e,a))},addLanguageSelectorToSiteHeader:function(e){return n(u(e))},sendOpenOnboardingEvent:function(e){return n(h(e))},openLanguageSelector:function(){return n(r())}}}}}),define("multilingual/panels/multilingualManage/multilingualManagePanel.rt",["react","lodash","panels","baseUI","baseUILib","santa-editor-symbols","util","helpIds"],function(l,a,n,i,o,e,t,s){"use strict";return function(){return this.areSupportedLanguagesLoaded()?function(){var e=t.translate;return l.createElement("div",{key:"multilingual-manager-panel"},this.props.isEnabled?l.createElement(n.frames.focusPanelFrame,{key:"multilingual-manage-panel",className:"multilingual-manage-panel",title:e("Manage_Languages_Title"),helpId:s.LAYOUT.LANGUAGE_SELECTOR_MANAGE,panelName:this.props.panelName},l.createElement("div",{className:"content"},l.createElement("div",{className:"original-language-container"},l.createElement(o.TextLabel,{shouldTranslate:!1,value:"Main Language"}),l.createElement(o.RichText,{},l.createElement(o.TextLabel,{value:this.getLangLabel(this.props.originalLanguage),type:"T03",shouldTranslate:!1}))),l.createElement(i.sectionDividerLabeled,{label:"Additional Languages",shouldTranslate:!1}),l.createElement.apply(this,[o.CustomScroll,{flex:"1"},a.map(this.props.nonDeletedTranslationLanguages,function(e,a,n){var t=this;return l.createElement("div",{key:n},l.createElement("div",{className:"composite-action-set-horizontal"},l.createElement(o.RichText,{},l.createElement(o.TextLabel,{value:this.getLangLabel(a),type:"T03",shouldTranslate:!1})),l.createElement(o.Tooltip,{content:"Manage_Languages_Site_Delete_Tooltip"},l.createElement(o.Button,{className:"btn-delete btn-sm",onClick:function(e,a,n){this.removeLanguage(a)}.bind(this,e,a,n)},l.createElement(i.symbol,{name:"delete"}))),l.createElement(o.Tooltip,{content:"Manage_Languages_Site_Show_Language_Tooltip"},l.createElement(o.ToggleSwitch,{className:"lang-toggle",value:this.isPublic(a),onChange:function(){return t.togglePublic(a)}}))),l.createElement("hr",{className:"divider-short"}))}.bind(this,e)),this.state.isAddingNewLanguage?l.createElement("div",{key:"new-language-add-section"},l.createElement(o.Composites.DropDownLabeled,{},l.createElement(o.TextLabel,{value:"Language",shouldTranslate:!1}),l.createElement.apply(this,[o.DropDown,{shouldTranslate:!1,placeholder:e("Manage_Languages_Site_Languages_Choose_Language"),openOnSelected:!0,onChange:this.onAddLanguage},a.map(this.props.availableLanguages,function(e,a,n){return l.createElement(o.DropDownOption,{shouldTranslate:!1,key:n,value:a,label:this.getLangLabel(a)})}.bind(this,e))])),l.createElement("hr",{className:"divider-long"})):null,this.state.isAddingNewLanguage?null:l.createElement(o.Composites.ButtonLeft,{key:"new-language-button"},l.createElement(o.Button,{className:"btn-text",onClick:this.addNewLanguage},e("Manage_Languages_New_Language")))])),l.createElement(o.Composites.ActionSetHorizontal,{},l.createElement(o.Button,{className:"btn-md",onClick:this.onConfirm},e("Notification_Box_Save_Button")))):null,this.props.isEnabled?null:l.createElement(n.frames.focusPanelFrame,{key:"multilingual-init-panel",className:"multilingual-init-panel",shouldHideHeader:!0,isSingleInstance:this.props.isSingleInstance,panelName:this.props.panelName,shouldNotCloseOnBlur:this.props.shouldNotCloseOnBlur},l.createElement("div",{className:"popup-template-panel"},l.createElement("div",{className:"panel-header dark"},l.createElement(o.HelpButton,{}),l.createElement(o.CloseButton,{onClick:this.onClose}),l.createElement("h1",{},"Welcome to Multilingual"),l.createElement("h3",{},"Start adding languages to your site."),l.createElement("div",{className:"image"},l.createElement(i.symbol,{key:"symbol",name:"onlineStoreManager",className:"popup-symbol"}))),l.createElement("div",{className:"content"},l.createElement("div",{className:"panel-text"},l.createElement(o.Composites.DropDownLabeled,{},l.createElement(o.TextLabel,{shouldTranslate:!1,value:"What's the main language of your site?"}),l.createElement.apply(this,[o.DropDown,{value:this.state.originalLanguage,shouldTranslate:!1,placeholder:e("ML_MANAGER_CHOOSE_LANGUAGE"),openOnSelected:!0,onChange:this.onInitialOriginalLanguageChange},a.map(this.props.availableLanguages,function(e,a,n){return l.createElement(o.DropDownOption,{shouldTranslate:!1,key:n,value:a,label:this.getLangLabel(a)})}.bind(this,e))])))),l.createElement(o.Composites.ActionSetHorizontalSpaced,{},l.createElement(o.Button,{className:"secondary btn-md",onClick:this.onClose},l.createElement("span",{},e("Notification_Box_Cancel_Button"))),l.createElement(o.Button,{disabled:!this.state.originalLanguage,className:"btn-md",onClick:this.enableMultilingual},l.createElement("span",{},e("Notification_Box_Next_Button")))))))}.apply(this,[]):null}}),define("multilingual/panels/multilingualManage/multilingualManagePanel",["constants","addPanel","create-react-class","prop-types","lodash","multilingual/panels/multilingualManage/multilingualManagePanelMapper","multilingual/panels/multilingualManage/multilingualManagePanel.rt","higherOrderComponents","util","stateManagement"],function(e,a,n,t,l,i,o,s,u,r){"use strict";var g=r.multilingual.actionTypes.MULTILINGUAL_LOAD_STOP,p=e.MULTILINGUAL,c=p.LANGUAGE_STATUSES,d=p.linguistDefId,m=i.mapStateToProps,h=i.mapDispatchToProps,L=n({displayName:"multilingualManagePanel",propTypes:{title:t.string,subtitle:t.string,panelName:t.string,supportedLanguages:t.arrayOf(t.object),translationLanguages:t.arrayOf(t.object),nonDeletedTranslationLanguages:t.arrayOf(t.object),activeTranslationLanguages:t.arrayOf(t.object),originalLanguage:t.object,isEnabled:t.bool,availableLanguages:t.arrayOf(t.object),choicesForOriginalLanguages:t.arrayOf(t.object),loading:t.shape({isLoading:t.bool,trigger:t.string}),addLanguage:t.func,loadSupportedLanguages:t.func.isRequired,updateMultilingual:t.func.isRequired,initMultilingualPlatformApp:t.func.isRequired,initializeLanguages:t.func.isRequired,addLanguageSelectorToSiteHeader:t.func.isRequired,closePanelByName:t.func.isRequired,updateLanguageStatus:t.func.isRequired,resetSupportedLanguages:t.func.isRequired,tpaMlState:t.object,sendOpenOnboardingEvent:t.func.isRequired,openLanguageSelector:t.func.isRequired},getInitialState:function(){var a=this;return!this.props.loading.isLoading&&l.isEmpty(this.props.supportedLanguages)&&this.props.initMultilingualPlatformApp().then(function(e){_slicedToArray(e,1)[0]&&(a.props.originalLanguage&&a.props.originalLanguage.languageCode?require(["tpa"],function(e){e.superApps.openDashboardUrl(d,{state:"",widgetless:!0,title:null,origin:"gfpp_languageSelector",onClose:function(){a.props.updateMultilingual(),a.onClose()},shouldNotCloseOnBlur:!1,isBareMode:!1},{type:"constants.BI.type.GFPP_MANAGE"}),u.fedopsLogger.interactionStarted(u.fedopsLogger.INTERACTIONS.BM_MULTILINGUAL)}):a.props.sendOpenOnboardingEvent())}).catch(function(){a.props.resetSupportedLanguages(),a.onClose()}),{originalLanguage:this.props.originalLanguage,isAddingNewLanguage:!1,shouldAddElement:!1,isMultilingual:this.props.isEnabled}},componentDidUpdate:function(e){var a=this;e.tpaMlState!==this.props.tpaMlState&&(this.addComponentToHeader(),u.fedopsLogger.interactionEnded(u.fedopsLogger.INTERACTIONS.ONBOARDING_MULTILINGUAL),this.props.updateMultilingual().then(function(){a.props.openLanguageSelector()}))},componentWillUnmount:function(){this.state.shouldAddElement&&this.addComponentToHeader()},addComponentToHeader:function(){var e=a.sections.getSections().menu.languageSelectorSection.props.items[0];this.props.addLanguageSelectorToSiteHeader(e)},getKeyboardShortcuts:function(){return{enter:function(){this.onNext()},esc:function(){this.onClose()}}},isPublic:function(e){return e.status===c.ACTIVE},togglePublic:function(e){var a=e.status===c.ACTIVE?c.INACTIVE:c.ACTIVE;this.props.updateLanguageStatus(e.languageCode,a)},getLangLabel:function(e){return l.isUndefined(e)||e&&!e.languageCode?"NO_LANGUAGE":e.name+" ("+e.languageCode.toUpperCase()+")"},onOriginalLanguageEdit:function(){this.setState({isEditingOriginalLanguage:!0})},areSupportedLanguagesLoaded:function(){return!!this.props.supportedLanguages.length},onInitialOriginalLanguageChange:function(e){this.setState({originalLanguage:e})},addNewLanguage:function(){this.setState({isAddingNewLanguage:!0})},onAddLanguage:function(e){var a=this;return this.props.addLanguage(l.assign({},e,{locale:e.defaultLocale})).then(function(){a.setState({isAddingNewLanguage:!1})})},removeLanguage:function(e){return this.props.updateLanguageStatus(e.languageCode,c.DELETED)},enableMultilingual:function(){var a=this,e=this.state.originalLanguage;return this.props.initializeLanguages(l.assign({},e,{locale:e.defaultLocale})).then(function(e){e.type!==g||e.error||a.setState({shouldAddElement:!0,isMultilingual:!0})})},onClose:function(){this.props.closePanelByName(this.props.panelName)},onConfirm:function(){this.onClose()},onNext:function(){this.state.isMultilingual?this.onClose():this.state.originalLanguage&&this.enableMultilingual()},render:o}),f=l.flow(u.hoc.renderWhenMutated,u.hoc.connect(u.hoc.STORES.STATE_AND_DS,m,h),s.noUpdateOnMouseMove)(L);return f.pure=L,f}),define("multilingual",["multilingual/panels/multilingualManage/multilingualManagePanel"],function(e){"use strict";var a="multilingual.panels.multilingualManagePanel",n={title:"ML_MANAGER_TITLE",subtitle:"ML_MANAGER_SUBTITLE"};return{panelName:a,panelOptions:n,panels:{multilingualManagePanel:e},openMultilingualManagePanel:function(e){e.panelManager.openPanel(a,n)}}});
//# sourceMappingURL=multilingual.min.js.map