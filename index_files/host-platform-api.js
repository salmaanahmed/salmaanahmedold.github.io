!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash"),require("coreUtilsLib"),require("platformUtils"),require("prop-types"),require("mobx")):"function"==typeof define&&define.amd?define(["lodash","coreUtilsLib","platformUtils","prop-types","mobx"],t):"object"==typeof exports?exports["host-platform-api"]=t(require("lodash"),require("coreUtilsLib"),require("platformUtils"),require("prop-types"),require("mobx")):e["host-platform-api"]=t(e.lodash,e.coreUtilsLib,e.platformUtils,e["prop-types"],e.mobx)}(this,(function(e,t,n,o,i){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=18)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";e.exports={APPS:{SANTA_MEMBERS:{appDefId:"14cc59bc-f0b7-15b8-e1c7-89ce41d0e0c9"},FORM_BUILDER:{appDefId:"14ce1214-b278-a7e4-1373-00cebd1bef7c"}},WIX_CODE_NAMESPACES_AND_ELEMENTORY_SUPPORT_PATH:"/wixCodeNamespacesAndElementorySupport.min.js",DATA_BINDING:"dataBinding",SEMI_NATIVE_SDK_URL:"http://static.parastorage.com/services/semi-native-sdk/1.3.0/lib/wix.min.js",PM_RPC_INTENTS:{INVOKE:"invoke",RPC_RESOLVE:"rpc-resolve",RPC_REJECT:"rpc-reject",API_DESCRIPTION:"api-desc",INVOKE_FUNCTION:"invoke-func",RESOLVE:"resolve",REJECT:"reject",REQUEST_API:"request-api"},WIX_CODE:{MESSAGE_INTENT:{WIX_CODE_MESSAGE:"WIX_CODE",WIX_CODE_SITE_API:"WIX_CODE_SITE_API",WIX_CODE_APP_API:"WIX_CODE_APP_API",SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE:"SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE",SANTA_APPLICATION_CHANNEL_MESSAGE:"SANTA_APPLICATION_CHANNEL_MESSAGE"},MESSAGE_TYPE:{CONSOLE:"console",IFRAME_COMMAND:"wix_code_iframe_command",GOOGLE_ANALYTICS:"googleAnalytics",UPDATE_WIX_CODE_MODEL_DATA_AFTER_LOGIN:"update_wix_code_model_data_after_login",REQUEST_API:"REQUEST_API",PERFORMANCE_METRICS_READY:"performance_metrics_ready",PLATFORM_PUBLIC_API_PREFIX:"viewer_platform_public_api_",OPEN_MESSAGE_CHANNEL:"openMessageChannel",SANTA_READY:"santaReady",SANTA_PAGE_CHANGE:"santaPageChange",WIX_CODE_WORKER_BI_DATA_UPDATE:"wix_code_worker_bi_data_update"}}}},function(e,t,n){"use strict";var o=n(0),i=n(4),r=n(1),a=n(5),s=i.RemoteModelInterface,d=i.RemoteGlobalsInterface,c=i.componentsHooks,p=function(e){var t=e.runtimeDal,n=e.compIds,i=e.contextId,r=e.getCompReactClass;if(o.isFunction(t.getPlatformModels)){var s=t.getPlatformModels(i);return{components:s.components,connections:s.connections}}return{components:n.reduce((function(e,n){return e[n]=a.getCompModel({runtimeDal:t,compId:n,contextId:i,getCompReactClass:r}),e}),{}),connections:a.getConnectionsModel({runtimeDal:t,compIds:n,contextId:i})}};e.exports={generateRemoteModelInterface:function(e){var t=e.runtimeDal,n=e.compIds,i=e.siteStructureData,d=e.pageData,u=e.widgetProperties,l=e.onUpdateCallback,f=e.contextId,g=e.getCompReactClass,m=e.getGhostStructure,h=new s(void 0,l);h.registerHook(h.getHooks().data,"wysiwyg.viewer.components.Repeater",c.repeaters.updateRepeaterItems);var v=p({runtimeDal:t,compIds:n,contextId:f,getCompReactClass:g}),y=v.components,I=v.connections;if(o.forEach(o.keys(y),(function(e){return h.addComponent(e,y[e])})),h.addSiteStructure(i),h.addPageData(d),h.addConnections(I),m){var _=a.getGhostCompAndConnectionsModels({ghostStructure:m(),runtimeDal:t,compIds:n,realComponents:y,realConnections:I}),C=_.ghostComps,A=_.ghostConnections;o.forEach(o.keys(C),(function(e){return h.addComponent(e,C[e],!0)})),h.addConnections(A)}return h.resetComponentsScope(),h.addEventTypes(r.siteConstants.ACTION_TYPES),h.updateWidgetProperties(u),h.setRenderType("santa"),h},createRemoteModelInterface:function(e,t){var n=new s(e,t);return n.registerHook(n.getHooks().data,"wysiwyg.viewer.components.Repeater",c.repeaters.updateRepeaterItems),n},generateRemoteGlobalsInterface:function(e){var t=e.navigationData,n=e.sessionInfo,o=e.siteRevision,i=e.siteMemberData,r=e.multilingualInfo,a=e.appsData,s=e.isApplicationStudio,c=e.deviceType,p=e.lightboxContext,u=e.contextId,l=e.isMobileFriendly,f=e.livePreviewMode,g=e.regionalSettings,m=e.routerData,h=new d;return h.addNavigation(t),h.addSiteMemberData(i),h.addMultilingualInfo(r),h.addAppsData(a),h.addSessionInfoProp(n),h.addSiteRevision(o),h.addDeviceType(c),h.addIsMobileFriendly(l),h.addLightboxContext(p),h.addContextId(u),h.addLivePreviewMode(f),h.addIsApplicationStudio(s),h.addRegionalSettings(g),h.addRouterData(m),h}}},function(e,t){e.exports=n},function(e,t,n){"use strict";var o=n(0),i=n(1),r=n(19),a="wysiwyg.viewer.components.Repeater";var s=function(e,t,n,i,a){return e?r.generateGhostCompId(e,t):function(e,t,n){return o.keys(o.get(e,[t,n]))[0]}(a,t,o.findKey(n,(function(e){return o.includes(e.children,i)})))||null},d=function(e,t,n,i,a,d,c,p){o.forEach(e,(function(u,l){var f=t[l],g=r.generateGhostCompId(u.id,n),m=i.get(l),h=o.map(m,"structureId");o.forEach(m,(function(e){var t=e.structureId;delete e.structureId,o.set(a,t,e),o.set(d,[n,l,t],null)}));var v=o.assign({},u,{id:l,data:u.data||{},design:u.design||{},parent:s(f,n,c,l,p),type:u.componentType,children:r.getChildrenForGhost(e,u.children||[],n),displayedOnlyComponents:h,isDisplayed:!i.has(l),displayedRoot:o.get(u,"displayedRoot",null)});o.set(d,[n,l,g],null),o.set(a,g,v)}))};e.exports={getCompModel:function(e){var t=e.runtimeDal,n=e.compId,r=e.contextId,s=e.getCompReactClass,d=t.getCompType(n),c=function(e,t){return e.getAncestorOfType(t,a)}(t,n),p=function(e,t){return!i.displayedOnlyStructureUtil.isDisplayedComponent(e)&&t}(n,!!c),u=function(e,t,n,i,r){var a={data:e.getCompData(t,r),fullData:e.getCompData(t,!0),props:e.getCompProps(t,r)},s=e.getCompState(t);if(o.isUndefined(s)||o.isEmpty(s))return function(e,t,n){var o=n(t);return o&&o.publicState?o.publicState(null,e):{}}(a,n,i);return s}(t,n,d,s,p),l=t.getActionsAndBehaviors(n),f=i.displayedOnlyStructureUtil.isDisplayedComponent(n);return{parent:t.getParentId(n),type:d,state:u,layout:t.getCompLayout(n),design:t.getCompDesign(n,p),isDisplayed:t.isDisplayed(n),id:t.getCompName(n),data:t.getCompData(n,p),style:t.getCompStyle(n),fullData:t.getCompData(n,!0),props:t.getCompProps(n,p),children:t.getChildrenIds(n),events:o.map(l,(function(e){return o.assign({eventType:o.get(e,"action.name")},o.get(e,"behavior.params"))})),displayedRoot:f&&c?o.get(c,"id"):null,displayedOnlyComponents:f?[]:o.map(t.getDisplayedOnlyCompsForFullComp(n,r),"id")}},getConnectionsModel:function(e){var t=e.runtimeDal,n=function(e,t,n){return o.reduce(e,(function(e,i){var r=t.getCompConnections(i),a=o.map(r,(function(e){return{connection:"WixCodeConnectionItem"===e.type?o.assign({},e,{controllerId:n,config:null}):o.defaults({},e,{config:null}),compId:i}}));return e.concat(a)}),[])}(e.compIds,t,e.contextId);return o(n).groupBy("connection.controllerId").mapValues((function(e){return o(e).groupBy("connection.role").mapValues((function(e){return o(e).keyBy("compId").mapValues("connection.config").value()})).value()})).value()},getGhostCompAndConnectionsModels:function(e){var t=e.ghostStructure,n=void 0===t?{}:t,i=e.runtimeDal,s=e.compIds,c=e.realComponents,p=e.realConnections,u={},l={},f=new Map,g={},m=function(e,t){return o(e).flatMap(t.getCompConnections).filter("controllerId").groupBy("controllerId").mapValues((function(e){return new Set(o.map(e,"role"))})).value()}(s,i),h=o(c).map("data").compact().keyBy("id").value();return o.forEach(m,(function(e,t){var i=h[t]||{},s=i.applicationId,c=i.settings,m=(c=void 0===c?{}:c).type,v=o.get(n,[s,m],{}),y=o.reduce(v,(function(n,i,s){if(!e.has(s)){var d,c=o.get(i,"children");return o.isEmpty(c)||o.forEach(c,(function(e){var t;return o.assign(g,((t={})[e]=o.get(i,"id"),t))})),i.componentType===a&&r.createGhostDisplayedOnlyComps({fallbackStructure:v,repeater:i,displayedOnlyComps:f,controllerId:t}),o.assign(n,((d={})[s]=i,d))}return n}),{});d(y,g,t,f,u,l,v,p)})),{ghostComps:u,ghostConnections:l}}}},function(e,t,n){"use strict";var o=n(0),i={PAGE:"Page",POPUP:"Popup",UNKNOWN:"Unknown"};var r=["Page","AppPage"];e.exports={getApi:function(e){return{RMI:{fetchData:e.getDataByQuery.bind(e),fetchSiteStructure:e.getSiteStructureForRmi.bind(e),fetchPageData:e.getPageDataForRmi.bind(e),fetchWidgetData:e.getAppStudioWidgetProperties.bind(e)},RGI:{fetchNavigationData:e.getNavigationDataForRgi.bind(e),fetchSessionInfo:e.getSessionInfoForRgi.bind(e),fetchSiteRevision:e.getSiteRevisionForRgi.bind(e),fetchDeviceType:e.getDeviceType.bind(e),fetchIsMobileFriendly:e.isMobileOptimizedOn.bind(e),fetchSiteMemberData:e.getSMbySiteExtensionInstanceForRgi.bind(e),fetchMultilingualInfo:e.getMultilingualInfoForRgi.bind(e),fetchAppsData:e.getAppsDataForRgi.bind(e),fetchIsApplicationStudio:e.isApplicationStudio.bind(e),fetchRouterData:e.getRouterDataForRgi.bind(e),fetchRegionalSettings:e.getRegionalSettingsForRgi.bind(e)}}},getWidgetType:function(e){return o.includes(r,o.get(e,"type"))?o.get(e,"isPopup")?i.POPUP:i.PAGE:i.UNKNOWN},WIDGET_TYPES:i}},,,,function(e,t,n){"use strict";var o=n(0),i=n(1);function r(e,t,n,i){var r=e.filterValidContextsForLoad,a=void 0===r?o.identity:r,c=e.filterContextsToSync,p=void 0===c?o.identity:c,u=e.filterContextsToActivate,l=void 0===u?o.identity:u,f=e.getContextInitData,g=e.getApplicationsForContexts,m=g(n=p(n));if(o.isEmpty(m))return t;var h=o.difference(n,o.map(t,"rootId"));h=l(h),t=function(e,t,n,i,r,a){return o.isEmpty(t)||(r=s(n,r,e,a),o.isEmpty(r)||d(t,a,i)),r}(a(n),h,g,f,t,i);var v,y,I=o(t).reject({started:!0}).map("rootId").value();return o.isEmpty(I)?t:(i.startWidgets(I),v=t,y=I,t=o.map(v,(function(e){return o.includes(y,e.rootId)?o.assign(e,{started:!0}):e})))}function a(e,t,n){return o.isEmpty(t)||o.isEmpty(e)?e:(n.stopWidgets(t),o.reject(e,(function(e){return o.includes(t,e.rootId)})))}function s(e,t,n,i,r){if(o(n).difference(o.map(t,"rootId")).thru(o.isEmpty).value())return t;var a=e(n);if(o.isEmpty(a))return t;i.loadWidgets(a,n,r);var s=o.map(n,(function(e){return{rootId:e}}));return t.concat(s)}function d(e,t,n){var r=o.without(e,i.siteConstants.MASTER_PAGE_ID),a=o(r).transform((function(e,t){e[t]=n(t)}),{}).omitBy(o.isEmpty).value();o.isEmpty(a)||t.initWidgets(a)}e.exports={syncAppsState:function(e,t,n,i){var s=t.getContextIdsWhichShouldBeRendered,d=t.filterValidContextsForLoad,c=t.filterContextsToSync,p=t.filterContextsToActivate,u=t.getContextInitData,l=t.getApplicationsForContexts,f=s();return e?r({filterValidContextsForLoad:d,filterContextsToSync:c,filterContextsToActivate:p,getContextInitData:u,getApplicationsForContexts:l},n=a(n,function(e,t){var n=o.reject(e,(function(e){return o.includes(t,e.rootId)}));return o.map(n,"rootId")}(n,f),i),f,i):a(n,f,i)},loadApps:s,initApps:d,stopApps:function(e,t,n,i){var r=function(e,t){var n=o.filter(e,(function(e){return o.includes(t,e.rootId)}));return o.map(n,"rootId")}(e,t);return o(i()).intersection(r).thru(o.isEmpty).value()?e:a(e,r,n)},triggerAppStudioWidgetOnPropsChanged:function(e,t,n,o){o.triggerAppStudioWidgetOnPropsChanged(e,t,n)}}},function(e,t,n){"use strict";var o=n(0),i=n(1),r=n(3),a=n(6),s=i.siteConstants,d=function(e,t){return e.getCompConnections(t).length>0};function c(e,t){var n=[s.PAGES_CONTAINER_ID,s.SITE_PAGES_ID],i=t(e,e);return o(i).omit([s.SITE_STRUCTURE_ID]).keys().difference(n).value()}function p(e,t,n){var r=i.siteConstants.MASTER_PAGE_ID,s=c(r,t),d=o.without(e,r);return o.transform(d,(function(e,o){e[o]=c(o,t),function(e,t){var n=t(e,e);return a.getWidgetType(n)===a.WIDGET_TYPES.PAGE}(o,n)&&(e[o]=e[o].concat(s))}),{})}e.exports={build:function(e){var t=e.runtimeDal,n=e.dataAPI,i=e.contextIds,a=e.onModelUpdateCallback,s=e.componentsFetcher,c=e.getCompReactClass,u=e.performanceLogger,l=e.getGhostStructure,f=e.isTypeController,g=e.canUseOnlyConnectedComponents;u.mark("build RMI model start");var m=n.RMI,h=m.fetchData,v=m.fetchSiteStructure,y=m.fetchPageData,I=m.fetchWidgetData,_=function(e){var t=e.runtimeDal,n=e.contextIdToCompIds,i=e.onModelUpdateCallback,a=e.fetchSiteStructure,s=e.isTypeController,c=e.fetchPageData,p=e.fetchWidgetData,u=e.getCompReactClass,l=e.getGhostStructure,f=e.canUseOnlyConnectedComponents;return o.mapValues(n,(function(e,n){var g=e;return f&&(g=o.filter(g,(function(e){var o=t.getCompStructure(e);return o&&s(o,n)||d(t,e)}))),r.generateRemoteModelInterface({runtimeDal:t,compIds:g,siteStructureData:a(),pageData:c(),widgetProperties:p(n),onUpdateCallback:i,contextId:n,getCompReactClass:u,getGhostStructure:l})}))}({isTypeController:f,runtimeDal:t,contextIdToCompIds:p(i,s,h),onModelUpdateCallback:a,fetchSiteStructure:v,fetchPageData:y,fetchWidgetData:I,getCompReactClass:c,getGhostStructure:l,canUseOnlyConnectedComponents:g});return u.mark("build RMI model end"),u.measure("build RMI model","build RMI model start","build RMI model end"),_},attach:function(e,t,n){return o.forEach(t,(function(t){e[t]._onUpdateCallback=n})),e}}},function(e,t,n){"use strict";var o=n(0),i=n(3);e.exports={build:function(e,t,n,r,a){var s=e.RGI.fetchNavigationData(t,o.get(r,"pageInfo")),d=e.RGI.fetchRouterData(n),c=e.RGI.fetchSessionInfo(),p=e.RGI.fetchSiteRevision(),u=e.RGI.fetchSiteMemberData(),l=e.RGI.fetchMultilingualInfo(),f=e.RGI.fetchAppsData(),g=e.RGI.fetchDeviceType(),m=e.RGI.fetchIsMobileFriendly(),h=o.invoke(e,"RGI.fetchRegionalSettings"),v=e.RGI.fetchIsApplicationStudio();return i.generateRemoteGlobalsInterface({navigationData:s,sessionInfo:c,siteRevision:p,siteMemberData:u,multilingualInfo:l,appsData:f,isApplicationStudio:v,deviceType:g,lightboxContext:o.get(r,"lightboxContext"),contextId:n,livePreviewMode:a,isMobileFriendly:m,regionalSettings:h,routerData:d})}}},function(e,t,n){"use strict";var o=n(0);e.exports={loadUserGeneratedAppsMessage:function(e,t){return{type:"load_user_generated_apps",applications:e,rootIds:t}},setBootstrapParametersMessage:function(e){return{intent:"WIX_CODE",type:"wix_code_iframe_set_bootstrap_parameters",parameters:e}},loadWidgetsMessage:function(e,t,n,o,i){return{type:"load_widgets",sdkParameters:{referrer:"undefined"!=typeof window&&window.document?window.document.referrer:""},widgets:e,rootIds:n,routersMap:t||{},rgisByRootId:o,biSessionData:i}},loadUserCodesMessage:function(e,t){return{type:"load_user_code",widgets:e,rootIds:t}},initWidgetsMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.livePreviewMode,i=t.apps;return o.assign({type:"init_widgets",contexts:e},n&&{livePreviewMode:n,apps:i})},startWidgetsMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.livePreviewMode,i=t.apps;return o.assign({type:"start_widgets",contexts:e},n&&{livePreviewMode:n,apps:i})},stopWidgetsMessage:function(e){return{type:"stop_widgets",widgetIds:e}},updateWidgetMessage:function(e,t){return{type:"update",contextId:e,updates:t}},updateSiteMemberData:function(e,t){return{contextId:e,type:"update_site_member",updates:t}},updateMultilingualInfo:function(e,t){return{contextId:e,type:"update_multilingual_info",updates:t}},updateSessionInfo:function(e,t){return{contextId:e,type:"update_session_info",updates:t}},updateaNavigation:function(e,t){return{contextId:e,type:"update_navigation",updates:t}},triggerOnRenderMessage:function(e,t){var n=t.livePreviewMode,i=o.pick(t,["pageNumber","pageId","pageUrl","pageLoadStart","networkPageLoadStart"]),r={intent:"WIX_CODE",type:"trigger_onRender",contextId:e};return t&&o.assign(r,n&&{livePreviewMode:n},{biDataUpdates:i}),r},triggerUserFunctionMessage:function(e,t,n){return{intent:"WIX_CODE",type:"wix_code_run_user_function",contextId:e,callbackId:t.callbackId,compId:t.compId,event:n}},updateWixCodeModelDataAfterLoginMessage:function(e,t){return{type:"update_wix_code_model_data_after_login",rootIds:t,widgets:e}},setEditorAppPublicApiToViewerWorker:function(e,t){return{type:"set_editor_app_public_api_to_viewer_worker",rootIds:t,apiName:e}},updateAppsData:function(e,t){return{contextId:e,type:"update_apps_data",updates:t}},stopMessage:function(e){return{contextId:e,type:"stop"}},isStopMessage:function(e){return"stop"===e.type},triggerAppStudioWidgetOnPropsChanged:function(e,t,n){return{contextId:e,type:"trigger_app_studio_widget_on_props_changed",oldProps:t,newProps:n}},invokeWorkerSubscribersMessage:function(e,t,n){return{type:"invoke_worker_subscribers",contextId:e,appDefId:t,data:n}},handleNativeTpaEventMessage:function(e,t){var n=t.compId;return{intent:"TPA_NATIVE_EVENT",contextId:e,callbackId:t.callbackId,compId:n,eventArgs:t.eventArgs}},updateBiData:function(e,t){return{contextId:e,type:"wix_code_worker_bi_data_update",updates:t}}}},,,,,function(e,t,n){"use strict";var o=n(3),i=n(20),r=n(11),a=n(12),s=n(6),d=n(32),c=n(33),p=n(13),u=n(5),l=n(10);e.exports={wixCodeRemoteModelService:o,messageBuilder:p,modelBuilder:r,globalsBuilder:a,widgetModel:u,widgetBehaviorHandler:d,widgetBehaviorPreprocessor:c,WidgetAspect:i,modelBuilderDataHelper:s,widgetService:l}},function(e,t,n){"use strict";var o=n(0),i=n(4);function r(e,t,n){var o=e+t;return n?i.repeaterUtils.structure.getUniqueDisplayedId(o,n):o}function a(e){return o.map(o.get(e,"children",[]),(function(t){return{childRole:t,parentId:e.id}}))}e.exports={createGhostDisplayedOnlyComps:function(e){for(var t=e.fallbackStructure,n=e.repeater,i=e.displayedOnlyComps,s=e.controllerId,d=o.get(n,"data.items"),c=a(n),p=function(){var e=c.shift(),p=e.childRole,u=e.parentId,l=o.get(t,p),f=o.map(d,(function(e){return function(e){var t=e.fallbackStructure,n=e.comp,i=e.compRole,a=e.repeaterId,s=e.controllerId,d=e.parentId,c=e.item;return o.assign({},n,{id:i,structureId:r(n.id,s,c),data:n.data||{},design:n.design||{},type:n.componentType,displayedOnlyComponents:[],isDisplayed:!0,displayedRoot:r(d,s),children:o.map(n.children,(function(e){return r(t[e].id,s,c)})),parent:r(d,s,d===a?null:c)})}({fallbackStructure:t,comp:l,compRole:p,repeaterId:n.id,controllerId:s,parentId:u,item:e})}));i.set(p,f);var g=a(l);c=c.concat(g)};c.length>0;)p();return i},getChildrenForGhost:function(e,t,n){return o.map(t,(function(t){return r(e[t].id,n)}))},generateGhostCompId:r}},function(e,t,n){"use strict";var o=n(0),i=n(1),r=n(21),a=n(10),s=n(22),d=n(5),c=n(24),p=n(6),u=n(25),l=n(30),f=n(31),g=new WeakMap;function m(e,t){var n=g.get(this);return e!==i.siteConstants.MASTER_PAGE_ID?e:o.find(t,(function(e){var t=n.aspectProps.getDataByQuery(e);return p.getWidgetType(t)===p.WIDGET_TYPES.PAGE}))}function h(e,t,n,o,i,r){var a=g.get(this),d=new s(e,t,n);return a.widgetHandler=d,r||(a.isRegisteredToWixCodeMessages=!0,l.registerWixCodeMessageHandler({hostProps:i,remoteMessagesHandler:d,wixCodeAppApi:o})),g.set(this,a),d}function v(e,t){var n=g.get(this),i=o.zipObject([{dataChange:"data",propsChange:"props",stateChange:"state",layoutChange:"layout"}[t.type]],[t.value]),r=o.zipObject([e],[i]);n.widgetHandler.handleWidgetUpdate(r)}function y(e){return o.map(e,(function(e){return{displayName:"Page: "+e,id:e,type:"Page"}}))}var I=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{on:o.noop},r=arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new c,s=arguments[5],d=arguments[6];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=o.assign({},e.defaultProps,t),g.set(this,{storageAPI:n,eventsManager:i,runtimeDal:r,actionQueue:a,wixCodeAppApi:s,aspectProps:t,updateSiteCallBacks:[],onWidgetReady:{},updating:!1,widgetHandler:{},contextIdsToIgnore:[]}),n.set("loadedAppsRoots",[]),i.on("runtimeCompChange",v.bind(this));var p={runtimeDal:r,actionQueue:a,wixCodeAppApi:s,storageAPI:n,aspectProps:t},u=d?o.noop:this.updateSite.bind(this);h.call(this,p,u,this.flushWidgetReady.bind(this),s,t.wixCodePostMessagesProps,t.deferWixCodeMessagesRegistration)}return e.prototype.onHostPropsChanged=function(e){var t=g.get(this);return t.aspectProps=o.assign({},t.aspectProps,e),t.aspectProps},e.prototype.updateSite=function(e){var t=g.get(this);e&&t.updateSiteCallBacks.push(e),t.updating||(t.updating=!0,i.animationFrame.request((function(){o.invokeMap(t.updateSiteCallBacks,o.call),t.updating=!1,t.updateSiteCallBacks=[]})))},e.prototype.allContextsReady=function(){var e=this,t=g.get(this).storageAPI.get("loadedAppsRoots");return o(t).map("rootId").every((function(t){return e.isContextReady(t)}))},e.prototype.allContextsReadyOrLifecycleFailed=function(){var e=this,t=g.get(this).storageAPI.get("loadedAppsRoots");return o(t).map("rootId").every((function(t){return e.isContextReadyOrLifeCycleFailed(t)}))},e.prototype.isContextReady=function(e){var t=g.get(this);if(t.aspectProps.isFirstRenderAfterSSR())return!0;var n=t.aspectProps.getAllPossiblyRenderedContexts(),i=t.storageAPI.get("loadedAppsRoots"),r=o.map(i,"rootId"),a=m.call(this,e,r);return!(!o.isEmpty(i)&&o.includes(n,e))||o.includes(r,a)&&t.widgetHandler.isWidgetReady(a)},e.prototype.isContextReadyOrLifeCycleFailed=function(e){var t=g.get(this);if(t.aspectProps.isFirstRenderAfterSSR())return!0;var n=t.aspectProps.getAllPossiblyRenderedContexts(),i=t.storageAPI.get("loadedAppsRoots"),r=o.map(i,"rootId"),a=m.call(this,e,r);return!(!o.isEmpty(i)&&o.includes(n,e))||o.includes(r,a)&&(t.widgetHandler.isWidgetReady(a)||t.widgetHandler.isWidgetFailed(a))},e.prototype.loadApps=function(e,t){var n=g.get(this),o=n.storageAPI.get("loadedAppsRoots");n.storageAPI.set("loadedAppsRoots",a.loadApps(n.aspectProps.getApplicationsForContexts,o,e,n.widgetHandler,t))},e.prototype.loadUserCode=function(e){var t=g.get(this);o.isEmpty(e)||t.widgetHandler.loadUserCode(t.aspectProps.getUserCodeDefinitions(e),e)},e.prototype.triggerAppStudioWidgetOnPropsChanged=function(e,t,n){var o=g.get(this);a.triggerAppStudioWidgetOnPropsChanged(e,t,n,o.widgetHandler)},e.prototype.initApps=function(e){var t=g.get(this);t.aspectProps.initWixCode&&a.initApps(e,t.widgetHandler,t.aspectProps.getContextInitData)},e.prototype.startApps=function(e){g.get(this).widgetHandler.startWidgets(e)},e.prototype.stopApps=function(e){var t=g.get(this),n=t.storageAPI.get("loadedAppsRoots");t.storageAPI.set("loadedAppsRoots",a.stopApps(n,e,t.widgetHandler,t.aspectProps.getAllRenderedContextIds))},e.prototype.restartApps=function(){var e=g.get(this).storageAPI.get("loadedAppsRoots");if(!o.isEmpty(e)){var t=o.map(e,"rootId");this.stopApps(t),this.loadApps(t),this.initApps(t)}},e.prototype.registerToOnWidgetReady=function(e,t){if(o.isFunction(t)){var n=g.get(this);(n.aspectProps.isExperimentOpen("sv_handleFailingWixCodeSdk")?this.isContextReadyOrLifeCycleFailed(e):this.isContextReady(e))?t():(n.onWidgetReady[e]||(n.onWidgetReady[e]=[]),n.onWidgetReady[e].push(t))}},e.prototype.flushWidgetReady=function(e){var t=g.get(this),n=t.onWidgetReady[e];o.forEach(n,(function(e){e()})),delete t.onWidgetReady[e]},e.prototype.syncAppsState=function(e){var t=g.get(this),n=o.pick(t.aspectProps,["getContextIdsWhichShouldBeRendered","filterValidContextsForLoad","filterContextsToSync","filterContextsToActivate","getContextInitData","getApplicationsForContexts"]);return e=e||t.storageAPI.get("loadedAppsRoots"),e=o.reject(e,(function(e){return o.includes(t.contextIdsToIgnore,e.rootId)})),e=a.syncAppsState(t.aspectProps.initWixCode,n,e,t.widgetHandler),t.storageAPI.set("loadedAppsRoots",e),e},e.prototype.getWidgetHandler=function(){return g.get(this).widgetHandler},e.prototype.getLoadedAppsContexts=function(){return g.get(this).storageAPI.get("loadedAppsRoots")},e.prototype.getCompModel=function(e,t,n){var o=g.get(this);return d.getCompModel({runtimeDal:e,compId:t,contextId:n,getCompReactClass:o.aspectProps.getCompReactClass})},e.prototype.setContextIdToIgnore=function(e){var t=g.get(this);t.contextIdsToIgnore=o.union(t.contextIdsToIgnore,[e]),g.set(this,t)},e.prototype.removeContextIdToIgnore=function(e){var t=g.get(this);t.contextIdsToIgnore=o.filter(t.contextIdsToIgnore,(function(t){return t!==e})),g.set(this,t)},e.prototype.registerWixCodePostMessageModifier=function(e){var t=g.get(this);l.registerMessageModifier(t.wixCodeAppApi,e)},e.prototype.extendPostMessagesWithUserCodeInfo=function(e){this.registerWixCodePostMessageModifier((function(t){return f.getExtendedMessage(t,e)}))},e.prototype.sendDelayedWixCodePostMessage=function(e,t,n){var o=g.get(this);l.onMessage({remoteMessagesHandler:o.widgetHandler,hostProps:n||o.aspectProps.wixCodePostMessagesProps},e,t)},e.prototype.registerToWixCodePostMessages=function(e){var t=g.get(this);if(t.isRegisteredToWixCodeMessages)throw new Error("Already registered to wixCode messages");l.registerWixCodeMessageHandler({hostProps:e,remoteMessagesHandler:t.widgetHandler,wixCodeAppApi:t.wixCodeAppApi}),t.isRegisteredToWixCodeMessages=!0,g.set(this,t)},e}();I.hostPropTypes={isMobileView:r.bool.isRequired,currentUrlPageId:r.string,hasWixCode:r.func.isRequired,isExperimentOpen:r.func.isRequired,initWixCode:r.bool.isRequired,isViewerMode:r.bool.isRequired,handleProcessedBehavior:r.func.isRequired,refreshRenderedContextsData:r.func.isRequired,getDataByQuery:r.func.isRequired,shouldUpdateRuntimeModels:r.func.isRequired,componentsFetcher:r.func.isRequired,RMIDataAPI:r.shape({RMI:r.shape({fetchData:r.func.isRequired,fetchSiteStructure:r.func.isRequired,fetchPageData:r.func.isRequired}),RGI:r.shape({fetchNavigationData:r.func,fetchSessionInfo:r.func,fetchSiteRevision:r.func,fetchSiteMemberData:r.func,fetchMultilingualInfo:r.func,fetchDeviceType:r.func.isRequired,fetchIsMobileFriendly:r.func.isRequired,fetchAppsData:r.func.isRequired,fetchRouterData:r.func.isRequired})}).isRequired,resolveWidgetData:r.func.isRequired,routers:r.object.isRequired,setWarmupDataForController:r.func.isRequired,getRuntimeModels:r.func.isRequired,isFirstRenderAfterSSR:r.func.isRequired,getNavigationDataForRgi:r.func.isRequired,getSMbySiteExtensionInstanceForRgi:r.func.isRequired,getAppsDataForRgi:r.func.isRequired,getAllPossiblyRenderedContexts:r.func.isRequired,getApplicationsForContexts:r.func.isRequired,getUserCodeDefinitions:r.func,filterContextsToSync:r.func,filterValidContextsForLoad:r.func,filterContextsToActivate:r.func,getContextInitData:r.func.isRequired,getContextIdsWhichShouldBeRendered:r.func,getCompReactClass:r.func,wixCodePostMessagesProps:r.shape({preMessageHandlingHook:r.func,handleRequestAPIMessage:r.func,logsHandler:r.func,handleWixCodeAppApiMessage:r.func,hostAPIHandlers:r.object}),performanceLogger:r.shape({mark:r.func,measure:r.func}),deferWixCodeMessagesRegistration:r.bool,getAllRenderedContextIds:r.func.isRequired},I.defaultProps={initWixCode:!0,hasWixCode:function(){return!0},isExperimentOpen:function(){return!1},getContextInitData:function(){return{}},getApplicationsForContexts:y,getUserCodeDefinitions:y,shouldUpdateRuntimeModels:function(){return!1},setWarmupDataForController:o.noop,refreshRenderedContextsData:o.noop,performanceLogger:{mark:o.noop,measure:o.noop},getCompReactClass:function(){return function(){}},componentsFetcher:function(){return{}},RMIDataAPI:{RMI:{fetchData:o.noop,fetchSiteStructure:o.noop,fetchPageData:o.noop,fetchWidgetData:o.noop},RGI:{fetchNavigationData:function(){return{currentPageFullUrl:window.location.href}},fetchSessionInfo:o.noop,fetchRouterData:o.noop,fetchSiteRevision:o.noop,fetchSiteMemberData:function(){return{}},fetchMultilingualInfo:function(){return{}},fetchDeviceType:o.noop,fetchIsMobileFriendly:o.noop,fetchAppsData:o.noop,fetchIsApplicationStudio:o.noop}},resolveWidgetData:o.identity,deferWixCodeMessagesRegistration:!1,wixCodePostMessagesProps:{}},I.modelBuilderDataHelper=p,I.widgetDataResolvers=u,e.exports=I},function(e,t){e.exports=o},function(e,t,n){"use strict";var o=n(0),i=n(23),r=n(1),a=n(11),s=n(12),d=n(13),c="stateChanged",p="dataChanged",u="designChanged",l="propsChanged",f="registerEvent",g="layoutChanged",m="executeBehavior",h="styleChanged",v="executeBatch",y="widget_ready",I="widget_status_changed",_="wix_code_warmup_data",C="pending",A="success",S="failed";function M(e){var t=e.compId,n=e.type,i=e.data,r=e.callback,a={data:this._runtimeDal.setCompData.bind(this._runtimeDal),style:this._runtimeDal.updateCompStyle.bind(this._runtimeDal),design:this._runtimeDal.setCompDesign.bind(this._runtimeDal),props:this._runtimeDal.setCompProps.bind(this._runtimeDal),layout:this._runtimeDal.updateCompLayout.bind(this._runtimeDal),registerEvent:this._runtimeDal.registerComponentEvent.bind(this._runtimeDal)};t?a[n](t,i):a[n](i),o.isFunction(this._onUpdateCallback)&&this._onUpdateCallback(r)}function E(e){if(this._aspectProps.shouldUpdateRuntimeModels())return a.attach(this._aspectProps.getRuntimeModels(),e,M.bind(this));var t=this._aspectProps.RMIDataAPI;return a.build({runtimeDal:this._runtimeDal,dataAPI:t,contextIds:e,onModelUpdateCallback:M.bind(this),componentsFetcher:this._aspectProps.componentsFetcher,getCompReactClass:this._aspectProps.getCompReactClass,performanceLogger:this._aspectProps.performanceLogger,getGhostStructure:this._aspectProps.getGhostStructure,isTypeController:this._aspectProps.isTypeController,canUseOnlyConnectedComponents:!this._aspectProps.hasWixCode()&&this._aspectProps.isExperimentOpen("sv_reducedRMI")})}function R(e,t,n,i){var r=o.keyBy(t,"pageId"),a=this._aspectProps.RMIDataAPI;return o.transform(e,(function(e,t){e[t]=s.build(a,!1,t,{pageInfo:r[t],lightboxContext:n[t]},i)}),{})}function x(e,t){this._actionQueue.addItem(function(){this.isWidgetReady(e.contextId)?this.handleCommand(e,t):x.call(this,e,t)}.bind(this))}function P(e){if(!this._isFlushingPendingCommands){var t=this;this._isFlushingPendingCommands=!0,e?n():r.animationFrame.request(n)}function n(){var e;t._isFlushingPendingCommands=!1,t._actionQueue.flush(),e=t._commandsFlushListeners,o.forEach(e,(function(e){return e()})),t._aspectProps.refreshRenderedContextsData()}}function D(e,t,n){this._runtimeDal=e.runtimeDal,this._wixCodeAppApi=e.wixCodeAppApi,this._remoteModelInterfaces={},this._remoteGlobalsInterfaces={},this._onUpdateCallback=t,this._receivedChanges=void 0,this._isFlushingPendingCommands=!1,this._commandsFlushListeners=[],this._actionQueue=e.actionQueue,this._storageAPI=e.storageAPI,this._flushWidgetReady=n,this._aspectProps=e.aspectProps,this._widgetsLoaded=!1}function b(e){return this._remoteModelInterfaces[e]}function w(e,t){this._storageAPI.set(e+"_widgetState",t)}function T(e){return this._storageAPI.get(e+"_widgetState")}function O(e,t,n){var i=o.assign({},e.getCompData(t),n),r=e.getCompProps(t);return this._aspectProps.resolveWidgetData(i,{compProps:r,compId:t})}function k(e,t){var n=this;return o.assign({},o.mapValues(t,(function(t,i){return t.data?o.assign(t,{data:O.call(n,e,i,t.data)}):t})))}D.prototype.initWidgets=function(e,t){var n=d.initWidgetsMessage(e,t);this._sendMessage(n)},D.prototype.hasRmiChangedSinceLastStart=function(e){var t=this;if(!this.lastLivePreviewRmiUsed)return!0;var n=E.call(this,e);return o.some(e,(function(e){return!o.isEqual(t.lastLivePreviewRmiUsed[e],n[e].jsonWithoutWixCodeComps(e))}))},D.prototype.livePreviewWorker=function(){return this.lastLivePreviewRmiUsed},D.prototype.cleanLivePreviewWorker=function(){this.lastLivePreviewRmiUsed=null},D.prototype.startWidgets=function(e,t){var n=this;if(!o.isEmpty(e)){o.get(t,"resetRuntimeOverrides")&&o.forEach(e,(function(e){n._runtimeDal._siteDataApi.resetRuntimeOverrides(e,!0),n._runtimeDal._siteDataApi.createDisplayedPage(e)})),o.assign(this._remoteModelInterfaces,E.call(this,e));var i=o.mapValues(this._remoteModelInterfaces,(function(e){return o.get(t,"livePreviewMode")&&e.cleanModelForLivePreview&&e.cleanModelForLivePreview(),e.toJson()})),r=d.startWidgetsMessage(o.pick(i,e),t);this.lastLivePreviewRmiUsed=o.get(t,"livePreviewMode")?o.mapValues(this._remoteModelInterfaces,(function(e,t){return e.jsonWithoutWixCodeComps(t)})):null,this._sendMessage(r)}},D.prototype.loadUserCode=function(e,t,n){var i=d.loadUserCodesMessage(e,t),r=n?o.pickBy(i.widgets,(function(e){return o.isMatch(e,{type:"Application"})})):i.widgets,a=o.assign(i,{widgets:r},n?{doNotLoadUserCode:n}:{});this._sendMessage(a)},D.prototype.loadUserGeneratedApps=function(e,t){var n=d.loadUserGeneratedAppsMessage(e,t);this._sendMessage(n)},D.prototype.updateWixCodeModelDataAfterLogin=function(e,t){var n=d.updateWixCodeModelDataAfterLoginMessage(e,t);this._sendMessage(n)},D.prototype.setEditorAppPublicApiToViewerWorker=function(e,t){var n=d.setEditorAppPublicApiToViewerWorker(e,t);this._sendMessage(n)},D.prototype.loadWidgets=function(e,t,n,i,r){var a=this,s=o.filter(e,{isWixTPA:!1});this._aspectProps.isExperimentOpen("sv_loadUserGeneratedAppsAfterBootstrap")&&this.loadUserGeneratedApps(s,t);var c=o(t).transform((function(e,t){e[t]=a._runtimeDal.getPopupContext(t)}),{}).omitBy(o.isUndefined).value();this._widgetsLoaded=!0,o.assign(this._remoteGlobalsInterfaces,R.call(this,t,n,c,i));var p=o.mapValues(this._remoteGlobalsInterfaces,(function(e){return e.toJson()})),u=d.loadWidgetsMessage(e,this._aspectProps.routers,t,p),l=o.assign(u,{livePreviewMode:i,doNotLoadUserCode:i&&r});this._sendMessage(l)},D.prototype.getActiveWidgetIds=function(){return o.keys(this._remoteModelInterfaces)},D.prototype.stopWidgets=function(e){var t=this;if(!o.isEmpty(e)){o.forEach(e,(function(e){delete t._remoteModelInterfaces[e],delete t._remoteGlobalsInterfaces[e],w.call(t,e,!!t._aspectProps.isExperimentOpen("sv_handleFailingWixCodeSdk")&&C)}));var n=d.stopWidgetsMessage(e);this._sendMessage(n)}},D.prototype.stopAllWidgets=function(){this.stopWidgets(o.keys(this._remoteModelInterfaces))},D.prototype.updateComponent=function(e,t){this._sendMessage(e,t)},D.prototype.invokeWorkerSubscribers=function(e,t,n){this._sendMessage(d.invokeWorkerSubscribersMessage(e,t,n))},D.prototype.handleWidgetUpdate=function(e){var t=o(e).keys().head(),n=o.pickBy(this._remoteModelInterfaces,(function(e){return o.has(e.toJson(),["components",t])})),i=o.find(o.find(e));if(!o.isEmpty(n)&&!o.isEqual(this._receivedChanges,i)){var r=o(n).keys().head();n[r].updateModel(e);var a=d.updateWidgetMessage(r,e);this._sendMessage(a)}},D.prototype.handleSiteMemberUpdate=function(e){var t=this;if(!this._widgetsLoaded){var n=d.updateSiteMemberData(this._aspectProps.currentUrlPageId,e);this._sendMessage(n)}o.forEach(this._remoteGlobalsInterfaces,(function(n,o){n.addSiteMemberData(e);var i=d.updateSiteMemberData(o,e);t._sendMessage(i)}))},D.prototype.handleBiDataUpdate=function(e,t){var n=d.updateBiData(e,t);this._sendMessage(n)},D.prototype.handleMultilingualInfoUpdate=function(e){var t=this;o.forEach(this._remoteGlobalsInterfaces,(function(n,o){n.addMultilingualInfo(e);var i=d.updateMultilingualInfo(o,e);t._sendMessage(i)}))},D.prototype.triggerAppStudioWidgetOnPropsChanged=function(e,t,n){var o=this._remoteModelInterfaces[e];o&&o.updateWidgetProperties(n);var i=d.triggerAppStudioWidgetOnPropsChanged(e,t,n);this._sendMessage(i)},D.prototype.handleAppDataUpdate=function(e){var t=this;o.forEach(this._remoteGlobalsInterfaces,(function(n,o){n.addAppsData(e);var i=d.updateAppsData(o,e);t._sendMessage(i)}))},D.prototype.handleSvSessionUpdate=function(e){var t=this;if(!this._widgetsLoaded){var n=d.updateSessionInfo(this._aspectProps.currentUrlPageId,{svSession:e});this._sendMessage(n)}o.forEach(this._remoteGlobalsInterfaces,(function(n,o){n.addSessionInfoProp(e);var i=d.updateSessionInfo(o,{svSession:e});t._sendMessage(i)}))},D.prototype.handleLocationUpdate=function(e){var t=this;o.forEach(this._remoteGlobalsInterfaces,(function(n,o){n.addNavigation(e);var i=d.updateaNavigation(o,e);t._sendMessage(i)}))},D.prototype.handleRemoteMessage=function(e){var t=this;switch(r.wSpy.log("worker",["remote w->s "+e.type,e]),e.type){case I:this._aspectProps.isExperimentOpen("sv_handleFailingWixCodeSdk")&&b.call(this,e.widgetId)&&i.runInAction((function(){w.call(t,e.widgetId,e.status),e.status===A&&(P.call(t,!0),t._flushWidgetReady(e.widgetId))}));break;case y:this._aspectProps.isExperimentOpen("sv_handleFailingWixCodeSdk")||b.call(this,e.widgetId)&&i.runInAction((function(){w.call(t,e.widgetId,!0),P.call(t,!0),t._flushWidgetReady(e.widgetId)}));break;case _:var n=o.get(e.data,"controllerId"),a=o.get(e.data,"data");this._aspectProps.setWarmupDataForController(n,a)}},D.prototype.onCommand=function(e,t){x.call(this,e,t),this.isWidgetReady(e.contextId)&&P.call(this,e.command===f)},D.prototype.handleCommand=function(e,t){r.wSpy.log("worker",["command w->s "+e.command].concat(Array.prototype.slice.call(arguments))),this._receivedChanges=e.data;var n=this._remoteModelInterfaces[e.contextId];if(n){switch(e.command){case v:e.data=k.call(this,this._runtimeDal,e.data),n.setBatchData(e.data);break;case c:n.setState(e.compId,e.data);break;case p:e.data=O.call(this,this._runtimeDal,e.compId,e.data),n.setData(e.compId,e.data);break;case u:n.setDesign(e.compId,e.data);break;case g:n.setLayout(e.compId,e.data);break;case l:n.setProps(e.compId,e.data,t);break;case f:n.registerEvent(e.contextId,e.compId,e.data.eventType,e.data.controllerId,e.data.callbackId);break;case h:n.setStyle(e.compId,e.data);break;case m:var i=e.data,a={group:"command",callback:t,clear:o.get(i.params,"clear",!0)};this._aspectProps.handleProcessedBehavior(i,a)}this._receivedChanges=void 0}},D.prototype.handleEvent=function(e,t,n,i){var r=void 0;switch(t){case"runCode":r=d.triggerUserFunctionMessage(e,n,function(e){var t=o.merge(o.pick(e,"item"),o.pickBy(e,o.negate(o.isObject)));return t.nativeEvent=o.pickBy(e.nativeEvent,o.negate(o.isObject)),e.data&&(t.data=e.data),t}(i));break;case"onRendered":r=d.triggerOnRenderMessage(e,n)}this._sendMessage(r)},D.prototype.handleNativeTpaEvent=function(e,t){var n=t.callbackId,o=t.eventArgs,i=t.compId,r=d.handleNativeTpaEventMessage(e,{callbackId:n,eventArgs:o,compId:i});this._sendMessage(r)},D.prototype.isWidgetReady=function(e){return this._aspectProps.isExperimentOpen("sv_handleFailingWixCodeSdk")?T.call(this,e)===A:!!T.call(this,e)},D.prototype.isWidgetFailed=function(e){return T.call(this,e)===S},D.prototype._sendMessage=function(e,t){r.wSpy.log("worker",["send s->w "+e.type].concat(Array.prototype.slice.call(arguments)));var n=this._wixCodeAppApi;n.sendMessage(e,t)},D.prototype.getPostMessageTarget=function(e){var t=this._wixCodeAppApi;return this._aspectProps.isExperimentOpen("wixCodeNoIframe")&&this._aspectProps.isViewerMode?t.getWorkerById(e):t.getAppsIframe()},D.prototype.registerCommandsFlushedListener=function(e){if(!o.isFunction(e))throw new TypeError("The callback provided is not a function.");this._commandsFlushListeners.push(e)},e.exports=D},function(e,t){e.exports=i},function(e,t,n){"use strict";var o=n(0),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queue=[]}return e.prototype.flush=function(){o.forEach(this.queue,(function(e){return e()})),this.queue=[]},e.prototype.addItem=function(e){this.queue.push(e)},e}();e.exports=i},function(e,t,n){"use strict";var o=n(0),i=[n(26),n(27),n(28)];e.exports={resolve:function(e,t,n){return o.forEach(i,(function(o){e=o.resolve(e,t,n)})),e}}},function(e,t,n){"use strict";var o=n(0);e.exports={resolve:function(e,t,n){var i=n.compProps,r=t.getSiteData(),a=void 0;return a="Grid"===e.type?function(e,t){var n=o.reduce(t.columns,(function(e,t){return t.linkPath&&e.push(t.linkPath),e}),[]),i=[];return n.length>0&&o.forEach(e.rows,(function(e){o.forEach(n,(function(t){var n=t+"_linkObj",r=o.get(e,n);o.isUndefined(r)||i.push(r)}))})),i}(e,i):function e(t){var n=[],i=o.get(t,"link");i&&n.push(i);var r=o.get(t,"linkList");return r&&(n=n.concat(r)),o.forEach(t,(function(t){o.isObject(t)&&(n=n.concat(e(t)))})),n}(e),o.forEach(a,(function(e){var t=e.type,n=e.pageId;if(("PageLink"===t||"AnchorLink"===t)&&o.isString(n)){var i=function(e,t){var n=o.compact(e.replace(/^#/,"").split("/")),i=o.findKey(t.getRouters(),{prefix:n[0]});return i?{type:"DynamicPageLink",routerId:i,innerRoute:n.slice(1).join("/")}:null}(e.pageId,r);i?(o.assign(e,i),delete e.pageId):e.pageId=function(e,t){if("#"===e)return"#"+t.getMainPageId();var n=t.findDataOnMasterPageByPredicate((function(t){return t.pageUriSEO===e.replace("#","")})),i=o.get(n,"id",e);return o.startsWith(i,"#")?i:"#"+i}(n,r)}})),e}}},function(e,t,n){"use strict";var o=n(0),i="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";function r(e){return e.uri?e:o.assign({},e,{uri:i})}e.exports={resolve:function(e){return"Image"===e.type?r(e):"ImageList"===e.type?o.assign({},e,{items:e.items&&e.items.map(r)}):e}}},function(e,t,n){"use strict";var o=n(29),i=n(1),r=i.svgUtils,a=i.guidUtils,s=i.requestsUtil,d=n(4).mediaItemUtils,c=r.SOURCE_TYPES,p=r.EMPTY_SVG_ID,u=r.EMPTY_SHAPE,l=a.nameUUIDFromString,f={method:"GET",headers:{"content-type":"text/plain"},mode:"cors"},g=/^https?:\/\//,m=/^\s*<(\?xml|svg)/i;function h(e){var t=o.sanitizeSVG(e),n=t.svg,i=t.error;return n||(console.warn(i),u)}e.exports={resolve:function(e,t,n){var o=n.compId;if("VectorImage"!==e.type||!e.hasOwnProperty("mediaSrc"))return e;var i=e.mediaSrc;switch(function(e){var t=e.value;if(!e.isValid)return c.EMPTY;if(t){if(g.test(t))return c.URL;if(m.test(t))return c.INLINE;if(d.isValidMediaItemUri(t,d.types.VECTOR))return c.WIX_MEDIA_ID}return c.EMPTY}(i)){case c.WIX_MEDIA_ID:return function(e){var t=d.parseMediaItemUri(e.value);return{svgId:t.mediaId,title:t.title,mediaSrc:e}}(i);case c.URL:return function(e,t,n){var o=l(t.value),i=e.getPointers(),r=e.getDisplayedDAL(),a=e.getRuntimeDal(),d=i.svgShapes.getSvgShapePointer(o);return r.get(d)?{svgId:o,mediaSrc:t}:(s.fetch(t.value,f).then((function(i){return i.text().then((function(i){r.set(d,e.getSvgStringToStoreData(h(i)));var s=a.getCompData(n).mediaSrc,c=void 0===s?{}:s;t.value===c.value&&a.setCompData(n,{svgId:o,mediaSrc:t})}))})).catch((function(){var e=a.getCompData(n).mediaSrc,o=void 0===e?{}:e;t.value===o.value&&a.setCompData(n,{svgId:p,mediaSrc:t})})),{mediaSrc:t})}(t,i,o);case c.INLINE:return function(e,t){var n=l(t.value),o=e.getPointers(),i=e.getDisplayedDAL(),r=o.svgShapes.getSvgShapePointer(n);return i.get(r)||i.set(r,e.getSvgStringToStoreData(h(t.value))),{svgId:n,mediaSrc:t}}(t,i);case c.EMPTY:default:return{svgId:p,mediaSrc:i}}}}},function(e,t,n){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var o=n(1);e.exports=o},function(e,t,n){"use strict";var o=n(2),i=/<svg ([^>]+)>/,r=["animateColor","animateTransform","animateMotion","linearGradient","radialGradient","clipPath","altGlyph","altGlyphItem","glyphRef","textPath","altGlyphDef","feDistantLight","fePointLight","feSpotLight","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","feFuncA","feFuncR","feFuncG","feFuncB"];function a(e,t){var n=new RegExp(t+"=(\"|')?([-\\w\\s,]+)\\1");return e.match(n)}function s(e,t){var n=a(e,t);return n?n[2]:null}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hasRealDOM="undefined"!=typeof window,this.purifier=o}return e.prototype.sanitizeSVG=function(e){this.purifier.addHook("afterSanitizeAttributes",(function(e){e.hasAttribute("xlink:href")&&!e.getAttribute("xlink:href").match(/^#/)&&e.removeAttribute("xlink:href")}));var t=this.purifier.sanitize(e,{RETURN_DOM_FRAGMENT:this.hasRealDOM,KEEP_CONTENT:!1,USE_PROFILES:{svg:!0,svgFilters:!0},ADD_TAGS:["use"],ADD_ATTR:["filterUnits"]});this.purifier.removeHook("afterSanitizeAttributes");var n,o,s,d=this.hasRealDOM?t.querySelector("svg"):t.match(i);if(!d)return{error:""};this.hasRealDOM?(d.setAttribute("data-type","ugc"),t=d.outerHTML):(d=d[0],n=t.replace(d,(s=a(o=d,"data-type"))?o.replace(s[2],"ugc"):o.replace("<svg ",'<svg data-type="ugc" ')),t=r.reduce((function(e,t){var n=new RegExp(t,"ig");return e.replace(n,t)}),n));var c=this.validateSVG(d);return c?{error:c}:{svg:t}},e.prototype.validateSVG=function(e){var t="string"==typeof e,n=t?s(e,"width"):e.getAttribute("width"),o=t?s(e,"height"):e.getAttribute("height");return(t?s(e,"viewBox"):e.getAttribute("viewBox"))||n&&o?null:"SVG does not have viewBox nor width and height"},e}();e.exports=new d},function(e,t,n){e.exports=function(){"use strict";var e=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"],t=["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"],n=["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence"],o=["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"],i=["#text"],r=["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","crossorigin","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","integrity","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"],a=["accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"],s=["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"],d=["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"];function c(e,t){for(var n=t.length;n--;)"string"==typeof t[n]&&(t[n]=t[n].toLowerCase()),e[t[n]]=!0;return e}function p(e){var t={},n=void 0;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}var u=/\{\{[\s\S]*|[\s\S]*\}\}/gm,l=/<%[\s\S]*|[\s\S]*%>/gm,f=/^data-[\-\w.\u00B7-\uFFFF]/,g=/^aria-[\-\w]+$/,m=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,h=/^(?:\w+script|data):/i,v=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function I(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _=function(){return"undefined"==typeof window?null:window};return function C(){var A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_(),S=function(e){return C(e)};if(S.version="1.0.3",S.removed=[],!A||!A.document||9!==A.document.nodeType)return S.isSupported=!1,S;var M=A.document,E=!1,R=!1,x=A.document,P=A.DocumentFragment,D=A.HTMLTemplateElement,b=A.Node,w=A.NodeFilter,T=A.NamedNodeMap,O=void 0===T?A.NamedNodeMap||A.MozNamedAttrMap:T,k=A.Text,W=A.Comment,N=A.DOMParser,L=A.XMLHttpRequest,F=void 0===L?A.XMLHttpRequest:L,U=A.encodeURI,G=void 0===U?A.encodeURI:U;if("function"==typeof D){var H=x.createElement("template");H.content&&H.content.ownerDocument&&(x=H.content.ownerDocument)}var B=x,q=B.implementation,j=B.createNodeIterator,V=B.getElementsByTagName,z=B.createDocumentFragment,X=M.importNode,Y={};S.isSupported=q&&void 0!==q.createHTMLDocument&&9!==x.documentMode;var Q=u,K=l,J=f,$=g,Z=h,ee=v,te=m,ne=null,oe=c({},[].concat(I(e),I(t),I(n),I(o),I(i))),ie=null,re=c({},[].concat(I(r),I(a),I(s),I(d))),ae=null,se=null,de=!0,ce=!0,pe=!1,ue=!1,le=!1,fe=!1,ge=!1,me=!1,he=!1,ve=!1,ye=!1,Ie=!0,_e=!0,Ce={},Ae=c({},["audio","head","math","script","style","template","svg","video"]),Se=c({},["audio","video","img","source","image"]),Me=c({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Ee=null,Re=x.createElement("form"),xe=function(u){"object"!==(void 0===u?"undefined":y(u))&&(u={}),ne="ALLOWED_TAGS"in u?c({},u.ALLOWED_TAGS):oe,ie="ALLOWED_ATTR"in u?c({},u.ALLOWED_ATTR):re,ae="FORBID_TAGS"in u?c({},u.FORBID_TAGS):{},se="FORBID_ATTR"in u?c({},u.FORBID_ATTR):{},Ce="USE_PROFILES"in u&&u.USE_PROFILES,de=!1!==u.ALLOW_ARIA_ATTR,ce=!1!==u.ALLOW_DATA_ATTR,pe=u.ALLOW_UNKNOWN_PROTOCOLS||!1,ue=u.SAFE_FOR_JQUERY||!1,le=u.SAFE_FOR_TEMPLATES||!1,fe=u.WHOLE_DOCUMENT||!1,he=u.RETURN_DOM||!1,ve=u.RETURN_DOM_FRAGMENT||!1,ye=u.RETURN_DOM_IMPORT||!1,me=u.FORCE_BODY||!1,Ie=!1!==u.SANITIZE_DOM,_e=!1!==u.KEEP_CONTENT,te=u.ALLOWED_URI_REGEXP||te,le&&(ce=!1),ve&&(he=!0),Ce&&(ne=c({},[].concat(I(i))),ie=[],!0===Ce.html&&(c(ne,e),c(ie,r)),!0===Ce.svg&&(c(ne,t),c(ie,a),c(ie,d)),!0===Ce.svgFilters&&(c(ne,n),c(ie,a),c(ie,d)),!0===Ce.mathMl&&(c(ne,o),c(ie,s),c(ie,d))),u.ADD_TAGS&&(ne===oe&&(ne=p(ne)),c(ne,u.ADD_TAGS)),u.ADD_ATTR&&(ie===re&&(ie=p(ie)),c(ie,u.ADD_ATTR)),u.ADD_URI_SAFE_ATTR&&c(Me,u.ADD_URI_SAFE_ATTR),_e&&(ne["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(u),Ee=u},Pe=function(e){S.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},De=function(e,t){S.removed.push({attribute:t.getAttributeNode(e),from:t}),t.removeAttribute(e)},be=function(e){var t=void 0,n=void 0;if(me&&(e="<remove></remove>"+e),R){try{e=G(e)}catch(e){}var o=new F;o.responseType="document",o.open("GET","data:text/html;charset=utf-8,"+e,!1),o.send(null),t=o.response}if(E)try{t=(new N).parseFromString(e,"text/html")}catch(e){}return t&&t.documentElement||((n=(t=q.createHTMLDocument("")).body).parentNode.removeChild(n.parentNode.firstElementChild),n.outerHTML=e),V.call(t,fe?"html":"body")[0]};S.isSupported&&function(){var e=be('<svg><g onload="this.parentNode.remove()"></g></svg>');e.querySelector("svg")||(R=!0);try{(e=be('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">')).querySelector("svg img")&&(E=!0)}catch(e){}}();var we=function(e){return j.call(e.ownerDocument||e,e,w.SHOW_ELEMENT|w.SHOW_COMMENT|w.SHOW_TEXT,(function(){return w.FILTER_ACCEPT}),!1)},Te=function(e){return"object"===(void 0===b?"undefined":y(b))?e instanceof b:e&&"object"===(void 0===e?"undefined":y(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Oe=function(e,t,n){Y[e]&&Y[e].forEach((function(e){e.call(S,t,n,Ee)}))},ke=function(e){var t,n=void 0;if(Oe("beforeSanitizeElements",e,null),!((t=e)instanceof k||t instanceof W||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof O&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute))return Pe(e),!0;var o=e.nodeName.toLowerCase();if(Oe("uponSanitizeElement",e,{tagName:o,allowedTags:ne}),!ne[o]||ae[o]){if(_e&&!Ae[o]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return Pe(e),!0}return!ue||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(S.removed.push({element:e.cloneNode()}),e.innerHTML=e.textContent.replace(/</g,"&lt;")),le&&3===e.nodeType&&(n=(n=(n=e.textContent).replace(Q," ")).replace(K," "),e.textContent!==n&&(S.removed.push({element:e.cloneNode()}),e.textContent=n)),Oe("afterSanitizeElements",e,null),!1},We=function(e){var t=void 0,n=void 0,o=void 0,i=void 0,r=void 0,a=void 0,s=void 0;if(Oe("beforeSanitizeAttributes",e,null),a=e.attributes){var d={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ie};for(s=a.length;s--;){if(n=(t=a[s]).name,o=t.value.trim(),i=n.toLowerCase(),d.attrName=i,d.attrValue=o,d.keepAttr=!0,Oe("uponSanitizeAttribute",e,d),o=d.attrValue,"name"===i&&"IMG"===e.nodeName&&a.id)r=a.id,a=Array.prototype.slice.apply(a),De("id",e),De(n,e),a.indexOf(r)>s&&e.setAttribute("id",r.value);else{if("INPUT"===e.nodeName&&"type"===i&&"file"===o&&(ie[i]||!se[i]))continue;"id"===n&&e.setAttribute(n,""),De(n,e)}if(d.keepAttr&&(!Ie||"id"!==i&&"name"!==i||!(o in x||o in Re))){if(le&&(o=(o=o.replace(Q," ")).replace(K," ")),ce&&J.test(i));else if(de&&$.test(i));else{if(!ie[i]||se[i])continue;if(Me[i]);else if(te.test(o.replace(ee,"")));else if("src"!==i&&"xlink:href"!==i||0!==o.indexOf("data:")||!Se[e.nodeName.toLowerCase()])if(pe&&!Z.test(o.replace(ee,"")));else if(o)continue}try{e.setAttribute(n,o),S.removed.pop()}catch(e){}}}Oe("afterSanitizeAttributes",e,null)}},Ne=function e(t){var n=void 0,o=we(t);for(Oe("beforeSanitizeShadowDOM",t,null);n=o.nextNode();)Oe("uponSanitizeShadowNode",n,null),ke(n)||(n.content instanceof P&&e(n.content),We(n));Oe("afterSanitizeShadowDOM",t,null)};return S.sanitize=function(e,t){var n=void 0,o=void 0,i=void 0,r=void 0,a=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!Te(e)){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");if("string"!=typeof(e=e.toString()))throw new TypeError("dirty is not a string, aborting")}if(!S.isSupported){if("object"===y(A.toStaticHTML)||"function"==typeof A.toStaticHTML){if("string"==typeof e)return A.toStaticHTML(e);if(Te(e))return A.toStaticHTML(e.outerHTML)}return e}if(ge||xe(t),S.removed=[],e instanceof b)1===(o=(n=be("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===o.nodeName?n=o:n.appendChild(o);else{if(!he&&!fe&&-1===e.indexOf("<"))return e;if(!(n=be(e)))return he?null:""}me&&Pe(n.firstChild);for(var s=we(n);i=s.nextNode();)3===i.nodeType&&i===r||ke(i)||(i.content instanceof P&&Ne(i.content),We(i),r=i);if(he){if(ve)for(a=z.call(n.ownerDocument);n.firstChild;)a.appendChild(n.firstChild);else a=n;return ye&&(a=X.call(M,a,!0)),a}return fe?n.outerHTML:n.innerHTML},S.setConfig=function(e){xe(e),ge=!0},S.clearConfig=function(){Ee=null,ge=!1},S.addHook=function(e,t){"function"==typeof t&&(Y[e]=Y[e]||[],Y[e].push(t))},S.removeHook=function(e){Y[e]&&Y[e].pop()},S.removeHooks=function(e){Y[e]&&(Y[e]=[])},S.removeAllHooks=function(){Y={}},S}()}()}])},function(e,t,n){"use strict";var o=n(0),i=n(2);function r(e){return e===i.WIX_CODE.MESSAGE_INTENT.WIX_CODE_SITE_API}function a(e){return e===i.WIX_CODE.MESSAGE_INTENT.WIX_CODE_APP_API}function s(e,t,n,r){var a=e;switch(n.type){case i.WIX_CODE.MESSAGE_TYPE.IFRAME_COMMAND:a.onCommand(n,r);break;case i.WIX_CODE.MESSAGE_TYPE.CONSOLE:o.invoke(t,"logsHandler",n);break;case i.WIX_CODE.MESSAGE_TYPE.REQUEST_API:o.invoke(t,"handleRequestAPIMessage",a,n);break;case i.WIX_CODE.MESSAGE_TYPE.PERFORMANCE_METRICS_READY:"undefined"!=typeof window&&window.postMessage(n,"*");break;default:a.handleRemoteMessage(n)}}function d(e,t,n){var d=e.remoteMessagesHandler,p=e.hostProps,u=void 0===p?{}:p;n=n||o.partial(s,d,u);try{o.isString(t)&&(t=JSON.parse(t))}catch(e){return}if(u.preMessageHandlingHook?u.preMessageHandlingHook(t,n):t){var l=void 0;if(t.intent===i.WIX_CODE.MESSAGE_INTENT.WIX_CODE_MESSAGE)n(t,c(t,d));else if(r(t.intent)){var f=u.hostAPIHandlers||{};l=c(t,d);try{u.genericHandler?u.genericHandler(t,l):f[t.type]&&f[t.type](t,l)}catch(e){l(null,e.message)}}else if(a(t.intent)){l=c(t,d);try{o.invoke(u,"handleWixCodeAppApiMessage",t,l)}catch(e){l(null,e.message)}}}}function c(e,t){return function(n,i,s){var d={intent:"WIX_CODE_RESPONSE",callbackId:e.callbackId,type:e.type,contextId:e.contextId};if(r(e.intent)||a(e.intent))d=o.merge(d,{result:n,error:i});else{var c={compId:e.compId,command:e.command};n&&o.merge(c,n),d=o.merge(d,{result:c})}try{t.updateComponent(d,s)}catch(e){}}}function p(e,t,n){var o=e.remoteMessagesHandler,i=e.hostProps;d({remoteMessagesHandler:o,hostProps:void 0===i?{}:i},t,n)}e.exports={registerWixCodeMessageHandler:function(e){var t=e.wixCodeAppApi,n=e.remoteMessagesHandler,i=e.hostProps;t.registerMessageHandler(o.partial(p,{remoteMessagesHandler:n,hostProps:i}))},registerMessageModifier:function(e,t){e.registerMessageModifier(t)},onMessage:d}},function(e,t,n){"use strict";var o=n(0);function i(e,t){var n=e.id+".js";return{url:t,displayName:e.id,scriptName:n}}e.exports={getExtendedMessage:function(e,t){return e.widgets&&(e.widgets=o.map(e.widgets,(function(n){return o.assign({},n,function(e,t,n){return"load_widgets"!==e.type&&"load_user_code"!==e.type||"Application"===t.type?{}:{appConfig:{userScript:i(t,n)}}}(e,n,t))}))),o.defaults({},e)}}},function(e,t,n){"use strict";var o=n(0),i=["type","name","targetId"];e.exports={handle:function(e,t,n){var i=t.getSiteAspect("WidgetAspect").getWidgetHandler();o.forEach(e,(function(e){i.handleEvent(e.targetId,e.name,e.params,n)}))},getUniqueIdentifier:function(e){var t=o.at(e,i);return t.push(e.params.callbackId),t.push(e.params.compId),t.join(",")}}},function(e,t,n){"use strict";var o=n(0);function i(e,t){var n=e.getRuntimeDal().getPageId(t);return n?"masterPage"===n?e.getSiteData().getFocusedRootId():n:null}e.exports=function(e,t,n){return o.assign({},e,{targetId:i(n,t.sourceId)})}}])}));
//# sourceMappingURL=host-platform-api.js.map