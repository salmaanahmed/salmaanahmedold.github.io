define("databaseEditor/mixins/dbEditorApiContextMixin",["prop-types"],function(e){"use strict";return{contextTypes:{dbEditorApi:e.object.isRequired},getDbEditorApi:function(){return this.context.dbEditorApi}}}),define("databaseEditor/components/itemDetails.rt",["react","lodash","baseUI"],function(t,i,s){"use strict";return function(){return t.createElement("div",{className:"item-details",onClick:this.editItem},this.props.showImage&&this.getImageDef().imageVisible?function(){var e=this.getImageDef();return t.createElement("span",{key:"item-img-container",className:i({"item-thumb-img":!0,noImage:!e.imageValid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.imageValid?t.createElement("img",i.assign({},{key:"item-img-thumb"},e.props)):null,e.imageValid?null:t.createElement(s.symbol,{name:"camera",key:"item-img-symbol"}))}.apply(this,[]):null,t.createElement("span",{className:"item-title"},i.unescape(this.props.item.title)||"(Untitled Item)"))}}),define("databaseEditor/components/itemDetails",["lodash","create-react-class","prop-types","util","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/itemDetails.rt"],function(d,e,t,c,i,s){"use strict";return e({displayName:"itemDetails",mixins:[c.translationMixin,i],propTypes:{item:t.object.isRequired,showImage:t.bool,visibleFields:t.arrayOf(t.string)},getDefaultProps:function(){return{showImage:!0}},getImageDef:function(){var e,i,t,s,a,n,l=(e=this.props.item,i=this.props.visibleFields,d.find(e,function(e,t){return"wix:Image"===e._type&&d.includes(i,t)})),r=!!l,o=r&&!d.isEmpty(l.src);return{imageVisible:r,imageValid:o,props:o?(t=l,s=this.getDbEditorApi(),a={uri:t.src,width:t.width,height:t.height},n=c.imageTransform.getData(c.imageTransform.fittingTypes.SCALE_TO_FILL,{width:a.width,height:a.height,id:a.uri},{width:43,height:43,alignment:c.imageTransform.alignTypes.CENTER,htmlTag:"img"}),{src:s.getServiceTopology().staticMediaUrl+"/"+n.uri,style:n.css.img}):null}},editItem:function(){this.getDbEditorApi().setCurrentItem(this.props.item._iid,"hover_item")},render:s})}),define("databaseEditor/components/itemActionMenu.rt",["react","lodash","baseUI","experiment"],function(e,t,i,s){"use strict";return function(){return e.createElement("div",{className:"item-action-menu",onClick:function(e){e.stopPropagation()}.bind(this)},e.createElement("div",{className:"action-buttons-container"},e.createElement(i.button,{className:"duplicate-item-button",label:"list_dbe_hover_item_duplicate_tooltip",icon:"duplicate",onClick:this.duplicateItem}),e.createElement(i.button,{className:"delete-item-button",label:"list_dbe_hover_item_delete_tooltip",icon:"delete",onClick:this.deleteItem}),this.props.isHidden?e.createElement(i.button,{key:"hoverItemShowBtn",className:"show-item-button",label:"list_dbe_hover_item_show",icon:"quickActionsShow",onClick:this.showItem}):null,this.props.isHidden?null:e.createElement(i.button,{key:"hoverItemHideBtn",className:"hide-item-button",label:"list_dbe_hover_item_hide",icon:"quickActionsHide",onClick:this.hideItem}),e.createElement(i.button,{className:"edit-item-button",label:"list_dbe_hover_item_edit",icon:"pencil",onClick:this.editItem})))}}),define("databaseEditor/components/itemActionMenu",["create-react-class","prop-types","util","databaseEditor/components/itemActionMenu.rt","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i,s,a){"use strict";return e({displayName:"itemActionMenu",mixins:[i.translationMixin,a],propTypes:{item:t.object.isRequired,isHidden:t.bool.isRequired},editItem:function(){var e=this.props.item._iid;this.getDbEditorApi().setCurrentItem(e,"hover_item")},duplicateItem:function(){this.getDbEditorApi().duplicateItems([this.props.item],"hover_item")},deleteItem:function(){this.getDbEditorApi().deleteItems([this.props.item],"hover_item")},showItem:function(){this.getDbEditorApi().showItems([this.props.item],"hover_item")},hideItem:function(){this.getDbEditorApi().hideItems([this.props.item],"hover_item")},render:s})}),define("databaseEditor/components/itemListRow.rt",["react","lodash","baseUI","baseUILib","databaseEditor/components/itemDetails","databaseEditor/components/itemActionMenu"],function(s,a,n,l,r,o){"use strict";return function(){return s.createElement("div",(e={className:"item-list-row"},t=this.filteredProps(),i=a.assign({},e,t),e.hasOwnProperty("style")&&(i.style=a.defaults(i.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(i.className=t.className+" "+e.className),i),this.props.isOpened?null:s.createElement("span",{className:"drag-handle-container",key:"drag-handle",onMouseDown:this.props.onStartDrag},s.createElement(n.symbol,{name:"dragHandle",className:"symbol-dragHandle"})),this.props.isOpened?null:s.createElement(l.Checkbox,{key:"item-checkbox",labelAfterSymbol:!0,value:this.props.isSelected,onChange:this.props.onSelect}),s.createElement(r,{className:a({draggable:!0}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),item:this.props.item,showImage:!this.props.isOpened,visibleFields:this.props.visibleFields,isHidden:this.props.isHidden}),s.createElement(o,{item:this.props.item,isHidden:this.props.isHidden}));var e,t,i}}),define("databaseEditor/components/itemListRow",["create-react-class","prop-types","lodash","databaseEditor/components/itemListRow.rt","util"],function(e,t,i,s,a){"use strict";return e({displayName:"itemListRow",mixins:[a.propTypesFilterMixin],propTypes:{item:t.object.isRequired,isOpened:t.bool.isRequired,isSelected:t.bool.isRequired,visibleFields:t.arrayOf(t.string),onSelect:t.func.isRequired,onStartDrag:t.func},render:s})}),define("databaseEditor/components/noItems.rt",["react","lodash","baseUI"],function(e,t,i){"use strict";return function(){return e.createElement("div",{className:"no-items"},e.createElement(i.symbol,{name:"createYourFirstItem",className:"no-items-image"}),e.createElement("span",{className:"no-items-title"},this.translateIfNeeded("list_dbe_this_list_is_empty")),e.createElement("div",{className:"no-items-click-container"},e.createElement("span",{},this.translateIfNeeded("list_dbe_empty_sate_line2"))))}}),define("databaseEditor/components/noItems",["create-react-class","lodash","databaseEditor/components/noItems.rt","databaseEditor/mixins/dbEditorApiContextMixin","util"],function(e,t,i,s,a){"use strict";return e({displayName:"noItems",mixins:[s,a.translationMixin],render:i})}),define("databaseEditor/components/itemListFilter/itemListFilter.rt",["react","lodash","baseUI","santa-editor-symbols","constants"],function(e,t,i,s,a){"use strict";return function(){return e.createElement("span",{className:t({"item-list-filter":!0,"is-open":this.state.isBubbleOpen}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement("span",{},this.translateIfNeeded("list_dbe_items_filter_label")," "),e.createElement("span",{className:"item-list-filter-value-label",ref:"handler",onClick:this.toggleBubble},"\n        ",this.getValueLabel(),"\n        ",e.createElement(s.symbol,{name:"arrowDown"})),this.state.isBubbleOpen?e.createElement(i.bubble,{key:"itemFilterBubble",value:this.getBubbleContent(),closeTriggers:[a.UI.TOOLTIP.TRIGGERS.CLICK,a.UI.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:a.UI.TOOLTIP.ALIGNMENT.BOTTOM,styleType:a.UI.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.closeBubble,targetNode:this.refs.handler}):null)}}),define("databaseEditor/components/itemListFilter/itemListFilterBubble.rt",["react","lodash","santa-editor-symbols"],function(i,s,a){"use strict";return function(){return i.createElement.apply(this,["div",{className:"item-list-filter-bubble"},s.map(this.props.options,function(e,t){return i.createElement("div",{key:e.value,onClick:function(e,t){this.props.onChange(e.value)}.bind(this,e,t),className:s({"item-list-filter-bubble-option":!0,selected:this.props.value===e.value}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},i.createElement(a.symbol,{name:"check"}),i.createElement("span",{},this.translateIfNeeded(e.label)))}.bind(this))])}}),define("databaseEditor/components/itemListFilter/itemListFilterBubble",["create-react-class","prop-types","lodash","util","databaseEditor/components/itemListFilter/itemListFilterBubble.rt"],function(e,t,i,s,a){"use strict";return e({displayName:"itemListFilterBubble",mixins:[s.translationMixin],propTypes:{value:t.any.isRequired,onChange:t.func.isRequired,options:t.arrayOf(t.shape({label:t.string.isRequired,value:t.any.isRequired})).isRequired},render:a})}),define("databaseEditor/components/itemListFilter/itemListFilter",["react","create-react-class","prop-types","lodash","util","databaseEditor/components/itemListFilter/itemListFilter.rt","databaseEditor/components/itemListFilter/itemListFilterBubble"],function(e,t,i,s,a,n,l){"use strict";var r={all:"list_dbe_items_filter_all",visible:"list_dbe_items_filter_visible",hidden:"list_dbe_items_filter_hidden"};return t({displayName:"itemListFilter",mixins:[a.translationMixin],propTypes:{value:i.oneOf(["all","visible","hidden"]).isRequired,onChange:i.func.isRequired},getInitialState:function(){return{isBubbleOpen:!1}},getValueLabel:function(){return this.translateIfNeeded(r[this.props.value])},toggleBubble:function(){this.setState({isBubbleOpen:!this.state.isBubbleOpen})},closeBubble:function(){this.setState({isBubbleOpen:!1})},getBubbleContent:function(){return e.createElement(l,{value:this.props.value,onChange:function(e){this.props.onChange(e),this.closeBubble()}.bind(this),options:s.map(r,function(e,t){return{label:e,value:t}})})},render:n})}),define("databaseEditor/components/itemsList.rt",["react","lodash","baseUI","baseUILib","uiAnimations","databaseEditor/components/itemListRow","databaseEditor/components/noItems","databaseEditor/components/itemListFilter/itemListFilter"],function(n,l,r,o,d,c,m,u){"use strict";return function(){return function(){var e,t,i,s=r.sortByDragList,a=this.getSelectedIds().length;return n.createElement("div",(e={className:"items-list "+(this.props.openedItemId?"small":"")},t=this.filteredProps(),i=l.assign({},e,t),e.hasOwnProperty("style")&&(i.style=l.defaults(i.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(i.className=t.className+" "+e.className),i),n.createElement("header",{className:"list-header"},n.createElement("span",{className:"list-header-left-pane"},n.createElement("span",{className:"list-title"},this.props.listName),this.props.openedItemId?null:n.createElement(u,{key:"itemListFilter",value:this.state.itemsFilter,onChange:this.setItemsFilter})),n.createElement(r.button,{className:"add-item-btn",label:"list_dbe_edit_item_add_item",onClick:this.addItem})),n.createElement("div",{className:this.props.openedItemId?"add-item-container":"select-all-container"},n.createElement("span",{className:"select-all-checkbox"},n.createElement(o.Checkbox,{labelAfterSymbol:!0,value:0<a,indeterminate:0<a&&a<this.filteredItems().length,label:this.getItemsSelectionLabel(a),shouldTranslate:!1,onChange:function(e,t){this.toggleAllItems()}.bind(this,s,a)})),this.props.openedItemId?n.createElement(r.button,{key:"list-view-add-btn",label:"list_dbe_edit_item_add_item",className:"small-add-item",onClick:this.addItem}):null,0<this.getSelectedIds().length?n.createElement("span",{key:"multi-select-actions",className:"multi-select-action-menu checked"},n.createElement(r.button,{className:"multi-duplicate",label:"list_dbe_duplicate_Items",icon:"duplicate",onClick:this.duplicateSelectedItems}),n.createElement(r.button,{className:"multi-delete",label:"list_dbe_delete_items",icon:"delete",onClick:this.deleteSelectedItems}),n.createElement(r.button,{className:"multi-show-hide",label:"list_dbe_show_hide_multiple_items",icon:"quickActionsShow",onClick:this.showHideSelectedItems})):null),0!==this.allItems().length||this.props.loading?null:n.createElement(m,{key:"no-items"}),n.createElement(o.CustomScroll,{heightRelativeToParent:"calc(100% - 120px)"},n.createElement("div",{className:this.props.openedItemId?"items-container-edit":"items-container"},this.shouldShowVisibleItems()?n.createElement.apply(this,[s,{ref:"sortList",key:"da-list",className:l({"sort-list":!this.props.openedItemId,"item-edit-sort-list":this.props.openedItemId,"visible-items-container":!0}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),onItemMoved:this.getDbEditorApi().moveItem,childrenTransition:d.contentAddRemove},l.map(this.props.items,function(e,t,i,s){return n.createElement(c,{key:i._iid,item:i,className:l({"hidden-item":!1,selected:this.isSelected(i._iid),"no-hover":0<t,"is-open":this.props.openedItemId===i._iid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),isHidden:!1,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(i._iid),visibleFields:this.props.visibleFields,onSelect:function(e,t,i,s){this.toggleItem(i._iid)}.bind(this,e,t,i,s),onStartDrag:function(e,t,i,s,a){!this.props.openedItemId&&this.refs.sortList.startDrag(s,a)}.bind(this,e,t,i,s)})}.bind(this,s,a))]):null,this.shouldShowHiddenItems()?n.createElement.apply(this,["span",{className:"hidden-items-container",key:"hidden-items-container"},l.map(this.props.hiddenItems,function(e,t,i,s){return n.createElement(c,{key:i._iid,item:i,className:l({"hidden-item":!0,selected:this.isSelected(i._iid),"no-hover":0<t,"is-open":this.props.openedItemId===i._iid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),isHidden:!0,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(i._iid),visibleFields:this.props.visibleFields,onSelect:function(e,t,i,s){this.toggleItem(i._iid)}.bind(this,e,t,i,s)})}.bind(this,s,a))]):null)))}.apply(this,[])}}),define("databaseEditor/components/itemsList",["create-react-class","prop-types","lodash","util","databaseEditor/components/itemsList.rt","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i,s,a,n){"use strict";function l(e){var t=this.getSelectedIds();return i.filter(e,function(e){return i.includes(t,e._iid)})}return e({displayName:"itemsList",mixins:[n,s.selectionMixin,s.propTypesFilterMixin],propTypes:{items:t.array.isRequired,hiddenItems:t.array.isRequired,openedItemId:t.string,listName:t.string.isRequired,listId:t.string.isRequired,visibleFields:t.arrayOf(t.string)},getDefaultProps:function(){return{openedItemId:void 0}},getInitialState:function(){return{itemsFilter:"all"}},duplicateSelectedItems:function(){this.getDbEditorApi().duplicateItems(l.call(this,this.filteredItems()),"multiple_selection"),this.clearSelection()},deleteSelectedItems:function(){this.getDbEditorApi().deleteItems(l.call(this,this.filteredItems()),"multiple_selection",this.clearSelection)},showHideSelectedItems:function(){var e=l.call(this,this.props.items),t=l.call(this,this.props.hiddenItems),i=0<t.length?"showItems":"hideItems";this.getDbEditorApi()[i](e.concat(t),"multiple_selection")},addItem:function(){var e=this.props.openedItemId?"item_view":"list_view";this.getDbEditorApi().addItem(e,function(e){this.getDbEditorApi().setCurrentItem(e)}.bind(this)),this.clearSelection(),i.includes(["all","visible"],this.state.itemsFilter)||this.setState({itemsFilter:"all"})},setCurrentItem:function(e){var t=this.getDbEditorApi(),i=this.props.openedItemId?"item_view":"list_view";t.setCurrentItem(e,i)},toggleItem:function(e){var t=this.isSelected(e);this.toggle(e),this.getDbEditorApi().bi.itemSelectionToggle(this.props.listId,e,!t)},toggleAllItems:function(){var e=i.map(this.filteredItems(),"_iid"),t=!i.isEmpty(this.getSelectedIds());this.toggleAll(e),this.getDbEditorApi().bi.allItemsSelectionToggle(this.props.listId,!t)},getItemsSelectionLabel:function(e){switch(e){case 0:return s.translate("list_dbe_select_all_label");case 1:return s.translate("list_dbe_1_items_selected");default:return s.translate("list_dbe_x_items_selected").replace("<X>",e)}},allItems:function(){return this.props.items.concat(this.props.hiddenItems)},setItemsFilter:function(e){this.setState({itemsFilter:e}),this.clearSelection()},filteredItems:function(){switch(this.state.itemsFilter){case"all":return this.allItems();case"visible":return this.props.items;case"hidden":return this.props.hiddenItems;default:return this.props.items}},shouldShowVisibleItems:function(){return this.props.items.length&&i.includes(["all","visible"],this.state.itemsFilter)},shouldShowHiddenItems:function(){return this.props.hiddenItems.length&&i.includes(["all","hidden"],this.state.itemsFilter)},render:a})}),define("databaseEditor/components/itemEdit.rt",["react","lodash","baseUI","baseUILib"],function(a,n,l,r){"use strict";return function(){return function(){var e,t,i,s=this.props.item;return a.createElement("div",(e={className:"item-edit",key:this.props.item._iid},t=this.filteredProps(),i=n.assign({},e,t),e.hasOwnProperty("style")&&(i.style=n.defaults(i.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(i.className=t.className+" "+e.className),i),a.createElement("div",{className:"no-scroll-container"},a.createElement("header",{className:"item-header"},a.createElement("div",{className:"button-container"},a.createElement(l.button,{className:"close-item-btn",icon:"arrowRight",label:"list_dbe_edit_item_close_item",onClick:function(e){this.getDbEditorApi().setCurrentItem(null)}.bind(this,s)})),a.createElement("span",{className:"action-container"},this.state.saveLabel?a.createElement("div",{className:"save-item-label",key:"save-item-label"},this.translateIfNeeded(this.state.saveLabel)):null,a.createElement(l.tooltip,{value:"list_dbe_hover_item_delete_tooltip"},a.createElement(l.button,{className:"delete-item-btn",icon:"delete",onClick:function(e){this.getDbEditorApi().deleteItems([e],"edit_item")}.bind(this,s)})),a.createElement(l.tooltip,{value:"list_dbe_hover_item_duplicate_tooltip"},a.createElement(l.button,{className:"duplicate-item-btn",icon:"duplicate",onClick:function(e){this.getDbEditorApi().duplicateItems([e],"edit_item")}.bind(this,s)}))))),a.createElement(r.CustomScroll,{heightRelativeToParent:"calc(100% - 67px)"},a.createElement.apply(this,["div",{className:"item-fields-container"},n.map(this.getFields(),function(e,t,i){return a.createElement("div",{className:"item-field",key:t.definition.name},a.createElement(t.component,{ref:i,item:e,fieldDef:t.definition,placeholder:t.placeholder,visibleSections:{PhoneLink:!1}}))}.bind(this,s)),a.createElement("div",{className:"unused-fields-text"},this.translateIfNeeded("list_dbe_edit_hiding_unused_fields"))])))}.apply(this,[])}}),define("databaseEditor/components/linkTo/linkToField.rt",["react","lodash","panels","util"],function(s,a,n,l){"use strict";return function(){return s.createElement(n.commonControls.linkTo,(e={className:l.inheritClassName("input-link-to-field"),value:this.getLinkData(),onChange:this.setLinkData,showButton:!1,showIcon:!0},t=this.filterProps(),i=a.assign({},e,t),e.hasOwnProperty("style")&&(i.style=a.defaults(i.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(i.className=t.className+" "+e.className),i));var e,t,i}}),define("databaseEditor/components/linkTo/linkToFieldButton.rt",["react","lodash","panels"],function(e,t,i){"use strict";return function(){return e.createElement(i.commonControls.linkToButton,t.assign({},{value:this.getLinkData(),onChange:this.setLinkData},this.filterProps()))}}),define("databaseEditor/components/linkTo/linkToField",["create-react-class","prop-types","lodash","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/linkTo/linkToField.rt","databaseEditor/components/linkTo/linkToFieldButton.rt"],function(e,t,i,s,a,n){"use strict";return e({displayName:"linkToField",propTypes:{item:t.object.isRequired,fieldDef:t.object.isRequired,useLinkButton:t.bool,label:t.string,placeholder:t.string,minCharsForTooltip:t.number,showButton:t.bool,buttonEditLabel:t.string,buttonAddLabel:t.string},mixins:[s],getDefaultProps:function(){return{useLinkButton:!1}},getLinkData:function(){return this.props.item.links&&this.props.item.links[this.props.fieldDef.name]},setLinkData:function(e){var t={};t[this.props.fieldDef.name]=e,this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,{links:t})},filterProps:function(){return i.omit(this.props,["pages","anchors","value","onChange","valueLink"])},render:function(){return(this.props.useLinkButton?n:a).call(this)}})}),define("databaseEditor/components/itemFields/textItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(s,a,n,l){"use strict";return function(){return s.createElement("div",{className:"text-item-field"},s.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),s.createElement("div",{className:"text-input"},s.createElement(n.textInput,{value:a.unescape(this.getFieldValue()),onChange:function(e){this.updateFieldValue(a.escape(e))}.bind(this),maxLength:500,placeholder:this.props.placeholder}),this.hasLink()?null:s.createElement(l,a.assign({},{key:"noLink",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?s.createElement(l,(e={className:"input-link-to",key:"hasLink",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},t=this.getLinkToFieldProps(),i=a.assign({},e,t),e.hasOwnProperty("style")&&(i.style=a.defaults(i.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(i.className=t.className+" "+e.className),i)):null);var e,t,i}}),define("databaseEditor/mixins/itemFieldMixin",["lodash","prop-types","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i){"use strict";return{propTypes:{item:t.object.isRequired,fieldDef:t.object.isRequired},mixins:[i],getFieldDisplayName:function(){return this.props.fieldDef.displayName||this.props.fieldDef.name},getFieldValue:function(e,t){var i,s=t||this.props,a=s.item[s.fieldDef.name];return e&&(i=a,a=(e||[]).reduce(function(e,t){return e&&e[t]},i)),a},updateFieldValue:function(e,t){var i=[this.props.fieldDef.name].concat(t||[]).concat(e),s=i.reduceRight(function(e,t){var i={};return i[t]=e,i});this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,s)},linkedFieldValue:function(t){var i=this;return{value:this.getFieldValue(t),requestChange:function(e){i.updateFieldValue(e,t)}}},hasLink:function(){return this.props.item.links&&!!this.props.item.links[this.props.fieldDef.name]},getLinkToFieldProps:function(){return e.pick(this.props,["item","fieldDef","visibleSections"])}}}),define("databaseEditor/components/itemFields/textItemField",["create-react-class","lodash","databaseEditor/components/itemFields/textItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s){"use strict";return e({displayName:"textItemField",mixins:[s],render:i})}),define("databaseEditor/components/itemFields/buttonItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s){"use strict";return function(){return e.createElement("div",{className:"text-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"text-input"},e.createElement(i.textInput,{valueLink:this.linkedFieldValue(),placeholder:"list_dbe_button_placeholder",maxLength:100})),e.createElement(s,t.assign({},{label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps()),'\r\n            showIcon="',!0,'"\r\n    '))}}),define("databaseEditor/components/itemFields/buttonItemField",["create-react-class","lodash","databaseEditor/components/itemFields/buttonItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s){"use strict";return e({displayName:"buttonItemField",mixins:[s],render:i})}),define("databaseEditor/components/itemFields/dateItemField.rt",["react","lodash","baseUI","constants","santa-editor-symbols","util","uiAnimations","databaseEditor/components/linkTo/linkToField"],function(a,n,l,r,o,d,c,m){"use strict";return function(){return function(){var e,t,i,s=this.getValueAsDate();return a.createElement("div",{className:"date-item-field"},a.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),a.createElement("div",{className:"text-input"},a.createElement("div",{className:n({"control-text-input":!0,"date-picker-open":this.state.dateBubbleOpen}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),onClick:this.toggleDateBubble},a.createElement(o.symbol,{name:"calendar"}),a.createElement("span",{ref:"dateSpan",className:n({disabled:n.isEmpty(this.getFieldValue().iso)}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},s?s.toLocaleDateString():d.translate("list_dbe_date_empty"))),this.hasLink()?null:a.createElement(m,n.assign({},{key:"add-link-button",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?a.createElement(m,(e={className:"input-link-to",key:"link-to-field",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},t=this.getLinkToFieldProps(),i=n.assign({},e,t),e.hasOwnProperty("style")&&(i.style=n.defaults(i.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(i.className=t.className+" "+e.className),i)):null,a.createElement(c.tooltipAnimation,{},this.state.dateBubbleOpen?a.createElement(l.bubble,{key:"dateBubble",value:this.getDatePicker(s),width:"301px",closeTriggers:[r.UI.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:r.UI.TOOLTIP.ALIGNMENT.BOTTOM,styleType:r.UI.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.hideDateBubble,targetNode:this.refs.dateSpan,ref:"popup",style:{position:"absolute"}}):null))}.apply(this,[])}}),define("databaseEditor/components/itemFields/dateItemField",["react","create-react-class","lodash","baseUI","databaseEditor/mixins/itemFieldMixin","databaseEditor/components/itemFields/dateItemField.rt"],function(i,e,s,a,t,n){"use strict";var l=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return e({displayName:"dateItemField",mixins:[t],getInitialState:function(){return{dateBubbleOpen:!1}},getDatePicker:function(e){var t={value:e,onChange:this.updateDate,todayLabel:"list_DatePicker_TodayButton_Label",goToSelectedLabel:"list_DatePicker_GoToSelectedButton_Label",monthNames:s.map(l,function(e){return"list_DatePicker_MonthsConstLong_"+e}),days:s.map(r,function(e){return"list_DatePicker_DayConstShort_"+e}),startDay:"list_DatePicker_DayConstShort_Sunday",popOnlyValue:!0,showDelete:!0};return i.createElement(a.datePicker,t)},getValueAsDate:function(){var e=this.getFieldValue();return e&&e.iso?new Date(e.iso):null},updateDate:function(e){this.updateFieldValue(e?e.toISOString():"","iso"),this.toggleDateBubble()},toggleDateBubble:function(){this.setState({dateBubbleOpen:!this.state.dateBubbleOpen})},hideDateBubble:function(){this.setState({dateBubbleOpen:!1})},render:n})}),define("databaseEditor/components/itemFields/imageItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(a,n,l,r){"use strict";return function(){return function(){var e,t,i,s=this.getFieldValue();return a.createElement("div",{},a.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),a.createElement("div",{className:"image-item-field"},a.createElement(l.imageChangeRemove,{className:"image-panel",addButtonLabel:"list_dbe_edit_item_image_add_image",changeButtonLabel:"list_dbe_edit_item_change_image",removeButtonLabel:"list_dbe_edit_item_remove_image",onChange:this.onMediaRemoved,mediaManager:this.getDbEditorApi().mediaServices.mediaManager,focusEditorFunc:this.getDbEditorApi().mediaServices.setFocusToEditor,value:this.getWPhotoData(s)}),a.createElement("div",{className:"text-panel"},a.createElement(l.textInput,{label:"list_dbe_edit_item_alt",placeholder:"list_dbe_edit_item_alt_placeholder",value:s.title,onChange:this.updateTitle,maxLength:100,disabled:n.isEmpty(s.src)}),a.createElement(r,(e={className:"input-link-to",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder",disabled:n.isEmpty(s.src),showIcon:!0},t=this.getLinkToFieldProps(),i=n.assign({},e,t),e.hasOwnProperty("style")&&(i.style=n.defaults(i.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(i.className=t.className+" "+e.className),i)))))}.apply(this,[])}}),define("databaseEditor/components/itemFields/imageItemField",["create-react-class","lodash","databaseEditor/components/itemFields/imageItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,i,t,s){"use strict";return e({displayName:"imageItemField",mixins:[s],updateTitle:function(e){this.updateFieldValue(e,["title"])},getWPhotoData:function(e){return i.assign({type:"Image",uri:e.src},i.pick(e,["title","width","height"]))},onMediaRemoved:function(e){var t={src:"",title:"",height:0,width:0};e&&i.assign(t,{src:e.uri,title:e.title,height:e.height,width:e.width}),this.updateFieldValue(t)},render:t})}),define("databaseEditor/components/itemFields/richTextItemField.rt",["react","lodash","textControls","wixRichText"],function(e,t,i,s){"use strict";return function(){return e.createElement("div",{className:t({"rich-text-item-field":!0,editing:this.state.editing}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:t({"rich-text-input-control":!0,"rich-text-input":!0,"with-toolbar":this.state.editing}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement(i.richTextFrame,{onOuterClick:this.onOuterClick},this.state.editing?e.createElement(i.textToolBar,t.assign({},{key:"textToolbar",ref:"toolbar",textManager:this.manager,linksHelper:this.linksHelper,cmdState:this.state.cmdState,openLinkPanel:this.openLinkDialog,openColorPicker:this.openColorPicker},this.getToolbarProps())):null,e.createElement(s.TextEditor,{initialData:this.getInitialValue(),onReady:this.setReady,showToolbar:!1,validateHtml:!1,documentServicesApi:this.getDbEditorApi().siteInfo,stylesManager:this.getStyleManager(),linksManager:this.getLinksManager(),onDataChange:this.handleDataChanged,autoGrow:!1,onCut:this.onCutOrCopy,onCopy:this.onCutOrCopy}))))}}),define("databaseEditor/migrations/richTextMigrations",["lodash"],function(t){"use strict";var i=/<hatul[^>]*>/gi,s=/<\/hatul>/gi;return{migrateToCurrentVersion:function(e){return 3<=t.get(e,"version",0)||(e.text=e.text.replace(i,"").replace(s,""),e.version=3),e},getCurrentVersion:function(){return 3}}}),define("databaseEditor/components/itemFields/richTextItemField",["create-react-class","lodash","stateManagement","util","databaseEditor/components/itemFields/richTextItemField.rt","databaseEditor/mixins/itemFieldMixin","textControls","databaseEditor/migrations/richTextMigrations"],function(e,s,t,a,i,n,l,r){"use strict";var o=e({displayName:"richTextItemField",mixins:[n],getInitialState:function(){return{editing:!1}},getToolbarProps:function(){var e=this.getDbEditorApi().getSiteInfo();return{themeColors:e.theme.colors.getAll(),themeFonts:e.theme.fonts.getAll(),fonts:l.fontUtils.getCurrentSelectableFontsWithParams(e),themeMap:e.theme.fonts.getMap(),isColorPickerClosed:this.isColorPickerClosed(),isLinkDialogClosed:this.isLinkDialogClosed(),isDeveloperMode:e.developerMode.isEnabled()}},isColorPickerClosed:function(){return this.props.isColorPickerClosed},isLinkDialogClosed:function(){return this.props.isLinkDialogClosed},getValue:function(){var e=this.getFieldValue();return"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(e=r.migrateToCurrentVersion(e)),{text:e.text,linkList:e.links}},getInitialValue:function(){return l.dataUtils.wrapOrphans(this.getValue().text)},handleDataChanged:function(e){this.updateValue({text:e,linkList:this.linksHelper.getAllLinks()})},updateValue:function(e){var t={text:e.text,links:e.linkList};"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(t.version=r.getCurrentVersion()),this.updateFieldValue(t)},getPanelManager:function(){return this.getDbEditorApi().panelManager},openLinkDialog:function(e,t){var i=this.getDbEditorApi(),s=a.link.getLinkPanelProps(i.documentServices,{link:e,callback:t,visibleSections:this.props.visibleSections});i.panelManager.openPanel("panels.toolPanels.linkPanel",s)},setReady:function(e){this.manager=e;var t=this;this.manager.onCmdStateChange(function(e){t.setState({cmdState:e})});var i=this.getDbEditorApi().siteInfo.theme.fonts.getAll(),s=l.fontUtils.getUploadedUsedFonts(this.getValue().text,i);l.ckUtils.insertUploadedFontsToCk(s,this.manager),this.manager.onFocus(function(){t.onFocus()}),this.linksHelper.setCurrentLinks(this.getValue().linkList);var a=this.manager.getCommandsStates();this.setState({cmdState:a})},openColorPicker:function(e,t,i,s,a){this.getDbEditorApi().panelManager.openPanel("panels.toolPanels.colorPicker.colorPickerPanel",{value:t,onChange:e,isBlockingLayerFullScreen:!0,shouldBlockOuterScroll:!0,top:s.top,left:s.left,previewOnHover:a},!0)},onFocus:function(){l.ckUtils.removeOverflowCss(this.manager),this.setState({editing:!0})},isFocusOnToolbar:function(){if(this.refs.toolbar)return!this.isColorPickerClosed()||!this.isLinkDialogClosed()||this.refs.toolbar.isAnyDropdownOpen()},onOuterClick:function(){this.isFocusOnToolbar()||(l.ckUtils.setOverflowCss(this.manager),this.setState({editing:!1}),this.clearUnusedLinks(),this.manager.unRegisterListener(this.handleCommandState))},getNonPasteableLinkTypes:function(){return s.pick(a.link.LinkTypes,["PHONE_LINK"])},componentWillMount:function(){this.linksHelper=new l.LinksHelper([],this.getNonPasteableLinkTypes()),this.linksManager=new l.TextLinksManager(this.linksHelper),this.stylesManager={getFonts:s.partial(l.fontUtils.getCurrentSelectableFontsWithParams,this.getDbEditorApi().siteInfo,!1,!0)}},getStyleManager:function(){return this.stylesManager},getLinksManager:function(){return this.linksManager},onCutOrCopy:function(){this.linksHelper.cacheCopiedLinks()},clearUnusedLinks:function(){var e=this.linksHelper.getAllLinks(),t=this.manager.getLinkRefsList(),i=s.filter(e,function(e){return s.includes(t,e.id)});if(!s.isEqual(i,this.getValue().linkList)){this.updateValue({text:this.getValue().text,linkList:i})}},render:i});return a.hoc.connect(function(e){return{isColorPickerClosed:t.editorPlugins.panels.selectors.isColorPickerClosed(e),isLinkDialogClosed:t.editorPlugins.panels.selectors.isLinkDialogClosed(e)}})(o)}),define("databaseEditor/components/itemFields/videoItemField.rt",["react","lodash","baseUI","util"],function(t,e,i,s){"use strict";return function(){return t.createElement("div",{className:"video-item-field"},t.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),function(){var e=this.state.status;return t.createElement("div",{className:"inputs-container "+e},t.createElement(i.videoInput,{valueLink:this.linkedFieldValue(),nonEmptyButtonLabel:"list_dbe_edit_item_search_video",emptyButtonLabel:"list_dbe_edit_item_search_video",panelManager:this.getDbEditorApi().panelManager}),t.createElement("div",{},t.createElement(i.textInput,{ref:"textInput",className:"video-url-input",label:"list_dbe_edit_item_video_url",value:this.state.videoUrl,onChange:this.updateVideoUrl,placeholder:this.props.placeholder}),t.createElement("div",{className:"error-msg-and-button"},t.createElement("span",{},"invalid"===e?s.translate("list_dbe_edit_item_bad_video_url"):""),this.state.videoUrl!==this.getVideoUrl()&&"idle"===e?t.createElement(i.button,{key:"update-button",className:"update-button",label:"list_dbe_edit_item_update_video_url",onClick:this.handleClick}):null,"idle"!==e?t.createElement(i.symbol,{key:"validation-status",name:"valid"===e?"inputValidationSuccess":"inputValidationError"}):null)))}.apply(this,[]))}}),define("databaseEditor/components/itemFields/videoItemField",["create-react-class","lodash","util","databaseEditor/components/itemFields/videoItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,i,t,s,a){"use strict";function n(){this.success=!0;if(this.setState({status:"valid"}),i.isEmpty(this.state.videoUrl))this.updateFieldValue({videoId:""});else{var e=t.videoUtils.getVideoDataFromUrl(this.state.videoUrl);this.updateFieldValue({videoType:e.videoType,videoId:e.videoId})}i.delay(function(){this.success=!1,this.setState({status:"idle"})}.bind(this),2e3)}return e({displayName:"videoItemField",mixins:[a],getInitialState:function(){return{status:"idle",videoUrl:this.getVideoUrl()}},componentWillReceiveProps:function(e){var t=this.getVideoUrl(e);i.isEqual(this.getVideoUrl(),t)||this.updateVideoUrl(t)},getVideoUrl:function(e){return t.videoUtils.getVideoUrl(this.getFieldValue(null,e))},updateVideoUrl:function(e){this.setState({status:this.success?this.state.status:"idle",videoUrl:e})},handleClick:function(){i.isEmpty(this.state.videoUrl)?i.defer(n.bind(this)):t.videoUtils.verifyVideoUrl(this.state.videoUrl,n.bind(this),function(){this.setState({status:"invalid"}),this.refs.textInput.focus()}.bind(this))},render:s})}),define("databaseEditor/components/itemEdit",["create-react-class","prop-types","lodash","util","databaseEditor/components/itemEdit.rt","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/itemFields/textItemField","databaseEditor/components/itemFields/buttonItemField","databaseEditor/components/itemFields/dateItemField","databaseEditor/components/itemFields/imageItemField","databaseEditor/components/itemFields/richTextItemField","databaseEditor/components/itemFields/videoItemField"],function(e,t,a,i,s,n,l,r,o,d,c,m){"use strict";var u={string:l,"string|asprice":l,"string|asbutton":r,"wix:image":d,"wix:richtext":c,"wix:video":m,"wix:date":o},p={Error:"list_dbe_edit_item_status_error",Saving:"list_dbe_edit_item_status_saving",Saved:"list_dbe_edit_item_status_saved",Idle:"list_dbe_edit_item_status_idle",Failed:"list_dbe_edit_item_status_error"},h={Title:"list_dbe_title_placeholder",Subtitle:"list_dbe_subtitle_placeholder",Description:"list_dbe_description_placeholder",Price:"list_dbe_price_placeholder",Video:"list_dbe_edit_item_video_link_placeholder"};function b(e){if(e.item._iid!==this.props.item._iid)this.setState({saveLabel:null});else{var t=e.saveState!==this.props.saveState;(t=t&&!("Idle"===e.saveState&&a.includes(["Saved","Failed","Error"],this.props.saveState)))&&this.setState({saveLabel:(i=e.saveState,p[i])})}var i}return e({displayName:"itemEdit",mixins:[n,i.propTypesFilterMixin,i.blockOuterScrollMixin,i.translationMixin],propTypes:{item:t.object.isRequired,itemSchema:t.object.isRequired,saveState:t.string.isRequired,visibleFields:t.arrayOf(t.string)},getInitialState:function(){return{saveLabel:null}},componentWillReceiveProps:function(e){b.call(this,e)},getFields:function(){var t=this;return a(t.props.itemSchema.fields).filter(function(e){return a.includes(t.props.visibleFields,e.name)||"title"===e.name}).map(function(e){return{component:(t=e,i=t.metadata&&t.metadata.showAsHint,s=a.compact([t.type,i]).join("|"),u[s.toLowerCase()]),definition:e,placeholder:h[e.displayName]||""};var t,i,s}).filter("component").value()},render:s})}),define("databaseEditor/dbEditor/dbEditor.rt",["react","lodash","databaseEditor/components/itemsList","databaseEditor/components/itemEdit","uiAnimations"],function(e,t,i,s,a){"use strict";return function(){return e.createElement("div",{className:"db-editor-container",onMouseDown:this.blockMiddleMouseClick},e.createElement(i,{items:this.props.items,hiddenItems:this.props.hiddenItems,openedItemId:this.props.currentItemId,listName:this.props.listName,listId:this.props.currentListId,visibleFields:this.props.visibleFields}),e.createElement(a.dbEditItemSlide,{direction:"right"},this.props.currentItemId?e.createElement(s,{key:"item-edit",item:this.getItem(this.props.currentItemId),itemSchema:this.props.itemSchema,visibleFields:this.props.visibleFields,saveState:this.props.saveState}):null))}}),define("databaseEditor/dbEditor/dbEditor",["create-react-class","prop-types","lodash","uiAnimations","databaseEditor/dbEditor/dbEditor.rt"],function(e,t,i,s,a){"use strict";return e({displayName:"dbEditor",mixins:[s.animationManager],propTypes:{dbEditorApi:t.object.isRequired,currentListId:t.string,items:t.array,hiddenItems:t.array,currentItemId:t.string,listName:t.string,itemSchema:t.object,saveState:t.string,visibleFields:t.arrayOf(t.string)},childContextTypes:{dbEditorApi:t.object.isRequired,mediaServices:t.object},getDefaultProps:function(){return{items:[]}},componentDidMount:function(){this.props.dbEditorApi.bi.dbEditorOpenSuccess(this.props.currentListId)},componentWillUnmount:function(){this.props.dbEditorApi.updateList()},getChildContext:function(){return{dbEditorApi:this.props.dbEditorApi,mediaServices:this.props.dbEditorApi.mediaServices}},getItem:function(e){return i.find(this.props.items,{_iid:e})||i.find(this.props.hiddenItems,{_iid:e})},blockMiddleMouseClick:function(e){if(1===e.button)return!1},render:a})}),define("databaseEditor/dbEditor/DbEditorApi",["lodash","mediaServices","util","experiment"],function(p,h,s,b){"use strict";var _={idle:"Idle",saved:"Saved",failed:"Failed",saving:"Saving"};function f(e){return"databaseEditor.panels."+e}function g(){var t=I.call(this);p.forEach(this.stateChangedCallbacks,function(e){e(t)})}function o(){return this.appbuilderServices.data.lists.getItems(this.currentListId)}function d(){return this.appbuilderServices.data.lists.getHiddenItems(this.currentListId)}function E(){var e=this.appbuilderServices.layout.getAllFields,t=p(this.currentListId).thru(e).reject("hidden").map("name").value(),i=p(e(this.currentListId,"Mobile")).reject("hidden").map("name").value();return p.uniq(t.concat(i))}function i(e,t){t?window.setTimeout(i.bind(this,e),t):(this.saveState=e,g.call(this))}function I(){var e=this.dataService.wasRepoLoaded(),t=e&&this.dataService.wasListLoaded(this.currentListId);return{currentListId:this.currentListId,items:t?o.call(this):[],hiddenItems:t?d.call(this):[],currentItemId:this.currentItemId,listName:e?function(){return this.appbuilderServices.data.lists.getListName(this.currentListId)}.call(this):null,itemSchema:e?this.appbuilderServices.data.lists.getItemSchema(this.currentListId):null,visibleFields:this.visibleFields,dbEditorApi:this,openPanels:this.panelManager.getOpenPanels(),saveState:this.saveState,loading:!t}}function c(){(this.sohuldRender=!0)!==this.disableAutoSave?this.saveState!==_.saving?(i.call(this,_.saving),this.appbuilderServices.save(function(){if(i.call(this,_.saved),this.savePending)return this.savePending=!1,void c.call(this);window.setTimeout(function(){this.saveState!==_.saving&&i.call(this,_.idle)}.bind(this),this.idleTimeout)}.bind(this),function(){this.savePending=!1,i.call(this,_.failed),i.call(this,_.idle,this.idleTimeout),this.panelManager.openPanel(f("saveFailedMessagePanel"))}.bind(this))):this.savePending=!0:g.call(this)}function m(e,t){return p.filter(e,function(e){return p.find(t,{_iid:e._iid})})}function u(e,t){var i=p.assign({},t,{title:s.translate("list_dbe_prefix_for_duplicated_item")+t.title});return this.appbuilderServices.data.items.create(e,i)}function e(e,t,i,s,a,n,l,r,o,d,c){var m,u;p.bindAll(this,["getServiceTopology","setCurrentList","getPagesData","getSiteMenuItems","createDefaultDataItem","setCurrentItem","debouncedSave","broadcastStateChanged","moveItem","addItem","updateItem","duplicateItems","deleteItems","showItems","hideItems","getCurrentListVersion","registerForStateChanged","getSiteInfo"]),this.disableAutoSave=d,this.idleTimeout=r,this.dataService=e,this.appbuilderServices=i.wixapps.appbuilder,this.documentServices=i,this.siteInfo=s,this.serviceTopology=a,this.stateChangedCallbacks=[],this.currentListId=l,this.currentItemId=null,this.saveState=_.idle,this.savePending=!1,this.sohuldRender=!1,this.panelManager=(m=n,(u=Object.create(m)).openPanel=function(e,t){m.openPanel(e,t,!0)},u),this.mediaServices=c||h.create(this),this.bi=t,b.isOpen("appBuilderDataMigration")&&this.appbuilderServices.migration.migrateList(l),e.registerForUpdates(function(e){var t=this.dataService.wasRepoLoadErroneous(),i=this.dataService.wasListLoadErroneous(e);t||i?(this.bi.listLoadFailed(e,!t,!i),this.panelManager.openPanel(f("loadFailedMessagePanel"),{onConfirm:function(){window.location.reload()}})):g.call(this)}.bind(this)),o&&(this.visibleFields=E.call(this),o(I.call(this)))}return e.prototype={updateList:function(){this.sohuldRender&&p.has(this.appbuilderServices.data,"markDataAsUpdated")&&(this.appbuilderServices.data.markDataAsUpdated(this.currentListId),this.sohuldRender=!1)},getServiceTopology:function(){return this.serviceTopology},setCurrentList:function(e){this.currentListId=e,this.currentItemId=null,this.dataService.loadListData(e),this.visibleFields=E.call(this),g.call(this)},getPagesData:function(){return this.dsRead.pages.getPagesData()},getSiteMenuItems:function(){return this.dsRead.mainMenu.getMenu()},createDefaultDataItem:function(e){return this.dsRead.data.createItem(e)},setCurrentItem:function(e,t){this.currentItemId=e,g.call(this),e&&t&&this.bi.itemEdit(t,this.currentListId,e)},debouncedSave:p.debounce(c,500),broadcastStateChanged:g,moveItem:function(e,t){var i=this.appbuilderServices.data.lists.selection.get(this.currentListId),s=i.itemIds,a=s[e];s.splice(t,0,s.splice(e,1)[0]),this.bi.itemMove(this.currentListId,i.id,a),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,s),c.call(this)},addItem:function(e,t){t=t||p.noop;var i=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),s=this.appbuilderServices.data.items.create(i),a=this.appbuilderServices.data.lists.selection.get(this.currentListId),n=a.itemIds;return n.unshift(s),this.bi.itemAdd(e,this.currentListId,a.id,s),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,n),t(s),c.call(this),s},updateItem:function(e,t,i){this.appbuilderServices.data.items.update(e,t,i),this.debouncedSave(),g.call(this)},duplicateItems:function(e,t){var i=p.map(e,"_iid"),s=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),a=this.appbuilderServices.data.lists.selection.get(this.currentListId);this.bi.itemsDuplicate(t,this.currentListId,a.id,i),p.forEach(m(e,d.call(this)),p.bind(u,this,s));var n=p.map(m(e,o.call(this)),p.bind(u,this,s)),l=a.itemIds,r=p.findLastIndex(l,function(e){return p.includes(i,e)});l.splice.apply(l,[r+1,0].concat(n)),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,l),this.currentItemId&&this.setCurrentItem(p.last(n)),c.call(this)},deleteItems:function(t,i,s){var a=this;s=s||p.noop,this.panelManager.openPanel(f("deleteItemsConfirmationPanel"),{onConfirm:function(){var e=a.appbuilderServices.data.lists.selection.get(a.currentListId);a.bi.itemsDelete(i,a.currentListId,e.id,p.map(t,"_iid")),p.forEach(t,function(e){if(a.currentItemId===e._iid){var t=p.map(o.call(a),"_iid"),i=t.indexOf(e._iid),s=t[i+1]||t[i-1]||null;a.setCurrentItem(s)}a.appbuilderServices.data.items.delete(e._type,e._iid)}),s(),c.call(a)},onCancel:p.noop})},showItems:function(e){var t=this.appbuilderServices.data.lists.selection.get(this.currentListId),i=p.map(e,"_iid"),s=p.union(t.itemIds,i);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,s),c.call(this)},hideItems:function(e){var t=this.appbuilderServices.data.lists.selection.get(this.currentListId),i=p.map(e,"_iid"),s=p.difference(t.itemIds,i);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,s),c.call(this)},getCurrentListVersion:function(){return this.appbuilderServices.data.lists.getListVersion(this.currentListId)},registerForStateChanged:function(e){this.stateChangedCallbacks.push(e)},getSiteInfo:function(){return this.siteInfo}},e}),define("databaseEditor/panels/deleteItemsConfirmationPanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){"use strict";return function(){return e.createElement(i.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"delete-list-items-confirmation",type:"important",panelTitle:this.translateIfNeeded("list_dbe_delete_are_you_sure_title"),onCancel:this.props.onCancel,onConfirm:this.props.onConfirm,confirmLabel:"list_dbe_delete_are_you_sure_confirm_button",cancelLabel:"list_dbe_delete_are_you_sure_cancel_button"},e.createElement(s.symbol,{name:"garbage-truck-clipart",className:"image"}),e.createElement("div",{className:"text"},e.createElement("span",{},this.translateIfNeeded("list_dbe_delete_items_subtitle")),e.createElement("span",{},this.translateIfNeeded("list_dbe_delete_are_you_sure_text"))))}}),define("databaseEditor/panels/deleteItemsConfirmationPanel",["create-react-class","util","lodash","databaseEditor/panels/deleteItemsConfirmationPanel.rt"],function(e,t,i,s){"use strict";return e({displayName:"deleteItems",mixins:[t.translationMixin],render:s})}),define("databaseEditor/panels/saveFailedMessagePanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){"use strict";return function(){return e.createElement(i.frames.messagePanelFrame,{className:"list-save-failed-panel",panelName:this.props.panelName,confirmLabel:"list_dbe_general_error_button",panelTitle:this.translateIfNeeded("list_dbe_general_error_dialog_title")},e.createElement("div",{className:"content-wrapper"},e.createElement(s.symbol,{name:"plaster",className:"error-img"}),e.createElement("div",{className:"msg-text"},e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_subtitle")),e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_text")),e.createElement("p",{},e.createElement("br",{})),e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_text_2")),e.createElement("a",{className:"support-link",href:"https://www.wix.com/support/html5/"},"https://www.wix.com/support/"))))}}),define("databaseEditor/panels/saveFailedMessagePanel",["create-react-class","util","lodash","core","databaseEditor/panels/saveFailedMessagePanel.rt"],function(e,t,i,s,a){"use strict";return e({displayName:"saveFailedMessagePanel",mixins:[t.translationMixin,s.mixins.editorAPIMixin],render:a})}),define("databaseEditor/panels/loadFailedMessagePanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){"use strict";return function(){return e.createElement(i.frames.confirmationPanelFrame,{panelName:this.props.panelName,panelTitle:this.translateIfNeeded("list_dbe_loading_error_title"),className:"list-load-failed-panel",onConfirm:this.props.onConfirm,onCancel:this.props.onCancel,confirmLabel:"list_dbe_loading_error_button",cancelLabel:"list_dbe_error_loading_close_manage_items"},e.createElement(s.symbol,{name:"plaster",className:"error-img"}),e.createElement("div",{className:"msg-text"},e.createElement("span",{},this.translateIfNeeded("list_dbe_loading_error_subtitle")),e.createElement("span",{},this.translateIfNeeded("list_dbe_loading_error_text")),e.createElement("a",{className:"support-link",href:"https://www.wix.com/support/html5/"},"https://www.wix.com/support/")))}}),define("databaseEditor/panels/loadFailedMessagePanel",["create-react-class","util","lodash","databaseEditor/panels/loadFailedMessagePanel.rt"],function(e,t,i,s){"use strict";return e({displayName:"loadFailedMessagePanel",mixins:[t.translationMixin],render:s})}),define("databaseEditor/panels/panels",["databaseEditor/panels/deleteItemsConfirmationPanel","databaseEditor/panels/saveFailedMessagePanel","databaseEditor/panels/loadFailedMessagePanel"],function(e,t,i){"use strict";return{deleteItemsConfirmationPanel:e,saveFailedMessagePanel:t,loadFailedMessagePanel:i}}),define("databaseEditor/bi/events",[],function(){"use strict";var e="listim2";return{LIST_DB_MANAGER_OPENED:{src:59,endpoint:e,evid:107,fields:{list_part_id:"string"}},LIST_DB_MANAGER_ERROR_LOADING:{src:59,endpoint:e,evid:108,fields:{list_part_id:"string",error_description:"string"}},LIST_DB_MANAGER_REORDER_ITEMS_DROP:{src:59,endpoint:e,evid:109,fields:{item_id:"string",list_part_id:"string",selector_id:"string"}},LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK:{src:59,endpoint:e,evid:110,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_id:"string"}},LIST_DB_MANAGER_SELECT_ITEM_CLICK:{src:59,endpoint:e,evid:113,fields:{list_part_id:"string",item_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_SELECT_ALL_CLICK:{src:59,endpoint:e,evid:114,fields:{list_part_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_DUPLICATE_ITEM:{src:59,endpoint:e,evid:117,fields:{origin:"string",list_part_id:"string",selector_id:"string",source_item_ids:"string"}},LIST_DB_MANAGER_DELETE_ITEMS_CLICK:{src:59,endpoint:e,evid:118,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_ids:"string"}},LIST_DB_MANAGER_EDIT_ITEM_CLICK:{src:59,endpoint:e,evid:119,fields:{origin:"string",list_part_id:"string",item_id:"string"}},LIST_DB_MANAGER_LIST_LOAD_FAIL:{src:59,endpoint:e,evid:121,fields:{list_part_id:"string",repo_loaded:"bool",data_loaded:"bool"}}}}),define("databaseEditor/bi/service",["databaseEditor/bi/events","coreUtilsLib"],function(a,i){"use strict";function e(e){this._reportBI=e}return e.prototype={sendEvent:function(e,t){try{this._reportBI(e,t)}catch(e){i.log.info("Error sending BI event",e)}},dbEditorOpenSuccess:function(e){this.sendEvent(a.LIST_DB_MANAGER_OPENED,{list_part_id:e})},dbEditorOpenFailed:function(e,t){this.sendEvent(a.LIST_DB_MANAGER_ERROR_LOADING,{list_part_id:e,error_description:t.toString()})},listLoadFailed:function(e,t,i){this.sendEvent(a.LIST_DB_MANAGER_LIST_LOAD_FAIL,{list_part_id:e,repo_loaded:t?"true":"false",data_loaded:i?"true":"false"})},itemMove:function(e,t,i){this.sendEvent(a.LIST_DB_MANAGER_REORDER_ITEMS_DROP,{item_id:i,list_part_id:e,selector_id:t})},itemAdd:function(e,t,i,s){this.sendEvent(a.LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK,{origin:e,list_part_id:t,selector_id:i,item_id:s})},itemsDuplicate:function(e,t,i,s){this.sendEvent(a.LIST_DB_MANAGER_DUPLICATE_ITEM,{origin:e,list_part_id:t,selector_id:i,source_item_ids:s.join(",")})},itemsDelete:function(e,t,i,s){this.sendEvent(a.LIST_DB_MANAGER_DELETE_ITEMS_CLICK,{origin:e,list_part_id:t,selector_id:i,item_ids:s.join(",")})},itemEdit:function(e,t,i){this.sendEvent(a.LIST_DB_MANAGER_EDIT_ITEM_CLICK,{origin:e,list_part_id:t,item_id:i})},itemSelectionToggle:function(e,t,i){this.sendEvent(a.LIST_DB_MANAGER_SELECT_ITEM_CLICK,{list_part_id:e,item_id:t,state_after_click:!!i})},allItemsSelectionToggle:function(e,t){this.sendEvent(a.LIST_DB_MANAGER_SELECT_ALL_CLICK,{list_part_id:e,state_after_click:!!t})}},e}),define("databaseEditor",["databaseEditor/dbEditor/dbEditor","databaseEditor/dbEditor/DbEditorApi","databaseEditor/panels/panels","databaseEditor/bi/service"],function(e,t,i,s){"use strict";return{dbEditor:e,DbEditorApi:t,panels:i,BIService:s}});
//# sourceMappingURL=databaseEditor.min.js.map