define("componentsPreviewLayer",["lodash","coreUtils","santa-components","componentsCore","prop-types","reactDOM","wixappsCore","previewExtensionsCore","compUtils","wixappsClassics","wixappsBuilder","componentsPreviewExtensions","stylable-panel-drivers","wix-ui-santa/stylable-preview.bundle","wix-ui-santa/wix-ui-santa.metadata.json.bundle"],function(e,t,n,i,r,o,s,a,c,p,u,l,f,d,h){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=516)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},12:function(e,t){e.exports=s},121:function(e,t){e.exports=u},184:function(e,t){e.exports=l},185:function(e,t){e.exports=f},19:function(e,t){e.exports=a},2:function(e,t){e.exports=n},22:function(e,t){e.exports=c},3:function(e,t){e.exports=i},4:function(e,t){e.exports=r},516:function(e,t,n){var i,r;i=[n(184),n(0),n(19),n(22),n(517),n(519),n(520),n(521),n(523),n(525),n(528),n(530)],void 0===(r=function(e,t,n,i,r){"use strict";return{extendCompClasses:function(){e.extendCompClasses(),i.compFactory.registerCommonExtensionForAllComponents(r),n.registrar.registerPreviewClasses()}}}.apply(t,i))||(e.exports=r)},517:function(e,t,n){var i,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};i=[n(2),n(7),n(0),n(518),n(185)],void 0===(r=function(e,t,n,i,r){"use strict";var a=i.definitions,c=function(e,t,n){var i=e;if(t||(i=function(e){return e.replace(/(?:transition(-[a-zA-Z]+)?)[ ]*:[ ]*[^;]+;?/g,"")}(i)),n){var r=Object.entries(n.declarationMap),o=r.filter(function(e){return!e[1]}).map(function(e){return s(e,1)[0]+": unset;\n"}).join(""),a=r.filter(function(e){return!!e[1]}).map(function(e){var t=s(e,2);return t[0]+": "+t[1]+";\n"}).join("");i+="/*quick changes*/\n            "+n.selector+" {\n                "+o+a+"}\n            "}return i},p=function(e,t,n){var i=t.selector,r=t.stateAttribute;if(i){var o=e.offsetParent.querySelectorAll(i);o&&r&&Array.from(o).forEach(function(e){return n(e,r)})}};return function(i){if(!i.stylable)return i;var s=function(e){function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,i),o(s,[{key:"componentDidUpdate",value:function(e){if(!n.isEqual(this.props.forceState,e.forceState)){var i=t.findDOMNode(this);o=i,s=e.forceState,p(o,s||{},function(e,t){e.removeAttribute(t)}),function(e,t){p(e,t||{},function(e,t){e.setAttribute(t,r.STATE_SET_VALUE)})}(i,this.props.forceState)}var o,s}}]),s}(),u=function(e,t){var n=t.rawCss,i=t.componentViewMode,r=t.quickChangeOverrides;return[c(n,"preview"===i,r)]};return u.cssTypes={rawCss:a.rawCss,componentViewMode:e.santaTypesDefinitions.RenderFlags.componentViewMode.isRequired,quickChangeOverrides:a.quickChangeOverrides},s.getCompCss=u,s.propTypes=n.defaults({forceState:a.forceState},i.propTypes),s}}.apply(t,i))||(e.exports=r)},518:function(e,t,n){var i,r;i=[n(0),n(4),n(1),n(3),n(2)],void 0===(r=function(e,t,n,i,r){"use strict";var o=n.propsSelectorsUtils.createComponentSantaTypeFetcher,s=r.santaTypesDefinitions,a=r.utils,c={rawCss:o(function(e,t){var n=e.fetchSantaType(s.Component.theme,e,t),i=e.fetchSantaType(s.Theme.THEME_DATA,e,t);return e.siteAPI.getSiteAspect("stylableRenderingAspect").transpileStylesheet(n,i,t.id)}),quickChangeOverrides:o(function(e,t){return e.siteAPI.getSiteAspect("stylableRenderingAspect").getQuickChanges(t.id)}),forceState:o(function(e,t){return e.siteAPI.getSiteAspect("stylableRenderingAspect").getForceState(t.id)})},p=a.createSantaTypesDefinitions({rawCss:t.string,quickChangeOverrides:t.shape({selector:t.string,declarationMap:t.string}),forceState:t.shape({selector:t.string,stateAttribute:t.string})},"Stylable2");return i.santaTypesFetchersRegistry.registerFetchersNamespace("Stylable2",c),{fetchers:c,definitions:p}}.apply(t,i))||(e.exports=r)},519:function(e,t,n){var i,r;i=[n(0),n(19),n(2),n(70)],void 0===(r=function(e,t,n){"use strict";function i(){this.viewName_=this.props.compData.viewName,this.customizationsCount_=this.props.compData.appLogicCustomizations.length,this.appLogicCustomizations_=this.props.compData.appLogicCustomizations}var r={propTypes:{previewTooltipCallback:n.santaTypesDefinitions.RenderRealtimeConfig.previewTooltipCallback},componentDidUpdate:function(){i.call(this)},componentDidMount:function(){i.call(this)},isChanged:function(t){return this.viewName_!==t.compData.viewName||this.props.compProp.direction!==t.compProp.direction||this.customizationsCount_!==t.compData.appLogicCustomizations.length||!e.isEqual(this.appLogicCustomizations_,t.compData.appLogicCustomizations)}};t.registrar.registerCompExtension("wixapps.integration.components.AppPart",r)}.apply(t,i))||(e.exports=r)},520:function(e,t,n){var i,r;i=[n(0),n(19),n(121)],void 0===(r=function(e,t,n){"use strict";var i={propTypes:{views:n.appBuilderSantaTypesDefinitions.views},isChanged:function(t){var n=e.cloneDeep(t.views.Array.vars),i=!e.isEqual(this.viewVars,n);return this.viewVars=n,i}};t.registrar.registerCompExtension("wixapps.integration.components.AppPart2",i)}.apply(t,i))||(e.exports=r)},521:function(e,t,n){var i,r;i=[n(522)],void 0===(r=function(e){"use strict";if("undefined"!=typeof window&&window.document&&window.santaBase&&!window.editorBase&!window.document.querySelector("#viewerMainStyle")&&!window.document.querySelector('link[href$="viewer.css"]')){var t=window.document.createElement("LINK");t.setAttribute("rel","stylesheet"),t.setAttribute("href",window.santaBase+"/static/css/viewer.css"),window.document.head.appendChild(t);var n=window.document.createElement("style");n.setAttribute("rel","stylesheet"),n.innerHTML=e,window.document.head.appendChild(n)}}.apply(t,i))||(e.exports=r)},522:function(e,t){e.exports=d},523:function(e,t,n){var i,r;i=[n(19),n(524),n(12)],void 0===(r=function(e){"use strict";e.registrar.extendProxyClasses()}.apply(t,i))||(e.exports=r)},524:function(e,t,n){var i,r;i=[n(0),n(19)],void 0===(r=function(e,t){"use strict";var n={componentDidUpdate:function(){this._itemsPerPage=i.call(this)},componentWillReceiveProps:function(){this.state.currentPage>1&&function(){return this._itemsPerPage&&this._itemsPerPage!==i.call(this)}.call(this)&&this.setState({currentPage:1})}};function i(){return this.getCompProp("itemsPerPage")}t.registrar.registerProxyExtension("PaginatedList",n)}.apply(t,i))||(e.exports=r)},525:function(e,t,n){var i,r;i=[n(19),n(70),n(526),n(527)],void 0===(r=function(e){"use strict";e.registrar.extendLogicClasses()}.apply(t,i))||(e.exports=r)},526:function(e,t,n){var i,r;i=[n(0),n(19),n(1),n(70)],void 0===(r=function(e,t,n,i){"use strict";var r=n.blogAppPartNames;function o(e){var t=this.partApi.getPreviewTooltipCallback();t&&t(e.target.getBoundingClientRect(),"PREVIEW_TOOLTIP_GOTO_LIVE_SITE")}t.registrar.registerLogicExtension(r.SINGLE_POST,{startSelection:e.noop,toggleLikeForPost:o,sharePost:o,isReady:function(){var t=i.blogSinglePostPageLogicUtils.getSinglePost(this.partApi);return e.isEmpty(t)||(t=i.blogSinglePostPageLogicUtils.transformPostIfPreview.call(this,t,this.partApi),i.blogSinglePostPageLogicUtils.updatePageTitleAndMetaTags.call(this,t,this.partApi)),!0}})}.apply(t,i))||(e.exports=r)},527:function(e,t,n){var i,r;i=[n(0),n(19),n(1)],void 0===(r=function(e,t,n){"use strict";var i=n.blogAppPartNames;t.registrar.registerLogicExtension(i.RELATED_POSTS,{getViewVars:function(){return{isEditMode:!0}},isHeightResizable:function(){return!0}})}.apply(t,i))||(e.exports=r)},528:function(e,t,n){var i,r;i=[n(0),n(3),n(185),n(529)],void 0===(r=function(e,t,n,i){"use strict";var r="stylableRenderingAspect",o="/site.st.css";function s(t){this.siteAPI=t;var r=e.mapValues(i.components,function(t){return e.assign({},t,{snapshots:['<div style="height: 60px;width:140px;"/>']})}),s=n.StylableEditor;this.stylableEditorInstance=new s(e.assign(i,{components:r}),o),this.theme=[],this.stylableEditorInstance.stylableDriver.writeFile(o,""),this.componentPathMap={}}function a(e){return e+"_quickChange"}function c(e){return e+"_forceState"}return s.prototype={getStylableEditorInstance:function(){return this.stylableEditorInstance},transpileStylesheet:function(t,n,i){if(!t)return!1;var r=this.stylableEditorInstance.stylableDriver,o="/"+t.id+".st.css",s=e.get(t,["style","properties","$st-css"],""),a=t.id;return this.componentPathMap[i]=o,this.updateTheme(n),r.writeFile(o,":import {-st-from: '/site.st.css'; -st-named: site_1_1, site_2_1, site_3_1, site_4_1, site_5_1, site_1_2, site_2_2, site_3_2, site_4_2, site_5_2, site_1_3, site_2_3, site_3_3, site_4_3, site_5_3, site_1_4, site_2_4, site_3_4, site_4_4, site_5_4, site_1_5, site_2_5, site_3_5, site_4_5, site_5_5;}\n"+s),r.stylable.process(o).namespace=a,r.buildCSS({entries:[o],emitBuild:!1})},updateTheme:function(t){if(e.has(this.theme,"color")&&e.isEqual(t.color,this.theme.color))return!1;this.theme=t,this.stylableEditorInstance.stylableDriver.getSiteVarsDriver(o).setSiteColors(function(e){for(var t=Object.values(e).slice(11),n=t.length/5,i=[],r=0;r<5;r++)i.push(t.splice(0,n));return i}(this.theme.color))},getQuickChanges:function(e){return this.siteAPI.getAspectComponentData(r,a(e))},setQuickChanges:function(e,t,n){var i=this.getComponentStylesheet(e);if(i){var o="#"+e+i.getTargetSelector(t,!0);this.siteAPI.setAspectComponentData(r,a(e),{selector:o,declarationMap:n})}},revertQuickChanges:function(e){this.siteAPI.setAspectComponentData(r,a(e))},getComponentStylesheet:function(e){var t=this.componentPathMap[e];return this.stylableEditorInstance.stylableDriver.getStylesheet(t)},forceState:function(e,t){var i=n.getStateOverrideHints,o=n.STYLABLE_OVERRIDE_STATE_PREFIX,s=this.getComponentStylesheet(e);if(s){var a=i(s.getTargetSelector(t),o),p=a.stateAttribute,u=a.selectorToQuery;this.siteAPI.setAspectComponentData(r,c(e),{selector:u,stateAttribute:p})}},revertForceState:function(e){this.siteAPI.setAspectComponentData(r,c(e))},getForceState:function(e){return this.siteAPI.getAspectComponentData(r,c(e))}},t.siteAspectsRegistry.registerSiteAspect(r,s),{aspect:s,name:r}}.apply(t,i))||(e.exports=r)},529:function(e,t){e.exports=h},530:function(e,t,n){var i,r,o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};i=[n(0),n(1),n(3),n(2),n(184)],void 0===(r=function(e,t,n,i,r){"use strict";var s=t.propsSelectorsUtils.createComponentSantaTypeFetcher,a=r.visibilityPlugins,c=a.fixedPositionPlugin,p=a.hiddenCompPropertyPlugin,u=a.appControllerPlugin,l="VISIBLE",f="HIDDEN",d="NONE",h=i.santaTypesDefinitions;function g(e,t){return"platform.components.AppController"!==t.structure.componentType||u({renderFlags:{componentViewMode:e.fetchSantaType(h.RenderFlags.componentViewMode,e,t)},isMobile:e.fetchSantaType(h.isMobileView,e,t),isVisible:e.fetchSantaType(h.AppController.isVisible,e,t),compType:t.structure.componentType})}var m={visibilityState:s(function(t,n){if(t.fetchSantaType(h.RenderRealtimeConfig.shouldHideComponent,t,n))return f;var i=c({compId:n.id,compLayout:n.structure.layout,renderFlags:{allowShowingFixedComponents:t.fetchSantaType(h.RenderFlags.allowShowingFixedComponents,t,n)}}),r=t.fetchSantaType(h.Component.compProp,t,n),o=e.get(r,"isHidden"),s=p({compProperties:r,compId:n.id,isHidden:o,renderFlags:{showHiddenComponents:t.fetchSantaType(h.RenderFlags.showHiddenComponents,t,n),ignoreComponentsHiddenProperty:t.fetchSantaType(h.RenderFlags.ignoreComponentHiddenProperty,t,n)?[n.id]:[]}}),a=g(t,n),u=t.siteAPI.getRenderFlag("isComponentVisible"),m=!!e.isUndefined(u)||u;return i&&a&&m?o&&s&&i&&a?l:d:f}),visibilityClasses:s(function(t,n){var i=e.get(n,"structure.layout.fixedPosition"),r=t.fetchSantaType(h.Component.compProp,t,n),s=e.get(r,"isHidden"),a=[h.RenderFlags.allowShowingFixedComponents,h.RenderFlags.showHiddenComponents,h.RenderFlags.ignoreComponentHiddenProperty,h.RenderFlags.ignoreComponentCollapsedProperty].map(function(e){return t.fetchSantaType(e,t,n)}),c=o(a,4),p=c[0],u=c[1],l=c[2],f=c[3],d=e.get(r,"isCollapsed"),m="editor"===t.fetchSantaType(h.RenderFlags.componentViewMode,t,n),y=g(t,n),v=d&&m&&!f,w=[];return!l&&function(e,t,n,i,r){return e&&n&&(!t||i)&&r}(s,i,u,p,y)&&w.push("hidden-comp-ghost-mode"),v&&w.push("collapsed-comp-mode"),w.join(" ")})};return n.santaTypesFetchersRegistry.registerFetchersNamespace("PreviewVisibility",m),{fetchers:m}}.apply(t,i))||(e.exports=r)},7:function(e,t){e.exports=o},70:function(e,t){e.exports=p}})});
//# sourceMappingURL=componentsPreviewLayer.min.js.map