var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}define("core/utils/addComponentPlugins/plugins/page",["lodash","constants","util"],function(c,o,l){"use strict";function p(a,u,t){c.forEach(t,function(t){var i,e,n,o,r=(i=a,e=u,n=t.pathToParent,o=e,c.forEach(n,function(t){var e=i.components.getChildren(o);o=e[t]}),o),s=a.dsActions.tpa.widget.add(t.appDefinitionId,{widgetId:t.widgetId,pageId:u.id,parentContainerRef:r,layout:t.layout,style:t.style});c.forOwn(t.data,function(t,e){a.dsActions.tpa.data.set(s,e,t)})})}function d(e,i,t,n){e.history.add("adding new popup",{actionType:o.DS_ACTIONS.ADD_PAGE,nextPage:i.id,currentPage:t}),e.dsActions.waitForChangesApplied(function(){var t=e.pages.popupPages.getPopupContainer(i.id);e.selection.selectComponentByCompRef(t),n(t)})}return function(t,e,i,n,o,r){if(n.data.isPopup){n.layout.x=0,n.layout.y=0,n.data.pageUriSEO=null;var s=c.omit(n,"tpaComps"),a=t.pages.popupPages.add(l.translate(s.data.title),s),u=t.dsRead.pages.getFocusedPageId();return t.pages.navigateTo(a.id),n.tpaComps?t.dsActions.waitForChangesApplied(function(){p(t,a,n.tpaComps),d(t,a,u,r)}):d(t,a,u,r),a}return null}}),define("core/utils/addComponentPlugins/plugins/anchor",["lodash","util"],function(c,l){"use strict";function p(t,e,i){var n,o,r,s,a=void 0,u=(n=t,o=e,r=new RegExp(i+"\\s(\\d+)"),s=[],c.forEach(o,function(t){var e=n.components.data.get(t).name.match(r);e&&s.push(parseInt(e[1],10))}),s);for(u.sort(function(t,e){return t-e}),a=0;a<u.length;++a)if(!c.includes(u,a+1))return a+1;return a+1}return function(t,e,i,n,o,r){var s=l.translate("component_label_anchor"),a=t.dsRead.pages.getReference(t.dsRead.pages.getPrimaryPageId()),u=p(t,t.components.get.byType("wysiwyg.common.components.anchor.viewer.Anchor",a),s);n.data.name=s+" "+u;var c=e(i,n);return r&&t.dsActions.waitForChangesApplied(function(){r(c)}),c}}),define("core/utils/updateDataPlugins/plugins/imageData",["util"],function(e){"use strict";return function(t){return t.title&&(t.title=e.media.fixMediaTitleLength(t.title,100)),t.description&&(t.description=e.media.fixMediaTitleLength(t.description,1200)),t}}),define("core/utils/updateDataPlugins/plugins/vectorImageData",["util"],function(e){"use strict";return function(t){return t.title&&(t.title=e.media.fixMediaTitleLength(t.title,100)),t}}),define("core/utils/updateDataPlugins/plugins/wixVideoData",["util"],function(e){"use strict";return function(t){return t.title&&(t.title=e.media.fixMediaTitleLength(t.title,100)),t}}),define("core/utils/updateDataPlugins/updateDataPlugins",["core/utils/updateDataPlugins/plugins/imageData","core/utils/updateDataPlugins/plugins/vectorImageData","core/utils/updateDataPlugins/plugins/wixVideoData"],function(t,e,i){"use strict";return{Image:t,VectorImage:e,WixVideo:i}}),define("core/utils/addComponentPlugins/plugins/commonUtils/addMultiple",["lodash","core/utils/updateDataPlugins/updateDataPlugins"],function(h,m){"use strict";return function(u,c,l,p,t,d,g,e){h.forEach(e,function(t,e){var i=void 0,n=void 0,o=void 0;i=0<e?(o=u.dsRead.pages.getFocusedPageId(),n=u.pasteLogic.addContext.getPastePosition(u,p.layout,o),0<e?h.merge({},p,{layout:n}):p):p;var r=g(i,t),s=r.data&&r.data.type;m[s]&&(r.data=m[s](r.data));var a=c(l,r);d&&u.dsActions.waitForChangesApplied(function(){d(a)})})}}),define("core/utils/addComponentPlugins/plugins/documentMedia",["lodash","core/utils/addComponentPlugins/plugins/commonUtils/addMultiple","util"],function(i,u,t){"use strict";function c(t,e){return i.merge({},t,{data:{title:e.title,link:{docId:e.fileUrl,name:e.title,type:"DocumentLink"}}})}return function(e,i,n,o,r,s){if(o.data.link&&o.data.link.docId)return!1;var a=e.mediaServices;return a.mediaManager.open(a.mediaManager.categories.DOCUMENT,"add_panel_documents",{callback:function(t){u(e,i,n,o,r,s,c,t),a.setFocusToEditor()},translation:{submitButton:t.translate("MMGR_submitbutton_addpanel_mydocs_add")}}),!0}}),define("core/utils/addComponentPlugins/plugins/commonUtils/addAudioPluginUtil",["lodash","core/utils/addComponentPlugins/plugins/commonUtils/addMultiple","util"],function(t,c,l){"use strict";return{handleAudioAdd:function(e,i,n,o,r,s,a){if(o.data.uri)return!1;var u=e.mediaServices;return u.mediaManager.open(u.mediaManager.categories.MUSIC,"music_player",{callback:function(t){c(e,i,n,o,r,s,a,t),u.setFocusToEditor()},translation:{submitButton:l.translate("MMGR_submitbutton_addpanel_mytracks_add")}}),!0}}}),define("core/utils/addComponentPlugins/plugins/audioPlayer",["lodash","core/utils/addComponentPlugins/plugins/commonUtils/addAudioPluginUtil"],function(i,s){"use strict";function a(t,e){return i.merge({},t,{data:{uri:e.fileName,originalFileName:e.title}})}return function(t,e,i,n,o,r){return s.handleAudioAdd(t,e,i,n,o,r,a)}}),define("core/utils/addComponentPlugins/plugins/singleAudioPlayer",["lodash","core/utils/addComponentPlugins/plugins/commonUtils/addAudioPluginUtil"],function(i,s){"use strict";function a(t,e){return i.merge({},t,{data:{uri:e.fileName,originalFileName:e.title,artist:"Unknown Artist",track:"Unknown Track"}})}return function(t,e,i,n,o,r){return s.handleAudioAdd(t,e,i,n,o,r,a)}}),define("core/utils/componentPreviewReadyPlugins/formPlugin",["lodash"],function(s){"use strict";return{updateDataWithDefaults:function(t,e){var i,n="toEmailAddress",o=t[n],r=e.dsRead.generalInfo.getUserInfo().email;o||(i=r,s.endsWith(i,"@wix.com"))||(t[n]=r)}}}),define("core/utils/addComponentPlugins/plugins/contactForm",["lodash","util","core/utils/componentPreviewReadyPlugins/formPlugin"],function(u,c,l){"use strict";var p={successMessage:"Contact_Form_Settings_Messages_Success_message_default",validationErrorMessage:"Contact_Form_Settings_Messages_Error_message_mandatory_fields_default",errorMessage:"Contact_Form_Settings_Messages_Error_message_for_email_fields_default"};return function(t,e,i,n,o,r){var s;s=n.data,u.forOwn(p,function(t,e){s[e]=c.translate(t)}),l.updateDataWithDefaults(n.data,t);var a=e(i,n);return r&&t.dsActions.waitForChangesApplied(function(){r(a)}),a}}),define("core/utils/addComponentPlugins/plugins/clipArt",["lodash","util"],function(u,t){"use strict";var c=t.imageTransform.fittingTypes;return function(t,e,i,n,o,r){var s;n.props||(s=n,n=u.merge(s,{data:{title:""},layout:{rotationInDegrees:0,scale:1,fixedPosition:!1,anchors:[]},props:{displayMode:c.SCALE_TO_FILL,type:"WPhotoProperties"},style:s.style||"ca1"}));var a=e(i,n);return r&&t.dsActions.waitForChangesApplied(function(){r(a)}),a}}),define("core/utils/addComponentPlugins/plugins/svgShape",["lodash"],function(u){"use strict";return function(t,e,i,n,o,r){var s,a=e(i,(s=n,u.defaults(s,{data:{link:null,type:"SvgShape"}})));return r&&t.dsActions.waitForChangesApplied(function(){r(a)}),a}}),define("core/utils/addComponentPlugins/plugins/wPhoto",["lodash"],function(u){"use strict";return function(t,e,i,n,o,r){var s;n.props||(s=n,n=u.merge({},s,{layout:{rotationInDegrees:0,scale:1,fixedPosition:!1,anchors:[]},props:{type:"WPhotoProperties"},style:s.style||"wp2"}));var a=e(i,n);return r&&t.dsActions.waitForChangesApplied(function(){r(a)}),a}}),define("core/utils/addComponentPlugins/plugins/verticalAnchorsMenu",["lodash","constants"],function(t,u){"use strict";return function(t,e,i,n,o,r){var s=n.layout;s.fixedPosition&&(s.docked.right.px+=u.SECTIONS_REORGANIZE.STRIP_WIDTH,s.docked.right.px+=t.isVerticalScrollbarHidden()?.01*window.innerWidth:u.SECTIONS_REORGANIZE.STRIP_WIDTH,delete s.x,delete s.y);var a=e(i,n);return r&&t.dsActions.waitForChangesApplied(function(){r(a)}),a}}),define("core/utils/addComponentPlugins/plugins/stripContainer",[],function(){"use strict";return function(t,e,i,n){n.layout.x=0}}),define("core/utils/addComponentPlugins/plugins/appControllerAddPlugin",["lodash","platformEvents"],function(t,r){"use strict";return function(t,e,i){var n=t.components.data.get(e),o=t.dsRead.platform.getAppDataByAppDefId(n.applicationId);o&&t.dsActions.platform.notifyApplication(o.applicationId,r.factory.controllerAdded({controllerRef:e,origin:i}))}}),define("core/utils/addComponentPlugins/plugins/vectorImageBefore",["lodash"],function(r){"use strict";return function(t,e,i,n){var o=n.data.svgId;t.media.vectorImage.fetchSvg(o,r.noop)}}),define("core/utils/addComponentPlugins/plugins/vectorImageAfter",["constants","lodash"],function(p,d){"use strict";return function(t,e){var i=t.components.properties.get(e);if("fit"===i.displayMode||"legacyFit"===i.displayMode){var n=t.media.vectorImage.getSvgOriginalAspectRatio(e);t.components.layout.resetCompLayoutToAspectRatio(e,n,!0)}var o=t.components.data.get(e),r=t.media.vectorImage.getSvgInfoFromCache(o.svgId),s=d.get(r,"svgType");if(d.includes(["shape","tint"],s)){var a=t.components.design.get(e),u=d.get(a,"overrideColors");if(d.isEmpty(u)){var c=p.VECTOR_IMAGE_DEFAULTS.VECTOR_SHAPE_COLOR_DEFAULT.color1,l=d.assign({},a,{overrideColors:{color1:c}});t.components.design.update(e,l,!0,!0)}}}}),define("core/utils/addComponentPlugins/plugins/popover",["lodash"],function(n){"use strict";return function(t,e){var i=n.head(t.components.modes.getModesByType(e,"POPOVER"));i&&t.components.modes.activateComponentMode(e,i.modeId)}}),define("core/utils/addComponentPlugins/plugins/wTwitterTweet",[],function(){"use strict";return function(t,e,i,n){n.data.urlFormat=t.dsRead.generalInfo.urlFormat.get()}}),define("core/utils/addComponentPlugins/addComponentPlugins",["core/utils/addComponentPlugins/plugins/page","core/utils/addComponentPlugins/plugins/anchor","core/utils/addComponentPlugins/plugins/documentMedia","core/utils/addComponentPlugins/plugins/audioPlayer","core/utils/addComponentPlugins/plugins/singleAudioPlayer","core/utils/addComponentPlugins/plugins/contactForm","core/utils/addComponentPlugins/plugins/clipArt","core/utils/addComponentPlugins/plugins/svgShape","core/utils/addComponentPlugins/plugins/wPhoto","core/utils/addComponentPlugins/plugins/verticalAnchorsMenu","core/utils/addComponentPlugins/plugins/stripContainer","core/utils/addComponentPlugins/plugins/appControllerAddPlugin","core/utils/addComponentPlugins/plugins/vectorImageBefore","core/utils/addComponentPlugins/plugins/vectorImageAfter","core/utils/addComponentPlugins/plugins/popover","core/utils/addComponentPlugins/plugins/wTwitterTweet"],function(t,e,i,n,o,r,s,a,u,c,l,p,d,g,h,m){"use strict";return{before:{"mobile.core.components.Page":t,"wysiwyg.common.components.anchor.viewer.Anchor":e,"wysiwyg.viewer.components.documentmedia.DocumentMedia":i,"wysiwyg.viewer.components.AudioPlayer":n,"wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer":o,"wysiwyg.viewer.components.ClipArt":s,"wysiwyg.viewer.components.ContactForm":r,"wysiwyg.viewer.components.DynamicContactForm":r,"wysiwyg.viewer.components.svgshape.SvgShape":a,"wysiwyg.viewer.components.WPhoto":u,"wysiwyg.viewer.components.StripContainer":l,"wysiwyg.common.components.verticalanchorsmenu.viewer.VerticalAnchorsMenu":c,"wysiwyg.viewer.components.WTwitterTweet":m,"wysiwyg.viewer.components.VectorImage":d},after:{"platform.components.AppController":p,"wysiwyg.viewer.components.VectorImage":g,"wysiwyg.viewer.components.Popover":h}}}),define("core/utils/addUtil",["core/utils/addComponentPlugins/addComponentPlugins","core/utils/updateDataPlugins/updateDataPlugins"],function(d,g){"use strict";return{addComponent:function(t,e,i,n,o,r,s,a){var u=n.componentType,c=n.data&&n.data.type;if(g[c]&&(n.data=g[c](n.data)),d.before[u]){var l=d.before[u](t,e,i,n,o,r);if(l)return l}var p=e(i,n,o,a);return t.dsActions.waitForChangesApplied(function(){r&&r(p),d.after[u]&&d.after[u](t,p,s)}),p},componentsWithPlugins:Object.keys(d)}}),define("core/utils/AttachHandler",["lodash","stateManagement"],function(m,h){"use strict";var f={COMP:"comp",STRUCTURE:"structure"},d={SAME:"same",VALID:"valid",INVALID:"invalid"},y={comp:{getContainer:function(t,e){return t.components.getContainer(e)},isContainable:function(t,e,i){return t.components.is.containable(e,i)&&!t.components.is.group(i)},canReparent:function(t,e){return t.components.is.canReparent(e)},getCompLayout:function(t,e){return t.components.layout.getRelativeToScreenConsideringScroll(e).bounding},getCompType:function(t,e){return t.components.getType(e)},isShowOnAllPages:function(t,e){return t.components.isShowOnAllPages(e)}},structure:{getCompType:function(){return""},getContainer:function(){return{}},isContainable:function(t,e,i){return t.components.is.containableByStructure(e,i)&&!t.components.is.group(i)},canReparent:function(){return!0},isShowOnAllPages:function(){return!1}}};function P(t,e){return t.components.layout.getRelativeToScreenConsideringScroll(e)}var v="wysiwyg.viewer.components.MenuContainer";function u(n,o,e){var t,i,r,s,a,u,c,l=(3<arguments.length&&void 0!==arguments[3]?arguments[3]:{}).scopeRef,p=n.dsRead.siteSegments.getHeader(),d=n.dsRead.pages.getFocusedPageId(),g=n.components.getAllComponents(d);return t=n,o.comp,t.isMobileEditor()&&(g=g.concat(n.dsRead.siteSegments.getSiteStructure())),e===f.COMP&&(!n.components.isShowOnAllPages(o.comp)||n.siteSegments.isUsingSectionsLayout()&&(a=n,u=o.comp,c=a.siteSegments.getSiteStructure(),a.utils.isSameRef(a.components.getContainer(u),c)))&&(r=g,s=(i=n).dsRead.siteSegments.getFooter(),g=m.filter(r,function(t){var e=i.components.isDescendantOfComp(t,s);return!i.utils.isSameRef(t,s)&&!e})),m(g).filter(function(t){return!n.utils.isSameRef(t,o.comp)&&y[e].isContainable(n,o.comp,t)}).filter(function(t){return n.components.isRenderedOnSite(t)}).filter(function(t){return!l||(n.components.isDescendantOfComp(t,l)||n.utils.isSameRef(t,l))}).filter(function(t){return!(e=n,i=h.editorPlugins.selection.selectors.getFocusedContainer(e.store.getState()),e.components.getType(i)===v&&n.utils.isSiteSegment(t));var e,i}).map(function(t){return{layout:P(n,t),comp:t}}).filter(function(t){var e=n.utils.isSameRef(t.comp,p),i=n.utils.isSameRef(t.comp,n.pages.getPrimaryContainer());return l||i||t.layout.width>=o.layout.width&&(e||t.layout.height>=o.layout.height)}).value()}function S(t,e,i,n){var o=t.components.is.fullWidth(e),r=t.utils.isSameRef(e,t.dsRead.siteSegments.getHeader());return(o||i.x>=n.x)&&(o||i.x+i.width<=n.x+n.width)&&(r||i.y>=n.y)&&i.y+i.height<=n.y+n.height}function c(t,e){var i,n,o,r,s,a,u,c,l,p=e.layout,d=e.comp,g=t.layout,h=y[this.type].getContainer(this.editorAPI,this.comp);return!(m.isEmpty(h)&&this.editorAPI.utils.isSiteStructure(d))&&(u=this.editorAPI,c=h,l=d,!(!m.isEmpty(c)&&u.utils.isSiteStructure(c)&&u.utils.isPage(l)))&&(r=this.editorAPI,s=h,a=d,!(!m.isEmpty(s)&&!r.components.isShowOnAllPages(s)&&r.utils.isSiteStructure(a)))&&(i=this.editorAPI,n=h,o=d,!(!m.isEmpty(n)&&!i.components.isShowOnAllPages(n)&&"wysiwyg.viewer.components.FooterContainer"===i.components.getType(o)))&&!this.editorAPI.utils.isSameRef(h,d)&&S(this.editorAPI,e.comp,g,p)}function g(t,e){return!(t.x>=e.x+e.width||e.x>=t.x+t.width||t.y>=e.y+e.height||e.y>=t.y+t.height)}function C(o,r){var i=this;if(!y[this.type].canReparent(this.editorAPI,this.comp))return y[this.type].getContainer(this.editorAPI,this.comp);m.has(this,"attachCandidates")||(this.attachCandidates=u(this.editorAPI,this.initialCompWithLayout,this.type,{scopeRef:this.scopeRef}));var t=m.find(this.attachCandidates,m.bind(function(t){var e,i,n;return t.layout=(e=this.editorAPI,i=t,n=this.comp,e.components.is.repeatedComponent(n)?P(e,i.comp):i.layout),r?S(this.editorAPI,t.comp,o,t.layout):g(o,t.layout)},this));if(t&&c.call(this,{layout:o},t))return t.comp;if(this.scopeRef&&!t&&!m.isEmpty(this.attachCandidates))for(var n=m.map(this.attachCandidates,"comp"),s=[this.scopeRef],e=function(){var e=s.shift();if(m.find(n,function(t){return i.editorAPI.utils.isSameRef(t,e)}))return{v:e};s.push.apply(s,_toConsumableArray(i.editorAPI.components.getChildren(e).filter(function(t){return i.editorAPI.components.is.container(t)})))};!m.isEmpty(s);){var a=e();if("object"===(void 0===a?"undefined":_typeof(a)))return a.v}return null}function t(t,e,i){var n=(3<arguments.length&&void 0!==arguments[3]?arguments[3]:{}).scopeRef;t&&(this.editorAPI=t,this.type=i,this.initialCompWithLayout=e,this.comp=e.comp,this.attachCandidates=u(t,e,i,{scopeRef:n}),this.scopeRef=n)}return t.prototype={getCurrentAttachCandidate:function(t,e){var i,n,o,r,s,a=t||y[this.type].getCompLayout(this.editorAPI,this.comp),u=function(t){var e=y[this.type].getContainer(this.editorAPI,this.comp);return!(!m.isEmpty(e)&&y[this.type].getCompLayout&&g(t,y[this.type].getCompLayout(this.editorAPI,e)))}.call(this,a),c=C.call(this,a,u),l=m.find(e,m.isEqual.bind(m,c)),p={candidateRef:null,candidateStatus:d.SAME};return this.editorAPI.utils.isSameRef(y[this.type].getContainer(this.editorAPI,this.comp),c)?(p.candidateRef=c,p.candidateStatus=d.SAME):c&&!l?(p.candidateRef=c,p.candidateStatus=d.VALID):(i=this.editorAPI,n=u,o=this.comp,r=this.type,s=y[r].getContainer(i,o),!i.utils.isPage(s)&&(i.isMobileEditor()?n&&!y[r].isShowOnAllPages(i,o):n)&&(p.candidateRef=this.editorAPI.pages.getFocusedPage(),p.candidateStatus=d.VALID)),p.candidateRef&&!this.editorAPI.components.is.allowedToContainMoreChildren(p.candidateRef)&&(p.candidateStatus=d.INVALID),p},highlightAttachCandidate:function(t){(t=function(t,e,i){var n=void 0,o=t.dsRead.pages.popupPages.getCurrentPopupId();if(o)if(i){if(i.id===o)return null}else if(n=t.pages.popupPages.getPopupContainer(),m.find(e,["comp.id",n.id]))return n;return i}(this.editorAPI,this.attachCandidates,t))&&this.editorAPI.utils.isSiteStructure(t)||this.editorAPI.setAttachCandidate(t,this.type===f.STRUCTURE)},clearHighlightAttachCandidate:function(t){this.editorAPI.setAttachCandidate(null,!!t)}},t.TYPES=f,t.ATTACH_CANDIDATE_STATUSES=d,t}),define("core/utils/mediaManagerPresetUtil",["lodash","stateManagement"],function(n,t){"use strict";var o=t.editorPlugins.userPreferences.actions.setSessionUserPreferences;return{getIdByDataType:function t(e){var i=n.get(e,"data",{});switch(i.type){case"VectorImage":return i.svgId;case"Image":return i.uri;case"WixVideo":return(i=n.get(e,"design",{})).videoId||"";case"BackgroundMedia":return t((i=n.get(e,"design",{})).mediaRef)||"";default:return""}},storePath:function(t,e,i){i&&t.store.dispatch(o("last_media_path_"+e,i))}}}),define("core/utils/gridLinesUtil",[],function(){"use strict";return{getPageGridLines:function(t,e){var i,n,o,r,s,a,u,c=function(t){var e=t.siteSegments.getPagesContainerAbsLayout(),i=t.getSiteScale();if(!i||1===i)return e;var n={y:e.y*i,width:e.width*i,height:e.height*i},o=e.width-n.width;return n.x=e.x+o/2,n}(t);return n=e,o=(i=c).y+i.height,r=i.x+i.width,s={x1:i.x,y1:0,x2:i.x,y2:"100%"},a={x1:r,y1:0,x2:r,y2:"100%"},u={x1:0,y1:i.y,x2:"100%",y2:i.y},n?[s,a]:[s,a,u,{x1:0,y1:o,x2:"100%",y2:o}]},getContainerGridLines:function(t,e){"wysiwyg.viewer.components.StripColumnsContainer"===t.components.getType(e)&&(e=t.components.getChildren(e)[0]);var i=t.components.layout.getCompMargin(e),n=t.components.layout.getRelativeToScreen(e),o=n.y+n.height,r=n.x+i.left,s=n.x+n.width-i.right;return[{x1:r,y1:n.y,x2:r,y2:o},{x1:s,y1:n.y,x2:s,y2:o}]}}}),define("core/utils/SnapToHandler",["lodash","core/utils/gridLinesUtil","stateManagement","util"],function(M,r,l,c){"use strict";var p=["SITE_PAGES","PAGES_CONTAINER"],w=void 0,R=void 0,d=l.domMeasurements.selectors.getStageRect,g=l.editorPlugins.selection.selectors.getFocusedContainer,e=M.mapKeys(["platform.components.AppController","mobile.core.components.Page","core.components.Page","wysiwyg.viewer.components.FooterContainer","wysiwyg.viewer.components.HeaderContainer","wysiwyg.viewer.components.WSiteStructure"]),E="wysiwyg.viewer.components.WRichText",D=function(t){return!!e[t]};function L(t,e,i,n){return e||M.isEqual(i,t)||M.isEqual(n,t)}function U(t,e,i,n,o,r){var s=L(e,i,n,o),a=t.components.layout.getRelativeToScreen(e,s).bounding;return r&&(a.y+=t.scroll.get().scrollTop,a.x+=t.scroll.get().scrollLeft),a}function B(t,e){return e&&t.components.is.page(e)}function n(s,t,e,a){var i,n,o,u=s.dsRead.siteSegments.getHeader(),c=s.dsRead.siteSegments.getFooter();return M(t).map(function(t){var e,i,n,o,r=B(s,t);return{layout:U(s,t,r,u,c,a),isDynamicLayout:(e=s,i=t,n=r,o=c,n||M.isEqual(o,i)||e.components.isDescendantOfComp(i,o)),comp:t}}).concat((i=s,n=i.store.getState(),o=g(n),o&&i.components.is.showMarginsIndicator(o)?M(o).thru(r.getContainerGridLines.bind(null,i)).map(function(t){return{layout:{x:t.x1,y:t.y1,height:t.y2-t.y1,width:0},isDynamicLayout:!1}}).value():[])).filter(function(t){return e(t.layout)}).concat(function(t){if(!l.editorPlugins.rulers.selectors.isRulersEnabled(t.store.getState()))return[];var e=(i=t,n=i.store.getState(),o=l.editorPlugins.rulers.selectors.getHorizontalGuides(n),r=d(n),M.map(o,function(t){return{id:t.guideId,x:r.left,y:t.guidePosition,height:0,width:r.right}}));var i,n,o,r;return e=e.concat((s=t,a=s.store.getState(),u=l.editorPlugins.rulers.selectors.getVerticalGuides(a),c=d(a),M.map(u,function(t){var e=l.editorPlugins.rulers.selectors.getVerticalGuideRealPosition(s.dsRead,t.guidePosition);return{id:t.guideId,x:e,y:c.top,height:c.bottom,width:0}}))),M.map(e,function(t){return{layout:t,isDynamicLayout:!1}});var s,a,u,c}(s)).value()}function o(t,e,i){return!(t.selection.isComponentSelected(i)||M.includes(p,i.id)||!t.components.isRenderedOnSite(i)||(a=e,u=i,(s=t).components.layout.isRenderedInFixedPosition(u)&&!s.components.isDescendantOfComp(a,u))||e&&t.components.isAscendantOfComp(e,i)||t.dsRead.pages.isWidgetPage(i.id)||(o=i,r=g((n=t).store.getState()),!c.spotlightStageUtils.canSelectCompConsideringSpotlightStage(n,r,o)));var n,o,r,s,a,u}function b(o,r,t){var s=o.dsRead.siteSegments.getHeader(),a=o.dsRead.siteSegments.getFooter();return M.filter(t,function(t){var e=t.comp,i=B(o,e),n=t.layout;return!L(e,i,s,a)&&(r===n.y||r===n.y+n.height)})}function O(o,r,t){var s=o.dsRead.siteSegments.getHeader(),a=o.dsRead.siteSegments.getFooter();return M.filter(t,function(t){var e=t.comp,i=B(o,e),n=t.layout;return!L(e,i,s,a)&&(r===n.x||r===n.x+n.width)})}function u(e,t){return M.map(t,function(t){return M(t.layout).pick(["x","y","width","height"]).assign({isOnMasterPage:t.comp&&(e.components.isShowOnAllPages(t.comp)||e.components.isShowOnSomePages(t.comp))}).value()})}function h(t,e,i,n){var o,r,s=(o=n.concat(i),M.minBy(o,"x")),a=(r=n.concat(i),M.maxBy(r,function(t){return t.x+t.width}));return[{line:[{x:s.x,y:t},{x:a.x+a.width,y:t}],rectanglesDrawData:e}]}function m(t,e,i,n){var o,r,s=(o=n.concat(i),M.minBy(o,"y")),a=(r=n.concat(i),M.maxBy(r,function(t){return t.y+t.height}));return[{line:[{x:t,y:s.y},{x:t,y:a.y+a.height}],rectanglesDrawData:e}]}function t(t,e){t&&(this.editorAPI=t,this.compRefs=e,this.fixedAncestor=t.components.layout.getClosestAncestorRenderedInFixedPosition(e))}function _(t,e,i,n,o){var r=M.map(n,"layout"),s=[i].concat(r),a=m(e,u(t,n),o,s);return w&&0<w.length?w.concat(a):a}function F(t,e,i,n,o){var r=M.map(n,"layout"),s=[i].concat(r),a=h(e,u(t,n),o,s);return R&&0<R.length?R.concat(a):a}function N(t){return this.fixedAncestor?M.assign({},t,{y:t.y+this.editorAPI.scroll.get().scrollTop,x:t.x+this.editorAPI.scroll.get().scrollLeft}):t}function H(){if(this.fixedAncestor)return this.getSnapCandidates();var t,e,i=this.editorAPI.store.getState(),n=d(i);return t=this.getSnapCandidates(),e=n,M.filter(t,M.partial(c.candidatesUtil.isLayoutVisible,e))}function Y(t,e){var i,n,o=(n=d((i=t).store.getState()).right,M(i).thru(r.getPageGridLines).filter({x2:"100%"}).map(function(t){return{x:t.x1,y:t.y1,width:n}}).value());return M.filter(o,{y:e})}function k(t,e){var i,n,o=(n=d((i=t).store.getState()).bottom,M(i).thru(r.getPageGridLines).filter({y2:"100%"}).map(function(t){return{x:t.x1,y:t.y1,height:n}}).value());return M.filter(o,{x:e})}t.prototype.getSnapCandidates=function(t){if(!M.has(this,"snapCandidates")){var e=function(t,e,i){if(i)return M([i]).concat(t.components.getChildren(i,!0)).reject(M.head(e)).filter(o.bind(null,t,e)).value();var n=t.dsRead.pages.getFocusedPageId();return t.components.getAllComponents(n,o.bind(null,t,e))}(this.editorAPI,this.compRefs,this.fixedAncestor),i=M.isFunction(t)?t:function(){return!0};this.snapCandidates=n(this.editorAPI,e,i,this.fixedAncestor),M.get(this.compRefs,"0")&&c.recommendedMobileHeaderHeightUtils.isMobileHeader(this.compRefs[0])&&this.snapCandidates.push(c.recommendedMobileHeaderHeightUtils.getSnapCandidate(this.editorAPI.ui.stage.getEditingAreaLayout)),this.compRefs=null}return this.snapCandidates},t.prototype.getClosestLayoutDistance=function(t,e,i,n){var o,r,s=this.getSnapCandidates(n);o=t,r=s,M.forEach(r,function(t){t.layout=t.isDynamicLayout?U(o,t.comp):t.layout});var a,u,c,l,p,d,g,h,m,f,y,P,v,S,C,T,I,A,x,w,R,E,D,b,O=N.call(this,e),_=H.call(this);return{x:(v=t,S=O,C=_,T=i,R=v.dsRead.siteSegments.getHeader(),E=v.dsRead.siteSegments.getFooter(),D=M.reduce(C,function(t,e){var i=e.layout,n=e.comp;return L(n,B(v,n),R,E)||(T.left&&(t.push(i.x-S.x),t.push(i.x+i.width-S.x)),T.right&&(t.push(i.x-(S.x+S.width)),t.push(i.x+i.width-(S.x+S.width)))),T.centerX&&t.push((i.x+(i.x+i.width))/2-(S.x+(S.x+S.width))/2),t},[]),b=V(v)?[]:(I=S,A=T,x=v.siteSegments.getPagesContainerAbsLayout(),w=[],A.left&&(w.push(x.x-I.x),w.push(x.x+x.width-I.x)),A.right&&(w.push(x.x-(I.x+I.width)),w.push(x.x+x.width-(I.x+I.width))),w),M.minBy(D.concat(b),function(t){return Math.abs(t)})),y:(a=t,u=O,c=_,l=i,m=a.dsRead.siteSegments.getHeader(),f=a.dsRead.siteSegments.getFooter(),y=M.reduce(c,function(t,e){var i=e.layout,n=e.comp;return L(n,B(a,n),m,f)||(l.top&&(t.push(i.y-u.y),t.push(i.y+i.height-u.y)),l.bottom&&(t.push(i.y-(u.y+u.height)),t.push(i.y+i.height-(u.y+u.height)))),l.centerY&&t.push((i.y+(i.y+i.height))/2-(u.y+(u.y+u.height))/2),t},[]),P=V(a)?[]:(p=u,d=l,g=a.siteSegments.getPagesContainerAbsLayout(),h=[],d.top&&(h.push(g.y-p.y),h.push(g.y+g.height-p.y)),d.bottom&&(h.push(g.y-(p.y+p.height)),h.push(g.y+g.height-(p.y+p.height))),h),M.minBy(y.concat(P),function(t){return Math.abs(t)}))}};var s=function(t,e){return{line:[t,e],rectanglesDrawData:[]}};function W(t){var e=t.x,i=t.y+t.height+5,n=e+t.width;return[s({x:e,y:i},{x:n,y:i}),s({x:e,y:i-3},{x:e,y:i+3}),s({x:n,y:i-3},{x:n,y:i+3})]}function G(t){var e=t.x,i=t.y,n=e-5,o=i+t.height;return[s({x:n,y:i},{x:n,y:o}),s({x:n-3,y:i},{x:n+3,y:i}),s({x:n-3,y:o},{x:n+3,y:o})]}function V(t){var e=t.store.getState();return t.components.is.spotlightStageContainer(g(e))&&!l.spotlightStage.selectors.getConfig(e).shouldShowGridLines}return t.prototype.getSnapData=function(t,e,i,n,o,r){var s=this,a=[],u=N.call(this,t),c=H.call(this),l=i||V(this.editorAPI),p=[],d=[];n&&(w=n.verticalEqualDistanceLines,R=n.horizontalEqualDistanceLines);var g,h,m,f,y="RESIZE"===o&&(e.left||e.right),P="RESIZE"===o&&(e.top||e.bottom),v=!1;if((P||y)&&!r&&M.forEach(c,function(t){var e=t.comp&&s.editorAPI.components.getType(t.comp);e&&!D(e)&&(t.layout.width===u.width&&y&&(v=!0,a=a.concat(W(t.layout),W(u))),t.layout.height===u.height&&P&&e!==E&&(v=!0,a=a.concat(G(t.layout),G(u))))}),!v){var S=e.centerY&&(m=u.y+u.height/2,f=c,M.filter(f,function(t){var e=t.layout;return m===(e.y+(e.y+e.height))/2}));if(S&&0<S.length)a=a.concat(F(this.editorAPI,u.y+u.height/2,u,S,p));else{var C=[];if(e.top&&(C=b(this.editorAPI,u.y,c),p=l?[]:Y(this.editorAPI,u.y),(0<C.length||0<p.length)&&(a=a.concat(F(this.editorAPI,u.y,u,C,p)))),e.bottom){var T=u.y+u.height;C=b(this.editorAPI,T,c),p=l?[]:Y(this.editorAPI,T),(0<C.length||0<p.length)&&(a=a.concat(F(this.editorAPI,T,u,C,p)))}}var I=e.centerX&&(g=u.x+u.width/2,h=c,M.filter(h,function(t){var e=t.layout;return g===(e.x+(e.x+e.width))/2}));if(I&&0<I.length)a=a.concat(_(this.editorAPI,u.x+u.width/2,u,I,d));else{var A=[];if(e.right){var x=u.x+u.width;A=O(this.editorAPI,x,c),d=l?[]:k(this.editorAPI,x),(0<A.length||0<d.length)&&(a=a.concat(_(this.editorAPI,x,u,A,d)))}e.left&&(A=O(this.editorAPI,u.x,c),d=l?[]:k(this.editorAPI,u.x),(0<A.length||0<d.length)&&(a=a.concat(_(this.editorAPI,u.x,u,A,d))))}}return a},t.prototype.getSimilarSizeCandidates=function(o,t,e){var r=e.top||e.bottom,s=e.left||e.right;if(!r&&!s)return{};var a=N.call(this,t),i=H.call(this),u=void 0,c=void 0,l=Number.MAX_SAFE_INTEGER,p=Number.MAX_SAFE_INTEGER;return M.forEach(i,function(t){var e=t.comp&&o.components.getType(t.comp);if(e&&!D(e)){if(r&&e!==E){var i=Math.abs(t.layout.height-a.height);i<5&&i<l&&(l=i,u=t)}if(s){var n=Math.abs(t.layout.width-a.width);n<5&&n<p&&(p=n,c=t)}}}),{potentialSimilarHeightCandidate:u,potentialSimilarWidthCandidate:c}},t}),define("core/utils/AddPanelDragHandler",["lodash","zepto","util","constants","coreBi","core/utils/AttachHandler","core/utils/mediaManagerPresetUtil","stateManagement","core/utils/SnapToHandler"],function(P,e,u,c,l,o,r,i,n){"use strict";var t=i.editorPlugins.domMeasurements.selectors,s=t.translateToViewerCoordinates,v=t.getPreviewPosition,p=t.getStageLayout,S=t.getSiteScale,d={top:!0,bottom:!0,left:!0,right:!0,centerX:!0,centerY:!0},g={top:!0,bottom:!0,left:!1,right:!1,centerX:!1,centerY:!0};function h(t){var e=i.editorPlugins.selection.selectors.getFocusedContainer(t.store.getState());return t.components.is.spotlightStageContainer(e)?e:null}function a(t,e,i,n,o,r,s){if(t){var a=t.store.getState();this.editorAPI=t,this.initialEvent=e,this.item=i,this.panelElm=n,this.dragBoxClass=o,this.onItemDragStart=r,this.onItemDragEnd=s,this.ignoreTouchingGridLines=t.dsRead.pages.isWidgetPage(t.pages.getFocusedPageId()),this.isFirstDragEvent=!0,this.originalDragPosition={x:this.initialEvent.pageX,y:this.initialEvent.pageY},this.item.onDrop=this.item.onDrop||function(r,t,s,a){P.assign(s.structure.layout,t);var e=function(t){if(!P.isEmpty(r.components.modes.getModes(a))&&t.id){var e=r.components.modes.getComponentActiveModeIds(a);r.components.modes.showComponentOnlyInModesCombination(t,P.keys(e)),r.tabIndicationState.activateAddAnimation(!0),r.components.modes.addDefaultSingleModeAnimations(t)}"Page"!==s.structure.type&&r.history.add("component dragged to stage from add panel");var i=r.components.getType(a),n=r.components.is.repeatedComponent(a);if(r.selection.selectComponentByCompRef(t),r.openFirstTimePanel(t),r.bi.event(l.events.addPanel.COMPONENT_ADDED_TO_STAGE,{origin:s.dragOrigin||"add_panel",category:s.categoryId,section:s.sectionTitle,component_type:s.structure.componentType,component_id:t.id,preset_id:s.itemId||"",adding_method:"drag",preset_data_skin:s.structure.style.skin||s.structure.skin||s.structure.style,preset_data_tags:s.tags||"",page_id:r.pages.getFocusedPage()&&r.pages.getFocusedPage().id,target_component:i,is_target_repeated:n}),r.openCompOutOfGridPanelIfNeeded(t),s.appDefinitionId){var o=r.dsRead.platform.getAppDataByAppDefId(s.appDefinitionId);o&&o.applicationId&&r.dsActions.platform.notifyApplication(o.applicationId,{eventType:c.EVENTS.ADD_PANEL.COMPONENT_ADDED_TO_STAGE,eventPayload:{compRef:t,appDefinitionId:s.appDefinitionId}})}u.fedopsLogger.interactionEnded(u.fedopsLogger.INTERACTIONS.ADD_COMP_FROM_ADD_PANEL)};s.appDefinitionId?r.tpa.installAppIfNeeded(s.appDefinitionId).then(function(){r.components.add(a,s.structure,void 0,e)}):r.components.add(a,s.structure,void 0,e)}.bind(null,this.editorAPI),this.stageLayout=p(a),this.editorAPI.components.is.fullWidthByStructure(this.item.structure)?(this.isFullWidth=!0,this.allowedSnapDirections=g):(this.allowedSnapDirections=d,this.isFullWidth=!1),this.init()}}return a.prototype={init:function(){var t=h(this.editorAPI);this.snapToHandler=new n(this.editorAPI),this.attachHandler=new o(this.editorAPI,{comp:this.item.structure,layout:P.pick(this.item.structure.layout,["width","height"])},o.TYPES.STRUCTURE,t?{scopeRef:t}:{})},getFixedDragPosition:function(t){return{x:t.clientX,y:t.clientY}},onDrag:function(t){var e,i,n=this.editorAPI.store.getState(),o=s(n,t);if(this.isFirstDragEvent){if(e=o,i=this.originalDragPosition,!(8<=Math.abs(i.x-e.pageX)||8<=Math.abs(i.y-e.pageY)))return;u.fedopsLogger.interactionStarted(u.fedopsLogger.INTERACTIONS.ADD_COMP_FROM_ADD_PANEL),this.onInitialDrag(),this.isFirstDragEvent=!1}this.lastDragPosition={x:o.pageX,y:o.pageY},this.lastDragFixedPosition=this.getFixedDragPosition(t);var r=this.isInPanelArea();r?this.handleDragInPanelArea():this.handleDragOutsidePanelArea(t),this.setDragBox(r)},onInitialDrag:function(){P.isFunction(this.onItemDragStart)&&this.onItemDragStart()},isInPanelArea:function(){var t=this.getPanelClientRect();return this.lastDragFixedPosition.x>=t.left&&this.lastDragFixedPosition.x<=t.right&&this.lastDragFixedPosition.y>=t.top&&this.lastDragFixedPosition.y<=t.bottom},getPanelClientRect:function(){return this._panelClientRect||(this._panelClientRect=this.panelElm.getBoundingClientRect()),this._panelClientRect},handleDragOutsidePanelArea:function(){var t=this.getDragBoxStageLayout(),e=this.getDragBoxStageLayout(!0);if("popup"!==this.item.categoryId){this.snapDragBoxToCompIfNeeded(t);var i=this.attachHandler.getCurrentAttachCandidate(e),n=i.candidateRef;i.candidateStatus===o.ATTACH_CANDIDATE_STATUSES.VALID&&this.attachHandler.highlightAttachCandidate(n)}},handleDragInPanelArea:function(){this.editorAPI.snapData.clear(!0),this.attachHandler.clearHighlightAttachCandidate(!0)},getDragBoxStageLayout:function(t){var e={x:this.lastDragPosition.x+this.getBoxOffset().left*this.item.structure.layout.width,y:this.lastDragPosition.y+this.getBoxOffset().top*this.item.structure.layout.height,width:this.item.structure.layout.width,height:this.item.structure.layout.height};if(t){var i=this.editorAPI.ui.scroll.getScroll();e.x-=i.scrollLeft,e.y-=i.scrollTop}return e},getBoxOffset:function(){if(!this._boxOffset){var t=this.getRectSize();this._boxOffset={left:(this.item.rect.left+e(window).scrollLeft()-this.originalDragPosition.x)/t.width,top:(this.item.rect.top+e(window).scrollTop()-this.originalDragPosition.y)/t.height}}return this._boxOffset},getRectSize:function(){return{width:this.item.rect.width,height:this.item.rect.height}},setDragBox:function(t){var e,i,n,o,r,s,a,u,c,l,p,d,g=this.editorAPI.store.getState(),h=S(g),m={key:"dragToStageDragBox",coords:{left:this.lastDragFixedPosition.x,top:this.lastDragFixedPosition.y},boxOffset:this.getBoxOffset()};if(t)m.boxSize=this.getRectSize();else if("popup"===this.item.categoryId)o=m,r=this.item,s=this.stageLayout,a=r.structure.components[0],u=a.layout,c=a.props.alignmentType,l=a.props.verticalAlignment,p=a.props.horizontalAlignment,d={fullHeight:function(){return{left:"left"===p?s.left:s.right-u.width,top:s.top,height:s.height,width:u.width}},fullWidth:function(){return{left:s.left,top:"bottom"===l?s.bottom-u.height:s.top,height:u.height,width:s.width}},nineGrid:function(){return{left:(s.width-u.width)/2,top:(s.height-u.height)/2,height:u.height,width:u.width}}}[c](),o.coords=P.pick(d,["left","top"]),o.boxSize=P.pick(d,["height","width"]),o.boxOffset={left:0,top:0},(m=o).boxSize.height*=h;else if(m.boxSize=P.pick(this.item.structure.layout,["width","height"]),m.boxSize.height*=h,this.isFullWidth){var f=v(g);e=m,i=this.stageLayout.width,n=f,e.boxOffset=P.assign({},e.boxOffset,{left:0}),e.coords.left=n.left,i&&(e.boxSize.width=i),m=e}var y={props:m,componentType:this.item.structure.componentType,reactClass:this.dragBoxClass};this.editorAPI.setPortalChildren("addPanel",[y])},snapDragBoxToCompIfNeeded:function(t){var e=this.snapToHandler.getClosestLayoutDistance(this.editorAPI,t,this.allowedSnapDirections);Math.abs(e.x)<=5&&(this.lastDragPosition.x+=e.x,this.lastDragFixedPosition.x+=e.x,t.x+=e.x),Math.abs(e.y)<=5&&(this.lastDragPosition.y+=e.y,this.lastDragFixedPosition.y+=e.y,t.y+=e.y);var i=this.snapToHandler.getSnapData(t,this.allowedSnapDirections,this.ignoreTouchingGridLines);this.editorAPI.snapData.set(i,!0)},clearDrag:function(){this.editorAPI.snapData.clear(!0),this.attachHandler.clearHighlightAttachCandidate(!0)},endDrag:function(t){if(this.clearDrag(),this.editorAPI.setPortalChildren("addPanel",null),this.isFirstDragEvent)return!1;var e=this.editorAPI.store.getState(),i=s(e,t);return this.lastDragPosition={x:i.pageX,y:i.pageY},this.isInPanelArea()?u.fedopsLogger.interactionEnded(u.fedopsLogger.INTERACTIONS.ADD_COMP_FROM_ADD_PANEL):this.onDrop(t),this.onItemDragEnd&&this.onItemDragEnd(),!0},getCompPositionRelativeToContainer:function(t,e){return{x:this.lastDragPosition.x-t.x-e.x+this.getBoxOffset().left*this.item.structure.layout.width,y:this.lastDragPosition.y-t.y-e.y+this.getBoxOffset().top*this.item.structure.layout.height}},getCompPositionRelativeToDockedNotFixedContainer:function(t){return{x:this.lastDragPosition.x-t.x+this.getBoxOffset().left*this.item.structure.layout.width,y:this.lastDragPosition.y-t.y+this.getBoxOffset().top*this.item.structure.layout.height}},getDropArguments:function(){var e=this.editorAPI,t=e.pluginService.getAllPluginsOfType(e.pluginService.pluginConstants.ADD_PANEL_DROP),i=P.find(t,function(t){return P.invoke(t,"condition",e)});if(i)return i.getOverrides(e,this);var n=this.getDragBoxStageLayout(!0),o=this.getDropContainer(n);if(!o)return{dropContainer:null,compPosRelativeToContainer:null};var r=e.components.layout.getRelativeToStructure(o);if(function(t,e){var i=t.components.is.repeaterItem(e)?e:t.components.getAncestorRepeaterItem(e);if(!i)return!1;var n=t.components.getContainer(i);return t.components.layout.isHorizontallyStretchedToScreen(n)}(e,o))return{dropContainer:o,compPosRelativeToContainer:this.getCompPositionRelativeToDockedNotFixedContainer(r)};var s,a,u=this.getCompPositionRelativeToContainer((a=(s=e).dsRead.siteSegments.getPagesContainer(),{x:s.components.layout.getRelativeToScreen(a).x,y:0}),r);if(h(e)&&(u.x+n.width<0||r.width<u.x||u.y+n.height<0||r.height<u.y))return{dropContainer:o,compPosRelativeToContainer:{x:(r.width-n.width)/2,y:(r.height-n.height)/2}};return{dropContainer:o,compPosRelativeToContainer:u}},onDrop:function(){var t=this.getDropArguments(),e=t.dropContainer,i=t.compPosRelativeToContainer,n=t.prerequisiteFunc;e&&(P.isFunction(n)&&n(),this.item.onDrop&&(P.defer(function(){this.item.onDrop(i,this.item,e,this.editorAPI)}.bind(this)),r.storePath(this.editorAPI,r.getIdByDataType(this.item.structure),P.get(this.item,["mediaManager","path"]))))},getDropContainer:function(t){var e=this.attachHandler.getCurrentAttachCandidate(t),i=e.candidateRef;return e.candidateStatus===o.ATTACH_CANDIDATE_STATUSES.INVALID?null:i}},a}),define("core/utils/layoutSymmetryUtil",["lodash"],function(s){"use strict";return{getLayoutSymmetry:function(t){return{horizontal:(r=t,Boolean(r.docked&&r.docked.hCenter||r.symmetry&&r.symmetry.horizontal)||(i=t,n=s.chain(i).get("docked.left.vw").isFinite().value(),o=s.chain(i).get("docked.right.vw").isFinite().value(),n&&o)),vertical:(e=t,Boolean(e.docked&&e.docked.vCenter||e.symmetry&&e.symmetry.vertical))};var e,i,n,o,r}}}),define("core/utils/layoutTransitionsUtil",["lodash","core/utils/layoutSymmetryUtil"],function(v,S){"use strict";var n=180/Math.PI,r=1/n,C={TOP:-1,BOTTOM:1,LEFT:-1,RIGHT:1,NONE:0};function o(t,e){return Math.atan2(t.y-e.y,t.x-e.x)}function T(t,e,i){return 0===e?t:{x:(t.x-i.x)*Math.cos(e)-(t.y-i.y)*Math.sin(e)+i.x,y:(t.x-i.x)*Math.sin(e)+(t.y-i.y)*Math.cos(e)+i.y}}function s(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}function a(t,e,i){if(!t)return null;var n=v.clone(t),o=i.x-e.x,r=i.y-e.y;return i.isShiftPressed&&(Math.abs(o)>=Math.abs(r)?r=0:o=0),n.x+=o,n.y+=r,n}function I(t,e,i,n){var o=0,r=i?Math.floor(e/2):e;return 1===t?o=Math.max(-r,n):-1===t&&(o=Math.min(r,n)),o}function u(t,e,i,n,o){t&&(this.initLayout=t,this.initMouseLocation=e,this.direction=i,this.proportional=n,this.rotationInRad=r*t.rotationInDegrees,this.ratio=o||1,this.initLayoutAspectRatio=t.width/t.height,this.getCorrectXYAfterTransformOriginChange=function(t){var e=v.pick(t,["x","y"]);return T(e=T(e,-this.rotationInRad,s(t)),this.rotationInRad,s(this.initLayout))},this.getLayoutAfterProportionalHorizontalResize=function(t,e){var i=v.clone(t),n=void 0;this.direction.x===C.LEFT?(n=-Math.min(e.x,t.width),i.x-=n):this.direction.x===C.RIGHT&&(n=Math.max(e.x,-t.width)),i.width+=n,i.height=i.width/this.initLayoutAspectRatio;var o=i.height-this.initLayout.height;return i.y-=o/2,v.assign(i,this.getCorrectXYAfterTransformOriginChange(i)),i},this.getLayoutAfterProportionalVerticalResize=function(t,e){var i=v.clone(t),n=0;this.direction.y===C.TOP?(n=-Math.min(e.y,t.height),i.y-=n):this.direction.y===C.BOTTOM&&(n=Math.max(e.y,-t.height)),i.height+=n,i.width=i.height*this.initLayoutAspectRatio;var o=i.width-this.initLayout.width;return i.x-=o/2,v.assign(i,this.getCorrectXYAfterTransformOriginChange(i)),i},this.getLayoutAfterStandardResize=function(t,e){var i,n,o,r,s,a,u,c,l,p,d,g,h,m,f,y,P=S.getLayoutSymmetry(t);return this.direction.x&&(P.horizontal?(s=t,a=e,u=this.direction.x,c=I(u,s.width,!0,a.x),1===u?(s.x-=c,s.width+=2*c):-1===u&&(s.x+=c,s.width-=2*c)):(e.x/=this.ratio,i=t,n=e,o=this.direction.x,r=I(o,i.width,!1,n.x),1===o?i.width+=r:-1===o&&(i.x+=r,i.width-=r))),this.direction.y&&(P.vertical?(h=t,m=e,f=this.direction.y,y=I(f,h.height,!0,m.y),1===f?(h.y-=y,h.height+=2*y):-1===f&&(h.y+=y,h.height-=2*y)):(e.y/=this.ratio,l=t,p=e,d=this.direction.y,g=I(d,l.height,!1,p.y),1===d?l.height+=g:-1===d&&(l.y+=g,l.height-=g))),v.assign(t,this.getCorrectXYAfterTransformOriginChange(t)),this.direction.x||delete t.width,this.direction.y||delete t.height,t},this.getLayout=function(t){var e,i,n,o,r,s,a,u,c,l,p,d,g,h,m,f=v.cloneDeep(this.initLayout),y=void 0,P={x:t.x-this.initMouseLocation.x,y:t.y-this.initMouseLocation.y};return e=P,i=-this.rotationInRad,P=T(e,i,{x:0,y:0}),y=this.proportional?(y=(m=this.direction).y===C.NONE&&m.x!==C.NONE?this.getLayoutAfterProportionalHorizontalResize(f,P):(h=this.direction).x===C.NONE&&h.y!==C.NONE?this.getLayoutAfterProportionalVerticalResize(f,P):(n=P,o=f,r=this.direction,s=0<r.x?o.x:o.x+o.width,a=0<r.y?o.y:o.y+o.height,u=r.x<0?o.x:o.x+o.width,c=r.y<0?o.y:o.y+o.height,p=a-(l=(c-a)/(u-s))*s,d=u+n.x,g=c+n.y,P={x:(-1*(-1*d-l*g)-l*p)/(l*l+1)-u,y:(l*(l*g- -1*d)- -1*p)/(l*l+1)-c},this.getLayoutAfterStandardResize(f,P)),v.mapValues(y,Math.round)):this.getLayoutAfterStandardResize(f,P)})}return{Drag:function(e,t,i){e&&(this.initLayout=e,this.boundCompsPositionRelativeToLayout=v.map(i,function(t){return{x:t.x-e.x,y:t.y-e.y}}),this.initMouseLocation=t,this.getLayout=a.bind(null,this.initLayout,this.initMouseLocation),this.getBoundComponentLayouts=function(t,e){return v.map(t,function(t){return{x:e.x+t.x,y:e.y+t.y}})}.bind(null,this.boundCompsPositionRelativeToLayout))},Rotate:function(t,e,i){t&&(this.initLayout=t,this.initMouseLocation=e,this.center=s(i),this.initMouseAngle=o(this.initMouseLocation,this.center),this.getLayout=function(t){var e=v.clone(this.initLayout),i=o(t,this.center);return e.rotationInDegrees+=(i-this.initMouseAngle)*n,e})},Resize:u,dragLayout:a,resizeLayout:function(t,e,i,n,o){return t?new u(t,e,i,n).getLayout(o):null}}}),define("core/utils/compsSectionsAnalyzer",["lodash","util","experiment"],function(c,e,o){"use strict";var n=700,r=300,u=30,l=30,p=-3;function d(i,t){return c(t).reject(function(t){return i.components.layout.isPinned(t)}).map(function(t){var e=i.components.layout.get(t);return e.bounding&&(e=e.bounding),e.bottomY=e.y+e.height,{layout:e,comp:t}}).sortBy("layout.y").value()}function g(t,i){return c.filter(t,function(t){return e=i?r:n,t.layout.width>=e;var e})}function h(t,o,r){return c.forEach(t,function(t){var e,i={y:(e=t).position.top,bottomY:e.position.bottom,height:f(e)},n=c.filter(o,function(t){return function(t,e,i){i=i||1;var n=e.y>=t.y&&e.y<=t.bottomY,o=e.bottomY>=t.y&&e.bottomY<=t.bottomY,r=e.y<=t.y&&e.bottomY>=t.bottomY;return n&&t.bottomY-e.y>=e.height*i||o&&e.bottomY-t.y>=e.height*i||r&&t.height>=e.height*i}(i,t.layout,r)});o=c.difference(o,n),t.comps=c.union(t.comps,c.map(n,"comp"))}),t}function m(t,e){for(var i=[],n=0;n<t.length;n++){var o=t[n],r={position:{top:o.layout.y,bottom:o.layout.bottomY},comps:[]};r.position.top=o.layout.y,r.comps.push(o.comp);for(var s=!1;!s;){var a=t[n+1];!a||a.layout.y>r.position.bottom+e?s=!0:(r.comps.push(a.comp),r.position.bottom=Math.max(r.position.bottom,a.layout.bottomY),n++)}i.push(r)}return i}function f(t){return t.position.bottom-t.position.top}function y(t,e,i){var n=t[e],o=t[i];o.comps=o.comps.concat(n.comps),o.position.top=Math.min(o.position.top,n.position.top),o.position.bottom=Math.max(o.position.bottom,n.position.bottom),t.splice(e,1)}function P(t){for(var e=void 0,i=void 0,n=void 0,o=void 0,r=0;r<t.length;r++)if(o=!1,f(e=t[r])<u){n=t[r-1],i=t[r+1];var s=n?e.position.top-n.position.bottom:Number.POSITIVE_INFINITY,a=i?i.position.top-e.position.bottom:Number.POSITIVE_INFINITY;s<a&&s<=l?(y(t,r,r-1),o=!0):a<s&&a<=l&&(y(t,r,r+1),o=!0),o&&r--}return t}function v(t){for(var e=0;e<t.length;){t[e+1]&&t[e+1].position.top<=t[e].position.bottom+p?y(t,e+1,e):e++}return t}function S(t){return t.position.bottom<0}function C(i,t){var n=e.appStudioUtils.isAppStudio()&&i.isMobileEditor();return c.map(t,function(t){var e=n||c.some(t.comps,function(t){return!i.components.is.removable(t)});return t.isRemovable=!!o.isOpen("se_hiddenElementsInBuilder")||!e,t})}return{analyzeContainer:function(t,e){var i,n,o=d(t,t.components.getChildren(e)),r=g(o,t.isMobileEditor()),s=c.difference(o,r),a=m(r,p);a=h(a,s,.5),i=s,n=c(a).flatMap("comps").keyBy("id").value();var u=m(s=c.reject(i,function(t){return!!n[t.comp.id]}),30);return c(a).union(u).sortBy("position.top").thru(P).thru(v).reject(S).thru(c.partial(C,t)).value()},getSortedComponentsWithLayout:d}}),define("core/utils/sectionsReorganizeUtil",["lodash","core/utils/compsSectionsAnalyzer"],function(a,r){"use strict";function u(t){return t.position.top}function c(t){return t.position.bottom-t.position.top}function l(i,t,n){a.forEach(t,function(t){var e=i.components.layout.get(t);i.components.layout.update(t,{y:e.y+n},!0)})}function p(t,e){var i=a.clone(t.position),n=a.clone(e.position),o=c(t),r=c(e),s=o-r;t.position.top=n.top-s,t.position.bottom=t.position.top+o,e.position.top=i.top,e.position.bottom=e.position.top+r}function d(t,e,i){var n=a.findIndex(t,e),o=a.findIndex(t,i);t[n]=i,t[o]=e}function g(t,e,i){e.position.top+=i,e.position.bottom+=i,e.comps&&l(t,e.comps,i)}return{addSectionByPosition:function(t,e){var i=a.findIndex(t,function(t){return t.position.top>e.position.top});return i?t.splice(i,0,e):t.push(e),t},getSectionSizeForBI:function(t){return 500<t?"large":61<t?"medium":"small"},getPageSections:function(t,e){if(e=e||t.pages.getFocusedPage(),t.dsRead.pages.isWidgetPage(e.id))return[];var i=r.analyzeContainer(t,e),n=t.components.layout.getRelativeToScreen(e);return a.forEach(i,function(t){t.position.top+=n.y,t.position.bottom+=n.y}),t.isMobileEditor()?(i=a.union(function(t,e){var i=t.dsRead.siteSegments.getSiteStructure(e),n=a.filter(t.dsRead.components.get.byType("wysiwyg.viewer.components.SiteRegionContainer",i)||[],t.dsRead.components.is.exist);if(!n.length)return[];var o=r.getSortedComponentsWithLayout(t,n);return a.map(o,function(t){return{position:{top:t.layout.y,bottom:t.layout.bottomY},comps:[t.comp],isStaticSection:!0}})}(t,"MOBILE"),i),a.sortBy(i,"position.top")):i},getHeaderSection:function(t){var e=t.components.layout.getRelativeToScreen(t.dsRead.siteSegments.getHeader());return{position:{top:e.y,bottom:e.height}}},duplicateSection:function(t,e,i){for(var n=e[i],o=t.components.layout.getRelativeToStructure(n.comps),r=c(n),s=i+1;s<e.length;s++)g(t,e[s],r);var a=t.copyPaste.duplicate(n.comps);t.dsActions.waitForChangesApplied(function(){t.components.layout.updateRelativeToStructure(a,{x:o.x,y:n.position.bottom})})},deleteSection:function(t,e,i){for(var n=e[i],o=c(n),r=i+1;r<e.length;r++)g(t,e[r],-1*o);return t.components.remove(n.comps)},shiftSection:g,switchSectionsByDrag:function(t,e,i,n){var o=void 0,r=void 0;r=i.position.top<n.position.top?(o=i,n):(o=n,i);var s=u(o),a=u(r);p(o,r),d(e,o,r),l(t,n.comps,n===r?u(r)-a:u(o)-s)},switchSections:function(t,e,i,n){var o=u(i),r=u(n);p(i,n),d(e,i,n),l(t,n.comps,u(n)-r),l(t,i.comps,u(i)-o)},isAtSectionsSwitchPoint:function(t,e,i){var n=c(e),o=e.position.top+n/2;return 1===i?t.y+t.height>=o:t.y<=o}}}),define("core/utils/mouseMoveActions/sectionDrag",["lodash","core/utils/layoutTransitionsUtil","core/utils/sectionsReorganizeUtil","constants"],function(s,r,a,t){"use strict";var o=0,u=void 0,c=void 0,l=void 0,p=void 0,d=void 0,g=void 0,h=void 0,m=void 0,f=void 0,y=void 0;function P(t,e){return t.clientY+u.ui.scroll.getScroll().scrollTop/(e||1)}function v(t){var e={x:0,y:t},i=g.getLayout(e);return i.y=Math.max(i.y,y),i}function S(t){for(var e=g.getBoundComponentLayouts(t),i=0;i<l.comps.length;i++)u.components.layout.updateRelativeToScreen(l.comps[i],s.pick(e[i],"y"),!0)}function C(t,e){var i=p<t?1:-1;p=t;var n=s.findIndex(c,l)+i;if(n>=c.length||n<0)return!1;var o=c[n];return!(!o||!a.isAtSectionsSwitchPoint(e,o,i))&&(a.switchSectionsByDrag(u,c,l,o),s.defer(I),!0)}function T(t,e){return e.position.top<t.position.bottom}function I(){var t=s.findIndex(c,l),e=c[t-1],i=c[t+1],n=0,o=0;if(i&&T(l,i)&&(o=l.position.bottom-i.position.top),e&&T(e,l)&&(o+=n=e.position.bottom-l.position.top),n&&a.shiftSection(u,l,n),o)for(var r=t+1;r<c.length;r++)a.shiftSection(u,c[r],o)}return{start:function(t,e){if(d=!(f=!1),u=t,l=e.draggedSection){var i={x:0,y:P(e.evt,u.getSiteScale())};p=i.y,c=s.sortBy(e.sections,"position.top"),h=e.onDragEnd,m=e.onDragStart,y=e.minY||0;var n={y:l.position.top,height:l.position.bottom-l.position.top},o=s.map(l.comps,function(t){return u.components.layout.getRelativeToScreen(t)});g=new r.Drag(n,i,o)}},on:function(t){var e;if(l)if(d)d=!1,e=s.map(l.comps,"id"),s.isEmpty(e)||(u.dsActions.renderPlugins.setCompsToShowOnTop(e),u.dsActions.renderPlugins.setCompsToShowWithOpacity(e,.5)),s.isFunction(m)&&m(),window.setTimeout(function(){I(),f=!0},o);else if(f){var i=P(t,u.getSiteScale()),n=v(i);S(n),C(i,n)}},end:function(t){var e,i=P(t);l&&!d&&((e=v({y:i,x:0})).y=l.position.top,S(e),u.history.add("Dragged Components Section"),u.dsActions.renderPlugins.setCompsToShowOnTop(null),u.dsActions.renderPlugins.setCompsToShowWithOpacity(null)),s.isFunction(h)&&h(l)},type:t.MOUSE_ACTION_TYPES.SECTION_DRAG}}),define("core/utils/AddPanelSectionDragHandler",["lodash","core/utils/AddPanelDragHandler","core/utils/mouseMoveActions/sectionDrag","core/utils/sectionsReorganizeUtil"],function(c,a,l,p){"use strict";function t(t,e,i,n,o,r,s){a.call(this,t,e,i,n,o,r,s)}return(t.prototype=Object.create(a.prototype)).constructor=t,c.assign(t.prototype,{init:c.noop,getFixedDragPosition:function(t){return{x:t.clientX,y:t.clientY}},handleDragOutsidePanelArea:function(t){var e=this.getDragBoxStageLayout();this.handleSectionDrag(t,e)},handleDragInPanelArea:function(){this.cancelSectionDragIfNeeded()},handleSectionDrag:function(t,e){this.isSectionDrag||(this.initSectionDrag(t,e),this.isSectionDrag=!0),this.draggedSection.layout.y=e.y,l.on(t)},initSectionDrag:function(t,e){var i,n,o,r,s,a;this.draggedSection=(i=this.editorAPI,n=e,r=(o=i).pages.getFocusedPage(),s=o.components.layout.getRelativeToScreen(r),a=Math.max(s.y-n.y,0),{origin:"addPanel",comps:[],layout:c.pick(n,["y","height"]),position:{top:n.y+a,bottom:n.y+n.height+a}});var u=p.getPageSections(this.editorAPI);u=p.addSectionByPosition(u,this.draggedSection),this.editorAPI.setPageSections(u,null),l.start(this.editorAPI,{sections:u,evt:t,draggedSection:this.draggedSection})},cancelSectionDragIfNeeded:function(){this.isSectionDrag&&(this.isSectionDrag=!1,this.editorAPI.history.add("sections reorganize"),this.editorAPI.history.undo(),this.editorAPI.clearPageSections())},clearDrag:function(){this.isSectionDrag&&this.editorAPI.clearPageSections()},getDropContainer:function(){return this.editorAPI.pages.getFocusedPage()},getCompPositionRelativeToContainer:function(t,e){var i=a.prototype.getCompPositionRelativeToContainer.call(this,t,e),n=this.draggedSection.position.top-this.draggedSection.layout.y;return i.y+=n,i}}),t}),define("core/utils/layoutConstraintsUtil/boundariesConstraintsUtil",["lodash"],function(m){"use strict";function a(t,e,i){var n,o,r,s,a,u,c,l,p,d,g,h;n=t,r=i,s=(o=e).x,a=o.x+o.width,(u=n.left)&&(m.isNumber(u.compLeftX)&&(r.x&&s<u.compLeftX&&(o.x+=u.compLeftX-s),r.width&&s<u.compLeftX&&(o.width-=u.compLeftX-s)),m.isNumber(u.compRightX)&&(r.x&&a<u.compRightX&&(o.x+=u.compRightX-a),r.width&&a<u.compRightX&&(o.width+=u.compRightX-a))),c=t,p=i,d=(l=e).x,g=l.x+l.width,(h=c.right)&&(m.isNumber(h.compRightX)&&(p.x&&g>h.compRightX&&(l.x+=h.compRightX-g),p.width&&g>h.compRightX&&(l.width+=h.compRightX-g)),m.isNumber(h.compLeftX)&&(p.x&&d>h.compLeftX&&(l.x+=h.compLeftX-d),p.width&&d>h.compLeftX&&(l.width-=h.compLeftX-d)))}function u(t,e,i){var n,o,r,s,a,u,c,l,p,d,g,h;n=t,r=i,s=(o=e).y,a=o.y+o.height,(u=n.top)&&(m.isNumber(u.compTopY)&&(r.y&&s<u.compTopY&&(o.y+=u.compTopY-s),r.height&&s<u.compTopY&&(o.height-=u.compTopY-s)),m.isNumber(u.compBottomY)&&(r.y&&a<u.compBottomY&&(o.y+=u.compBottomY-a),r.height&&a<u.compBottomY&&(o.height+=u.compBottomY-a))),c=t,p=i,d=(l=e).y,g=l.y+l.height,(h=c.bottom)&&(m.isNumber(h.compBottomY)&&(p.y&&g>h.compBottomY&&(l.y+=h.compBottomY-g),p.height&&g>h.compBottomY&&(l.height+=h.compBottomY-g)),m.isNumber(h.compTopY)&&(p.y&&d>h.compTopY&&(l.y+=h.compTopY-d),p.height&&d>h.compTopY&&(l.height-=h.compTopY-d)))}return{applyBoundariesConstraintOnLayout:function(t,e,i,n,o){var r,s=(r=o,m(n).pick(["x","y","width","height"]).pickBy(function(t,e){return!m.isEqual(t,r[e])}).mapValues(function(t,e){return e}).value());(t.left||t.right)&&a(t,n,s),(t.top||t.bottom)&&u(t,n,s)}}}),define("core/utils/layoutConstraintsUtil/LayoutConstraintsUtil",["lodash","core/utils/layoutConstraintsUtil/boundariesConstraintsUtil"],function(r,o){"use strict";function n(i,n,t){return r(t).filter(function(t){return e=t,(r.isFunction(e.applyConstraint)||r.isFunction(e.getBoundaries))&&(!r.isFunction(t.shouldConstrain)||t.shouldConstrain(i,n));var e}).map(function(t){var e=r.clone(t);return e.applyConstraint||(e.applyConstraint=o.applyBoundariesConstraintOnLayout.bind(null,e.getBoundaries(i,n))),e}).value()}function t(t,e,i){this.constraintsToApply=n(t,e,i)}return t.prototype.applyConstraints=function(e,i,t,n){var o=r.assign({},n,t);r.forEach(this.constraintsToApply,function(t){t.applyConstraint(e,i,o,n)}),r.assign(t,r.pick(o,r.keys(t)))},t.prototype.getConstraintArea=function(t,e){var i=r(this.constraintsToApply).filter(function(t){return r.isFunction(t.getConstraintArea)}).invokeMap("getConstraintArea",t,e).compact().flatten().value();return r.isEmpty(i)?null:i},t.prototype.hasConstraints=function(){return!r.isEmpty(this.constraintsToApply)},t}),define("core/utils/layoutConstraintsUtil/layoutConstraints/stretchToScreenConstraints",["lodash","stateManagement"],function(d,t){"use strict";var g=t.editorPlugins.domMeasurements.selectors.getPreviewPosition;return{shouldConstrain:function(t,e){return t.components.layout.isHorizontallyStretchedToScreen(e)},applyConstraint:function(t,e,i,n){var o,r=t.store.getState(),s=g(r).width,a=(o=n,d(i).pick(["x","y","width","height"]).pickBy(function(t,e){return!d.isEqual(t,o[e])}).mapValues(function(t,e){return e}).value()),u=void 0;if(a.x){var c=i.x;(u=d.min([80-c,0]))&&(i.x+=u)}if(a.width){var l=i.x+i.width,p=s-80;(u=d.max([p-l,0]))&&(i.width+=u)}}}}),define("core/utils/layoutConstraintsUtil/layoutConstraints/constraintsUtil",["lodash"],function(n){"use strict";return{isShownOnAllPagesComponent:function(e,t){var i=n.isArray(t)?t:[t];return n.some(i,function(t){return e.components.isShowOnAllPages(t)&&!e.utils.isSameRef(t,e.dsRead.siteSegments.getFooter())})}}}),define("core/utils/layoutConstraintsUtil/layoutConstraints/mobileBoundariesConstraints",["lodash","core/utils/layoutConstraintsUtil/layoutConstraints/constraintsUtil","stateManagement","constants"],function(g,h,n,o){"use strict";var m="getSiteStructure",f="getHeader",y="getFooter",i=n.editorPlugins.components.selectors;function P(t,e){var i=t.siteSegments[e].call(t.siteSegment);return t.components.layout.getRelativeToScreen(i)}function v(t,e){return{left:t.x,width:t.width,height:t.height-e.height}}function S(t,e){var i=P(t,f);return g.assign(v(e,i),{top:e.y+i.height})}function C(t,e){return t.utils.isSameRef(e,t.dsRead.siteSegments.getHeader())}function T(t,e){return t.utils.isSameRef(e,t.dsRead.siteSegments.getFooter())}function I(t,e){return"SiteRegionContainer"===i.getCompTypeSuffix(e,t.dsRead)}var r="wysiwyg.viewer.components.MenuContainer";function u(t){var e,i=n.editorPlugins.selection.selectors.getFocusedContainer(t.store.getState());return e=i,t.components.getType(e)===r}function c(t){var e=P(t,m);return{top:{compBottomY:o.SIZE_LIMITS.MOBILE_DRAG_CONSTRAINT_MARGINS},bottom:{},left:{compRightX:e.x+o.SIZE_LIMITS.MOBILE_DRAG_CONSTRAINT_MARGINS},right:{compLeftX:e.x+e.width-o.SIZE_LIMITS.MOBILE_DRAG_CONSTRAINT_MARGINS}}}var s={getBoundaries:function(t,e){var i,n,o=t.components.getContainer(e);if(I(t,o))return i=o,{top:{compTopY:(n=t.components.layout.getRelativeToScreen(i)).y},bottom:{compBottomY:n.y+n.height},left:{compLeftX:n.x},right:{compRightX:n.x+n.width}};var r=c(t);if(!h.isShownOnAllPagesComponent(t,e))return g.assign(r.bottom,{compBottomY:5e5}),r;var s=P(t,y);if(u(t)||g.assign(r.bottom,{compBottomY:s.y+s.height}),C(t,o)){var a=P(t,f);return g.assign(r.bottom,{compBottomY:a.height}),r}return T(t,o)&&g.assign(r.top,{compTopY:s.y}),r},getConstraintArea:function(t,e){var i,n,o,r,s,a,u,c,l,p=t.components.getContainer(e),d=P(t,m);return I(t,p)?(n=d,o=p,r=P(i=t,f),s={left:r.x,width:r.width,height:r.height,top:r.y},a=i.components.layout.getRelativeToScreen(o),u=g.assign(v(n,a),{top:n.y+a.height+a.y}),g.concat(s,u)):h.isShownOnAllPagesComponent(t,e)?C(t,p)?S(t,d):T(t,p)?(c=d,l=P(t,y),g.assign(v(c,l),{bottom:c.y+l.y})):null:null}},t={getBoundaries:function(t){var e=P(t,m),i=P(t,f);return{top:{compTopY:e.y},bottom:{compBottomY:i?Math.min(i.height,o.SIZE_LIMITS.MOBILE_MENU_MAX_Y):o.SIZE_LIMITS.MOBILE_MENU_MAX_Y},left:{compLeftX:e.x},right:{compRightX:e.x+e.width}}},getConstraintArea:function(t){var e=P(t,m),i=P(t,f),n=S(t,e);return g.assign(n,{top:e.y+Math.min(o.SIZE_LIMITS.MOBILE_MENU_MAX_Y,i.height)}),n}},a={"wysiwyg.viewer.components.HeaderContainer":{getBoundaries:function(t,e){var i=t.dsRead.components.getChildren(g.isArray(e)?e[0]:e),n=c(t);return g.isEmpty(i)?n:g.assign(n,{top:{compBottomY:o.SIZE_LIMITS.MOBILE_HEADER_MIN_HEIGHT}})},getConstraintArea:function(){return null}},"wysiwyg.viewer.components.mobile.TinyMenu":t,"wysiwyg.viewer.components.MenuToggle":t,"wysiwyg.viewer.components.BackToTopButton":{getBoundaries:function(){return{}},getConstraintArea:function(){return null}}};function l(t,e){var i=t.components.getType(e);return a[i]||s}return{shouldConstrain:function(t){return t.isMobileEditor()},getConstraintArea:function(t,e){return l(t,e).getConstraintArea(t,e)},getBoundaries:function(t,e){return l(t,e).getBoundaries(t,e)}}}),define("core/utils/layoutConstraintsUtil/layoutConstraints/desktopBoundariesConstraints",["lodash","core/utils/layoutConstraintsUtil/layoutConstraints/constraintsUtil","experiment"],function(t,s,n){"use strict";var a=5e5;return{shouldConstrain:function(t){return!t.isMobileEditor()},getBoundaries:function(t,e){var i={};return i.top=n.isOpen("removeDesktopTopConstraintExp")?{compBottomY:20}:{compTopY:0},t.isCurrentPageLandingPage()||(i.bottom={compBottomY:function(t,e){if(!s.isShownOnAllPagesComponent(t,e)||t.siteSegments.isUsingSectionsLayout()&&(n=e,o=(i=t).siteSegments.getSiteStructure(),i.utils.isSameRef(i.components.getContainer(n),o)))return a;var i,n,o,r=t.components.layout.getRelativeToScreen(t.dsRead.siteSegments.getFooter());return r.y+r.height}(t,e)}),i}}}),define("core/utils/layoutConstraintsUtil/layoutConstraints/repeaterElementsBoundariesConstraints",["stateManagement"],function(t){"use strict";var i=t.editorPlugins.components.selectors;return{shouldConstrain:function(t,e){return t.isMobileEditor()&&t.components.is.descendantOfRepeaterItem(e)&&!i.isRepeaterItem(e,t.dsRead)},getBoundaries:function(t,e){var i=t.components.getAncestorRepeaterItem(e),n=t.components.layout.getRelativeToScreen(e),o=t.components.layout.getRelativeToScreen(i);return{left:{compLeftX:o.x-n.width+20},right:{compRightX:o.x+o.width+n.width-20},top:{compTopY:o.y},bottom:{compBottomY:o.y+o.height}}}}}),define("core/utils/layoutConstraintsUtil/editorConstraintsRegistry",["core/utils/layoutConstraintsUtil/layoutConstraints/stretchToScreenConstraints","core/utils/layoutConstraintsUtil/layoutConstraints/mobileBoundariesConstraints","core/utils/layoutConstraintsUtil/layoutConstraints/desktopBoundariesConstraints","core/utils/layoutConstraintsUtil/layoutConstraints/repeaterElementsBoundariesConstraints"],function(t,e,i,n){"use strict";return[t,e,i,n]}),define("core/utils/layoutConstraintsUtil/EditorLayoutConstraintsUtil",["core/utils/layoutConstraintsUtil/LayoutConstraintsUtil","core/utils/layoutConstraintsUtil/editorConstraintsRegistry"],function(i,n){"use strict";function t(t,e){i.call(this,t,e,n)}return t.prototype=i.prototype,t}),define("core/utils/updateLayoutUtil",["lodash","core/utils/layoutConstraintsUtil/EditorLayoutConstraintsUtil"],function(h,m){"use strict";function f(t,e,i,n){if(!t)return t;var o=h.pick(t,["width","height"]);return h.isNumber(t.x)&&(o.x=e.x+t.x,i&&(o.x+=n)),h.isNumber(t.y)&&(o.y=e.y+t.y),o}function y(t,i){return h.some(t,function(t,e){return!h.isEqual(t,i[e])})}return{getLayoutAfterConstraints:function(t,e,i,n){if(y(i,n)&&!t.utils.isPage(e)){var o=new m(t,e);if(o.hasConstraints()){var r=t.components.layout.isHorizontallyStretchedToScreen(e),s=t.site.getSiteX(),a=(d=e,g=(p=t).components.getContainer(d),p.components.layout.getRelativeToScreen(g)),u=f(i,a,r,s),c=f(n,a,r,s);o.applyConstraints(t,e,u,c);var l=function(t,e,i,n){if(!t)return t;var o=h.pick(t,["width","height"]);return h.isNumber(t.x)&&(o.x=t.x-e.x,i&&(o.x-=n)),h.isNumber(t.y)&&(o.y=t.y-e.y),o}(u,a,r,s);h.assign(i,h.pick(l,h.keys(i)))}}var p,d,g;return i},getLayoutRelativeToScreenAfterConstraints:function(t,e,i,n){if(y(i,n)&&!t.utils.isPage(e)){var o=new m(t,e);o.hasConstraints()&&o.applyConstraints(t,e,i,n)}return i}}}),define("core/utils/updateDataUtil",["lodash","core/utils/updateDataPlugins/updateDataPlugins"],function(i,n){"use strict";return{fixData:function e(t){return n[t.type]&&n[t.type](t),i.forEach(t,function(t){i.isPlainObject(t)&&t.type&&e(t)}),t}}}),define("core/utils/updatePropertiesPlugins/plugins/wPhotoPropertiesPlugin",["lodash"],function(u){"use strict";return function(t,e,i,n,o){return o||function(t,e,i,n){var o=u.pick(t,"effectName");if(!u.isEmpty(o)){var r=i.viewMode.VIEW_MODES.MOBILE,s=i.components.getPage(e).id,a=i.components.get.byId(e.id,s,r);a&&i.components.is.exist(a)&&i.components.properties.mobile.isForked(a)&&n.components.properties.update(a,o)}}(t,e,i,n),t}}),define("core/utils/updatePropertiesPlugins/plugins/vectorImagePropertiesPlugin",["lodash"],function(l){"use strict";return function(t,e,i,n,o){return o||function(t,e,i,n){var o=l.pick(t,"flip");if(!l.isEmpty(o)){var r=i.viewMode.VIEW_MODES.MOBILE,s=i.components.getPage(e).id,a=i.components.get.byId(e.id,s,r),u=a&&i.components.is.exist(a),c=u&&i.components.properties.mobile.isForked(a);u&&!c&&n.components.properties.mobile.fork(a)}}(t,e,i,n),t}}),define("core/utils/updatePropertiesPlugins/updatePropertiesPlugins",["core/utils/updatePropertiesPlugins/plugins/wPhotoPropertiesPlugin","core/utils/updatePropertiesPlugins/plugins/vectorImagePropertiesPlugin"],function(t,e){"use strict";return{WPhotoProperties:t,VectorImageProperties:e}}),define("core/utils/updatePropertiesUtil",["lodash","core/utils/updatePropertiesPlugins/updatePropertiesPlugins"],function(t,s){"use strict";return{fixProperties:function(t,e,i,n,o){var r=t.type||"DefaultProperties";return s[r]&&s[r](t,e,i,n,o),t}}}),define("core/utils/DragConstraintsHandler",["lodash","core/utils/layoutConstraintsUtil/EditorLayoutConstraintsUtil"],function(t,n){"use strict";function e(t,e){if(t){this.editorAPI=t,this.comp=e;var i=new n(t,e);this.constraintArea=i.getConstraintArea(t,e)}}return e.prototype.highlightDragConstraints=function(){this.editorAPI.setConstraintArea(this.constraintArea)},e.prototype.removeHighlightDragConstraints=function(){this.editorAPI.setConstraintArea(null)},e}),define("core/utils/scrollUtils",["lodash"],function(i){"use strict";function n(){return window.document.getElementById("scrollableEditorStage")}return{getScroll:function(){var t=n();return i.pick(t,["scrollLeft","scrollTop","scrollHeight","scrollWidth"])},setScroll:function(t){var e=n();i.isUndefined(t.scrollTop)||(e.scrollTop=t.scrollTop),i.isUndefined(t.scrollLeft)||(e.scrollLeft=t.scrollLeft)}}}),define("core/utils/compControlsMeasurer",["lodash","zepto","constants"],function(d,y,f){"use strict";var P=void 0,v=f.UI.compPanelMargins,S={COMP_TOP:"compTop",COMP_BOTTOM:"compBottom",COMP_LEFT:"compLeft",COMP_RIGHT:"compRight",VIEWPORT_TOP:"viewPortTop",VIEWPORT_BOTTOM:"viewPortBottom",VIEWPORT_LEFT:"viewPortLeft",VIEWPORT_RIGHT:"viewPortRight",GFPP_LEFT:"gfppLeft",GFPP_RIGHT:"gfppRight"};function g(t){return{y:t.y,x:t.x,width:t.width,height:t.height,bottomY:t.y+t.height,rightX:t.x+t.width}}function s(t,e){var i=e.viewPortForChildOfFocused||e.viewPort;return t.y>=i.y?S.COMP_TOP:t.bottomY<=i.bottomY?S.COMP_BOTTOM:S.VIEWPORT_TOP}function C(t,e,i){var n=e.viewPort,o=n.bottomY-t.y,r=t.bottomY-n.y,s=i?y(i).height():0,a=t.y<n.y,u=s<=o,c=t.bottomY>n.bottomY,l=s<=r,p=s<=n.bottomY-n.y;return a||!p?S.VIEWPORT_TOP:u?S.COMP_TOP:c?S.VIEWPORT_BOTTOM:l?S.COMP_BOTTOM:S.VIEWPORT_TOP}function l(t,e,i){return{gfpp:s(t,e),compPanel:C(t,e,i)}}function T(t,e,i,n,o){var r=Math.max(P,o&&o.top||0)+n,s=n+P,a=Math.max(P,o&&o.bottom||0);switch(t){case S.COMP_TOP:return Math.max(e.y-r,i.y-s);case S.COMP_BOTTOM:return e.bottomY+a;case S.VIEWPORT_TOP:return i.y-s}}function I(t,e,i,n){switch(t){case S.COMP_BOTTOM:return e.bottomY-n;case S.COMP_TOP:return e.y;case S.VIEWPORT_BOTTOM:return i.bottomY-n}return i.y}function A(t,e,i,n,o){if(R(e,i.width))return Math.max(o,i.x);switch(t){case S.COMP_LEFT:return e.x;case S.VIEWPORT_LEFT:return i.x;case S.VIEWPORT_RIGHT:return i.rightX-n}}function p(t,e,i,n,o){var r=o.gfppSize,s=o.viewPort,a=o.rotateKnobMargins,u=o.pageXBoundary,c=o.alignToPageBoundaries,l={gfpp:{top:0,left:0},compPanel:{top:0,left:0}},p=r.height,d=r.width,g=n?y(n).height():0,h=n?y(n).width():0;if(l.gfpp.top=T(t.gfpp,i,s,p,a),l.gfpp.left=A(e.gfpp,i,s,d,u),c||R(i,s.width)){var m=Math.max(u,s.x),f=function(t,e,i,n,o,r,s){var a={left:0,top:0},u=i?y(i).height():0,c=i?y(i).width():0;if(0===c||0===u)return{left:0,top:0};var l=I(C(t,{viewPort:e},i),t,e,u),p=c<=o-e.x,d=u<=e.bottomY-s,g=r===S.COMP_TOP&&u<=s-e.y-v,h=r===S.COMP_BOTTOM&&u<=e.bottomY-(s+n)-v;a.top=p?(a.left=o-(c+v/2),d?s:e.bottomY-u):g?(a.left=o,s-(u+P)):h?(a.left=o,s+n+P):(a.left=e.rightX-c,l);return a}(i,s,n,r.height,m,t.gfpp,l.gfpp.top);l.compPanel=f}else l.compPanel.top=I(t.compPanel,i,s,g),l.compPanel.left=function(t,e,i,n,o,r,s){var a=e.rightX-e.x;switch(t){case S.COMP_LEFT:return e.x-n-Math.max(v,s&&s.left||0);case S.COMP_RIGHT:return e.x+a+Math.max(v,s&&s.right||0);case S.VIEWPORT_LEFT:return i.x;case S.VIEWPORT_RIGHT:return i.rightX-n-v;case S.GFPP_LEFT:return r-n-v;case S.GFPP_RIGHT:return r+o+v}}(e.compPanel,i,s,h,d,l.gfpp.left,a);return l}function x(t,e,i){return t.x>=e.x?i+t.x<=e.rightX?S.COMP_LEFT:S.VIEWPORT_RIGHT:S.VIEWPORT_LEFT}function h(t,e,i){var n,o,r,s={},a=(o=(n=t).x+f.UI.CUSTOM_GFPP_POS.X_OFFSET_FROM_CLICK,{y:r=n.y,x:o,width:0,height:0,bottomY:r,rightX:o}),u=l(a,{viewPort:e}).gfpp,c=x(a,e,i.width);return s.top=T(u,a,e,i.height),s.left=A(c,a,e,i.width,0),s}function m(t,e,i,n){var o,r,s,a=n.gfppSize,u=n.viewPort,c=n.navControlsSize,l=a.width,p=i?y(i).width():0,d=t.rightX-t.x,g={},h=void 0,m=void 0;return g.gfpp=x(t,u,l),g.navControls=(o=t,r=u,s=c.width,o.x>=r.x?s+o.x+f.UI.NAVIGATION_CONTROLS_POS.LEFT<=r.rightX?S.COMP_LEFT:S.VIEWPORT_RIGHT:S.VIEWPORT_LEFT),e.gfpp===e.compPanel?(h=t.rightX+p+v<=u.rightX,m=t.x-p-v>=u.x,t.rightX<u.x?g.compPanel=S.VIEWPORT_LEFT:g.compPanel=h?S.COMP_RIGHT:m?S.COMP_LEFT:S.VIEWPORT_RIGHT):g.gfpp===S.COMP_LEFT?g.compPanel=l<=d?(h=t.x+d+v+p<u.rightX,m=t.x-v-p>=u.x,h?S.COMP_RIGHT:m?S.COMP_LEFT:S.VIEWPORT_RIGHT):(m=t.x-v-p>=u.x)?S.COMP_LEFT:S.GFPP_RIGHT:g.gfpp===S.VIEWPORT_RIGHT?g.compPanel=S.GFPP_LEFT:g.gfpp===S.VIEWPORT_LEFT&&((h=Math.max(u.x+l,t.x+d)+p<=u.rightX)?u.x+l>t.x+d?g.compPanel=S.GFPP_RIGHT:g.compPanel=S.COMP_RIGHT:g.compPanel=S.VIEWPORT_RIGHT),g}function w(t,e,i){var n,o,r=l(t,i,e),s=m(t,r,e,i),a=p(r,s,t,e,i),u=function(t,e,i,n){var o=n.navControlsSize,r=n.viewPort,s=n.pageXBoundary,a={};if(R(i,r.width)){var u=Math.max(s,r.x);a.left=u-i.x+f.UI.NAVIGATION_CONTROLS_POS.LEFT}else switch(e.navControls){case S.VIEWPORT_LEFT:a.left=r.x-i.x+f.UI.NAVIGATION_CONTROLS_POS.LEFT;break;case S.VIEWPORT_RIGHT:a.left=r.rightX-(i.x+o.width+f.UI.NAVIGATION_CONTROLS_POS.LEFT);break;case S.COMP_LEFT:a.left=f.UI.NAVIGATION_CONTROLS_POS.LEFT}switch(t.gfpp){case S.COMP_BOTTOM:a.top=f.UI.NAVIGATION_CONTROLS_POS.BOTTOM;break;case S.COMP_TOP:case S.VIEWPORT_TOP:a.top=f.UI.NAVIGATION_CONTROLS_POS.TOP}return a}(r,s,t,i),c=(n=u,(o=i).navControlsSize.width?n.left+o.navControlsSize.width+f.UI.MARGIN_BETWEEN_FOCUS_TAB_AND_COMP_LABELS:0);return{gfppStyle:a.gfpp,compPanelStyle:a.compPanel,navControlsStyle:u,editBoxLabelsOffset:c}}function R(t,e){return t.x<1&&t.width>=e}return{getCompControlsPositions:function(t,e,i,n,o,r){n=d(n).pickBy().defaults({gfppSize:{width:0,height:0},navControlsSize:{width:0,height:0},pageXBoundary:0,rotateKnobMargins:{},alignToPageBoundaries:!1}).value();var s=void 0,a=void 0,u=g(i.layout),c=t&&t.id!==i.id;if(P=f.UI.gfppMargins,r?P=r:t&&!c?P=f.UI.navControlsGfppMargins:i.hasLabels&&(P=f.UI.componentLabelsGfppMargins),s=w(t?a=g(t.layout):u,e,n),t&&c){var l=function(t,e,i){if(e.height<i.height+2*f.UI.VIEWPORT_VERTICAL_MARGINS)return t;var n={y:Math.max(t.y,e.y+f.UI.VIEWPORT_VERTICAL_MARGINS),height:Math.min(t.height,e.height-2*f.UI.VIEWPORT_VERTICAL_MARGINS),bottomY:Math.min(t.bottomY,e.bottomY-f.UI.VIEWPORT_VERTICAL_MARGINS)};return d.assign({},t,n)}(n.viewPort,a,u),p=w(u,e,d.defaults({viewPortForChildOfFocused:l},n));s.gfppStyle=p.gfppStyle,s.compPanelStyle=p.compPanelStyle,s.editBoxLabelsOffset=0}return o&&(s.gfppStyle=h(o,n.viewPort,n.gfppSize)),s},getGfppPosition:function(t,e,i){P=f.UI.gfppMargins;var n=g(e),o=s(n,{viewPort:i}),r=x(n,i,t.width);return{top:T(o,n,i,t.height),left:A(r,n,i,t.width,0)}}}}),define("core/utils/fixedPositionPlugins/tinyMenuFixedPositionPlugin",["lodash","constants"],function(l,p){"use strict";return function(t,e,i){var n,o,r,s,a=t.components.layout.getRelativeToStructure(e),u={fixedPosition:i},c=p.SIZE_LIMITS.MOBILE_MENU_MAX_Y;a.y>c&&(o=e,r=(n=t).components.getContainer(o),s=n.dsRead.siteSegments.getHeader(),l.isEqual(r,s)||n.components.setContainer(o,s),l.merge(u,t.mobile.mobileOnlyComponents.getTinyMenuDefaultPosition())),t.components.layout.update(e,u)}}),define("core/utils/fixedPositionPlugins/fixedPositionPlugins",["lodash","core/utils/fixedPositionPlugins/tinyMenuFixedPositionPlugin"],function(s,t){"use strict";var a={"wysiwyg.viewer.components.mobile.TinyMenu":t,"wysiwyg.viewer.components.MenuToggle":t};return{registerPlugin:function(t,e){a[t]=e},setFixedPosition:function(t,e,i){var n,o,r=t.components.getType(e);return a[r]&&s.isFunction(a[r])?a[r].call(null,t,e,i):(n=e,o=i,t.components.layout.updateFixedPosition(n[0]||n,o)),i}}}),define("core/utils/social",["lodash","util","require","coreUtilsLib"],function(u,c,t,e){"use strict";var i="135c3d92-0fea-1f9d-2ba5-2a1dfb04297e",n="feedb3b8-0b1a-413f-bcab-73e805d0f554";function s(t){window.open(t)}var l=u.once(function(t){var e,i=(e=window.location.hostname.match(/editor\.(.*)/))?"www."+e[1]:"www.wix.com",n={appId:u.includes(i,"wix.com")?"304553036307597":"394905507233800",status:!0,cookie:!0,xfbml:1};t.init(n)});return{openShoutout:function(t){s(["//www.wix.com/my-account/sites/",t,"/app/",i,"?referralInfo=ed_prem_promo","&appState=%3Fdl%3Dmessage%26messageId%3D",n].join(""))},openTwitter:function(t,e){var i,n,o,r=e?c.translate("TWITTER_CHECK_OUT_MY_SITE_MSG_PREMIUM"):c.translate("TWITTER_CHECK_OUT_MY_SITE_MSG_NON_PREMIUM");s((i=r,n=c.translate("TWITTER_RELATED_WIX_ACCOUNTS"),o=c.translate("TWITTER_WIX_HASHTAGS"),i=decodeURIComponent(i),"https://twitter.com/intent/tweet?url="+t+"&text="+i+"&related="+n+"&hashtags="+o))},openFacebook:function(o,r,s,a){t(["facebook"],function(t){l(t);var e=u.clone(o),i="http://"+r+".wix.com/html5webbuilder/share?utm_campaign=vir_fb_pub_h_"+r+"&experiment_id="+e.replace(/https?:\/\//,""),n={method:"feed",name:s,description:a,link:o,actions:[{name:c.translate("FACEBBOK_SHARE_MESSAGE"),link:i}]};t.ui(n)},function(t){e.log.error(t)})}}}),define("core/utils/spotifyUtils",["util"],function(c){"use strict";var t=c.url,l=["tracks","albums","artists"],p=t.joinURL(c.editorModel.editorBase,"app/external/SpotifySearch/index.html?id=");return{openIframe:function(t,e,i){var n=c.languages.getLanguageCode(),o="spotifySearch_"+Date.now();e=e||l;var r,s,a,u=t.selection.getSelectedComponentType();t.panelManager.openPanel("panels.focusPanels.spotifySearchFocusPanel",{panelName:"Spotify Search",iframeSrc:(r=o,s=e,a=n,p+r+"&lang="+a+"&tabs="+JSON.stringify(s)+"&default_tab="+s[0]+"&fontFaceUrl=https://static.parastorage.com/services/wix-public/1.160.0/css/Helvetica/fontFace.css"),id:o,selectedComponentType:u,callback:i},!1)},validateSpotifyUri:function(t){return(i=t)&&0===i.indexOf("spotify:")&&2<(e=t.split(":")).length&&0<e[e.length-1].length;var e,i},validateFollowUri:function(t){return 0===t.toLowerCase().indexOf("spotify:artist:")}}}),define("core/utils/componentPreviewReadyPlugins/componentPastePlugins",["lodash"],function(u){"use strict";function c(t,e){return u.isEqual(e.controllerRef,t.controllerRef)&&u.isEqual(e.role,t.role)}return{removeConnectedComponentsIfAlreadyExist:function(n,t){var e,i,o,r=(e=n,i=u.cloneDeep(t),(o=i.id&&e.components.get.byId(i.id))&&e.components.is.exist(o)?u.omit(i,"id"):i),s=n.dsRead.platform.serialization.getConnectedComponents(r),a=u.transform(s,function(t,e,i){t[i]=function(t,e,i){var n=t.components.get.byId(e,t.dsRead.pages.getFocusedPageId());if(!n)return[];var o=t.dsRead.platform.controllers.connections.get(n);return u.reject(i,function(t){return u.find(o,u.partial(c,t))})}(n,i,e)},{});return n.dsActions.platform.serialization.setConnectedComponents(r,a)},removeSerializedDataId:function(t,e){return"platform.components.AppController"===e.componentType?e:u.omit(e,"id")}}}),define("core/utils/componentPreviewReadyPlugins/componentPreviewReadyPlugins",["lodash","core/utils/componentPreviewReadyPlugins/formPlugin","core/utils/componentPreviewReadyPlugins/componentPastePlugins"],function(o,r,e){"use strict";return[function(t,n){var e=n.components.get.byType(t);o.forEach(e,function(t){var e=n.components.data.get(t),i=o.clone(e);r.updateDataWithDefaults(e,n),o.isEqual(e,i)||n.components.data.update(t,e)})}.bind(null,["wysiwyg.viewer.components.ContactForm","wysiwyg.viewer.components.DynamicContactForm","wysiwyg.common.components.subscribeform.viewer.SubscribeForm"]),function(t){t.registerPasteComponentPlugin("platform.components.AppController",e.removeConnectedComponentsIfAlreadyExist),t.registerPasteComponentPlugin("*",e.removeSerializedDataId)}]}),define("core/utils/pageUtils/tpaTypeUtils",[],function(){"use strict";var r={isTPA:function(t){return!!t.tpaApplicationId},isTPASpecialPage:function(t,e,i){if(!r.isTPA(e))return!1;var n=t.pages.isContainsCompWithType(e.id,t.tpa.constants.COMP_TYPES.TPA_MULTI_SECTION),o=!i||!t.routers.getRouterDataForPageIfExist(e.id);return n&&o},isPageNotVisibleInPagesMenu:function(t,e){return t.tpa.isPageMarkedAsHideFromMenu(e.tpaApplicationId,e.tpaPageId)}};return r}),define("core/utils/pageUtils/blogTypeUtils",["core/utils/pageUtils/tpaTypeUtils"],function(n){"use strict";var i={isBlog:function(t,e){return!!e.appInnerID&&"blog"===t.dsRead.wixapps.classics.getPackageName(e.appInnerID)},isBlogPage:function(t,e){return"14bcded7-0066-7c35-14d7-466cb3f09103"===function(t,e){if(n.isTPA(e)){var i=t.dsRead.tpa.section.getPageData(e.id).appData;return i&&i.appDefinitionId}}(t,e)},isBlogSpecialPage:function(t){return"7326bfbb-4b10-4a8e-84c1-73f776051e10"===t.appPageId},isBlogSectionPage:function(t,e){return i.isBlog(t,e)&&!i.isBlogSpecialPage(e)}};return i}),define("core/utils/pageUtils/dynamicTypeUtils",["lodash"],function(r){"use strict";return{isDynamicPage:function(t,e){return r.isObject((i=t,n=e,(o=r.get(n,"id")&&i.dsRead.pages.getReference(n.id))&&i.dsRead.routers.getRouterRef.byPage(o)));var i,n,o}}}),define("core/utils/pageUtils/wixStoreTypeUtils",["lodash","core/utils/pageUtils/tpaTypeUtils"],function(t,n){"use strict";var e="product_page",i="shopping_cart",o="thank_you_page";function r(t,e){return e.tpaPageId===t}return{isWixStore:t.partial(function(t,e,i){return function(t,e){if(n.isTPA(e)){var i=t.dsRead.tpa.section.getPageData(e.id).appData;return i&&i.appDefinitionId}}(e,i)===t},"1380b703-ce81-ff05-f115-39571d94dfcd"),isWixStoreCartPage:t.partial(r,i),isWixStoreThankYouPage:t.partial(r,o),isWixStoreProductPage:t.partial(r,e)}}),define("core/mixins/editorAPIMixin",["prop-types"],function(t){"use strict";return{contextTypes:{editorAPI:t.object},getEditorAPI:function(){return this.context.editorAPI}}}),define("core/app/styleManager",["lodash"],function(p){"use strict";function i(t,e){return p.isEqual(t,e)}function c(t,n,e,i,o){var r=p.union(i,[e]);return p.reduce(r,function(t,e){var i=p(e).thru(n.get.byType).map(function(t){return{compPtr:t,styleItem:n.style.get(t)}}).filter({styleItem:{styleType:o}}).value();return t=p.union(t,i)},[])}function r(t,e,i){var n=function(t,e,i){if(!e){var n=p.find(t.COMPONENT_DEFINITION_MAP,function(t){return t.styles&&t.styles[i]});return n&&n.styles[i]}var o=t.getDefinition(e);if(o&&o.styles)return o.styles[i]}(t,e,i);return n?{id:i,compId:"",componentClassName:"",pageId:"",styleType:"system",type:"TopLevelStyle",skin:n,style:{groups:{},properties:{},propertiesSource:{}}}:null}function d(t){var e=p.map(t,function(t,e){return[e,t]});return p.sortBy(e,p.head)}return{getSystemStyleById:function(t,e,i,n){var o=t.styles.get(i);return o||(o=r(e,n,i)),o},getStyleById:function(t,e,i,n){return this.getSystemStyleById(t,e,i,n)},getUniqueCustomStylesAndCompPtr:function(t,e,i){var n=c(0,e,i,[],"custom"),o=this.getUniqueThemeStyleList(t,e,i),r=p.uniqBy(n,function(t){return JSON.stringify(t.styleItem.style?d(t.styleItem.style.properties):{})});return p.remove(r,p.bind(function(e){return p.find(o,p.bind(function(t){return this.isEqualWithoutTypeConsideration(e.styleItem,t)},this))},this)),p.sortBy(r,"styleItem.id")},getUniqueCustomStyleList:function(t,e,i){var n,o,r,s,a,u=(n=e,o=i,r=[],s="custom",a=p.union(r,[o]),p.reduce(a,function(t,e){var i=p(e).thru(n.get.byType).map(function(t){return n.style.get(t)}).filter({styleType:s}).value();return t=p.union(t,i)},[])),c=this.getUniqueThemeStyleList(t,e,i),l=p.uniqBy(u,function(t){return JSON.stringify(t.style?d(t.style.properties):{})});return p.remove(l,p.bind(function(e){return p.find(c,p.bind(function(t){return this.isEqualWithoutTypeConsideration(e,t)},this))},this)),p.sortBy(l,"skin")},getUniqueThemeStyleList:function(t,e,i){var n=this.getThemedStyleForComp(t,e,i),o=p.uniqBy(n,function(t){return JSON.stringify(t.style?d(t.style.properties):{})+t.skin});return p.sortBy(o,"skin")},getUniqueThemeStyleAndCompPtrList:function(t,e,i){var n=c(0,e,i,[],"system"),o=p.uniqBy(n,function(t){return JSON.stringify(t.styleItem.style?d(t.styleItem.style.properties):{})+t.skin});return p.sortBy(o,"styleItem.skin")},getThemedStyleForComp:function(e,i,n){var t=i.getDefinition(n)?p.keys(i.getDefinition(n).styles):[];return p.map(t,p.bind(function(t){return this.getSystemStyleById(e,i,t,n)},this))},getThemedStyleAndCompPtrForComp:function(t,e,i){return c(0,e,i,[],"system")},getDuplicateToStyleList:function(t,e,i,n,o){var r=this,s=this.getUniqueThemeStyleAndCompPtrList(t,e,n),a=c(0,e,n,o,"custom"),u=s.concat(a);return p(u).reject({id:i.id}).filter(function(t){return r.isEqualWithoutTypeConsideration(t.styleItem,i)}).value()},isEqual:function(t,e){if(!t||!e)throw new Error("Style is not defined");return t.skin===e.skin&&t.styleType===e.styleType&&("system"===t.styleType?t.id===e.id:!t.style||!e.style||i(t.style.properties,e.style.properties))},isEqualWithoutTypeConsideration:function(t,e){if(!t||!e)throw new Error("Style is not defined");return t.skin===e.skin&&(!t.style||!e.style||i(t.style.properties,e.style.properties))},getCompDefStyle:function(t,e){var i=t.style||t.styleId;return p.isString(i)?this.getStyleById(e.theme,e.components,i,t.compType):i}}}),define("core/app/designManager",["lodash"],function(o){"use strict";var i={},n={};function r(t,e){return!o.isUndefined(n[t])&&!o.isUndefined(n[t][e.charas])}return{getPersonalizedDesigns:function(n,t){return o(n.components.getAllComponents()).filter(o.flow(n.components.getType,o.partial(o.includes,t))).map(function(t){return{compRef:t,design:n.components.design.get(t)}}).reject(function(t){var e=n.components.getType(t.compRef),i=t.design;return function(t){var e=(t=t||this.props.compDesign).cssStyle;return o(e).keys().every(function(t){return o.isNull(e[t])})}(i)||r(e,i)}).uniqBy("design.charas").value()},addPersonalizedDesign:function(t,e){o.isUndefined(i[t])&&(i[t]={}),i[t][e.charas]=e},removePersonalizedDesign:function(t,e){delete i[t][e.charas],o.isEmpty(i[t])&&delete i[t]},addThemePresetDesign:function(t,e){o.isUndefined(n[t])&&(n[t]={}),n[t][e.charas]=e},isThemeDesign:r}}),define("core/app/premiumServicesAPI",["coreUtilsLib","lodash","util"],function(i,c,t){"use strict";var l=0,p="http://",n=t.serviceTopology.premiumStateApiUrl;return n=n?n.replace(/wix\/getTpaPremiumState/,"premium-management/external/getDocPremiumState?siteGuid="):"//editor.wix.com/_api/premium-management/external/getDocPremiumState?siteGuid=",{getSiteDomainInfo:function(t,u,e){i.requestsUtil.fetchJson(n+t,{contentType:"application/json",credentials:"same-origin",method:"GET"}).then(function(t){var e,i,n,o,r=(e=t,c.has(e,"payload.domain.domainName")&&c.has(e,"payload.domain.checkStatus")&&e.payload.domain.checkStatus===l),s=(i=t,n=c.get(i,"payload.domain.domainName",""),c.isEmpty(n)||c.includes(n,p)||(n=p+n),c.isEmpty(n)?null:n),a=(o=t,!c.isNil(c.get(o,"payload.plan.cycle")));u({isDomainConnected:r,sitePublishedDomain:s,isSitePremium:a})}).catch(e)}}}),define("core/utils/menuUtils/tpaPages",["lodash","core/utils/pageUtils/tpaTypeUtils"],function(s,a){"use strict";function u(t,e,i){return s.includes(e,i.tpaApplicationId)&&!s.has(t,i.id)}var n={getSectionPagesDataList:function(t,e){var i,n,o=(i=t,s(e).filter(s.partial(a.isTPASpecialPage,i.dsRead)).keyBy("id").value()),r=(n=o,s(e).filter(function(t){return s.has(n,t.id)}).map("tpaApplicationId").uniq().value());return s.filter(e,s.partial(u,o,r))},getSpecialPagesDataList:function(t,e){return s.filter(e,s.partial(a.isTPASpecialPage,t.dsRead))},getSpecialPagesDataListByTPAId:function(t,e,i){return s.filter(n.getSpecialPagesDataList(t,i||t.dsRead.pages.getPagesData()),["tpaApplicationId",e])}};return n}),define("core/utils/menuUtils/blogPages",["lodash","core/utils/pageUtils/blogTypeUtils"],function(i,n){"use strict";return{getSectionPagesDataList:function(t,e){return i.filter(e,i.partial(n.isBlogSectionPage,t))},getSpecialPagesDataList:function(t,e){return i.filter(e,n.isBlogSpecialPage)}}}),define("core/utils/menuUtils/menuLogic",["lodash","core/utils/menuUtils/tpaPages","core/utils/menuUtils/blogPages","core/utils/pageUtils/blogTypeUtils","core/utils/pageUtils/tpaTypeUtils","core/utils/pageUtils/dynamicTypeUtils"],function(s,u,c,a,l,p){"use strict";var d=a.isBlog,g=l.isTPA;return{isSpecialPage:function(t,e,i){return a.isBlogSpecialPage(e)||l.isTPASpecialPage(t.dsRead,e)||(n=t,o=e,(r=i)?s.has(r,o.id):p.isDynamicPage(n,o));var n,o,r},isSubPageMenuItem:function(t,e){return this.isSpecialPage(t,e)&&!l.isPageNotVisibleInPagesMenu(t.dsRead,e)},getSectionPagesIds:function(t,e){var i=u.getSectionPagesDataList(t,e),n=c.getSectionPagesDataList(t,e);return s.union(s.map(i,"id"),s.map(n,"id"))},getSpecialPagesListBySectionPageOrBySibling:function(t,e,i){if(e){if(d(t,e))return s=t,a=i,c.getSpecialPagesDataList(s,a||s.dsRead.pages.getPagesData());if(g(e))return n=t,o=e.tpaApplicationId,r=i,u.getSpecialPagesDataListByTPAId(n,o,r)}var n,o,r,s,a;return[]}}}),define("core/utils/toolbarPositioning/toolbarPositioning",["lodash","react","reactDOM","prop-types","zepto","util","santa-editor-utils","constants","create-react-class"],function(n,o,r,t,s,a,e,u,i){"use strict";return(0,e.hoc.measuring)(i({displayName:"toolbarPositioning",propTypes:{children:t.func.isRequired,isCustomPosition:t.bool,isHidden:t.bool,initialPos:t.object.isRequired,dragRightLimit:t.number.isRequired,lastCustomXPosition:t.number,className:t.string,reportMeasurements:t.func.isRequired,measurements:t.shape({shouldCompSlideRight:t.bool,dragLimits:t.shape({x:t.arrayOf(t.number),y:t.arrayOf(t.number)}),position:t.shape({left:t.number,top:t.number})}),stageLayout:t.object},getDefaultProps:function(){return{dragRightLimit:0,initialPos:{right:0,top:0},lastCustomXPosition:null}},componentDidMount:function(){this.measureComp()},componentDidUpdate:function(){this.measureComp()},fitPositionToScreen:function(t){var e=r.findDOMNode(this).getBoundingClientRect(),i=e.top,n=this.props.lastCustomXPosition||e.left,o=t.x[1]-e.width;return{left:a.math.ensureWithinLimits(n,t.x[0],o),top:a.math.ensureWithinLimits(i,t.y[0],t.y[1])}},getDragLimits:function(){var t=this.props.stageLayout,e=u.PANELS.PANEL_SIZE_TO_KEEP_IN_VIEW,i=r.findDOMNode(this).clientHeight;return{x:[t.left+this.props.dragRightLimit,t.right-this.props.dragRightLimit],y:[t.top+this.props.dragRightLimit,t.bottom+i-e]}},getComponentPosition:function(t){return this.props.isCustomPosition?this.fitPositionToScreen(t):this.props.initialPos},measureComp:function(){if(this.props.isHidden)this.props.reportMeasurements(this.props.measurements);else{var t=this.getDragLimits();this.props.reportMeasurements({shouldCompSlideRight:this.shouldSlideRight(),dragLimits:t,position:this.getComponentPosition(t)})}},shouldSlideRight:function(){var t=s(r.findDOMNode(this)),e=t.offset().left,i=t.width()/2;return s(window).width()/2<e+i},getClassNames:function(){var t=this.props.measurements.shouldCompSlideRight,e={"hide-tools":this.props.isHidden,"show-tools":!this.props.isHidden,"slide-right":t,"slide-left":!t};return n(e).keys().filter(function(t){return e[t]}).join(" ").concat(" "+this.props.className)},render:function(){var t={},e={};n.isEmpty(this.props.measurements)||(t=this.props.measurements.position,e=this.props.measurements.dragLimits);var i=this.getClassNames();return o.createElement("div",{style:t,className:i},this.props.children(e))}}))}),define("core/utils/pageUtils/pageTitleUtils",["util"],function(n){"use strict";return{generateDuplicatedTitle:function(t){var e=new RegExp(/copy\s(\d+\s|)of\s/i),i=void 0;return e.test(t)?(i=RegExp.$1?parseInt(RegExp.$1,10)+1:2,t.replace(e,"Copy "+i+" of ")):(40<(t=n.translate("Pages_Actions_Duplicate_CopyOf")+" "+t).length&&(t=t.substr(0,37)+"..."),t)},convertPageNameToUrl:function(t){var e=t.replace(/\s/g,"-");return n.validate.byInvalidCharacters(n.validationExpressions.invalidUrlCharacters)(e)?e.toLowerCase():"blank"}}}),define("core",["core/utils/addUtil","core/utils/AddPanelDragHandler","core/utils/AddPanelSectionDragHandler","core/utils/AttachHandler","core/utils/updateLayoutUtil","core/utils/layoutConstraintsUtil/LayoutConstraintsUtil","core/utils/updateDataUtil","core/utils/updatePropertiesUtil","core/utils/DragConstraintsHandler","core/utils/layoutTransitionsUtil","core/utils/SnapToHandler","core/utils/scrollUtils","core/utils/compControlsMeasurer","core/utils/fixedPositionPlugins/fixedPositionPlugins","core/utils/social","core/utils/spotifyUtils","core/utils/componentPreviewReadyPlugins/componentPreviewReadyPlugins","core/utils/compsSectionsAnalyzer","core/utils/sectionsReorganizeUtil","core/utils/pageUtils/blogTypeUtils","core/utils/pageUtils/dynamicTypeUtils","core/utils/pageUtils/tpaTypeUtils","core/utils/pageUtils/wixStoreTypeUtils","core/utils/mouseMoveActions/sectionDrag","core/utils/gridLinesUtil","core/mixins/editorAPIMixin","core/app/styleManager","core/app/designManager","core/app/premiumServicesAPI","core/utils/menuUtils/menuLogic","core/utils/toolbarPositioning/toolbarPositioning","core/utils/mediaManagerPresetUtil","core/utils/pageUtils/pageTitleUtils","core/utils/addComponentPlugins/addComponentPlugins"],function(t,e,i,n,o,r,s,a,u,c,l,p,d,g,h,m,f,y,P,v,S,C,T,I,A,x,w,R,E,D,b,O,_,M){"use strict";return{utils:{pageTitleUtils:_,menuLogic:D,addUtil:t,AddPanelDragHandler:e,AddPanelSectionDragHandler:i,AttachHandler:n,DragConstraintsHandler:u,updateLayoutUtil:o,LayoutConstraintsUtil:r,updateDataUtil:s,updatePropertiesUtil:a,layoutTransitionsUtil:c,SnapToHandler:l,scrollUtils:p,fixedPositionUtils:g,social:h,spotifyUtils:m,compControlsMeasurer:d,compsSectionsAnalyzer:y,sectionsReorganizeUtil:P,componentPreviewReadyPlugins:f,blogTypeUtils:v,dynamicTypeUtils:S,tpaTypeUtils:C,wixStoreTypeUtils:T,gridLinesUtil:A,mediaManagerPresetUtil:O,toolbarPositioning:b,sectionDrag:I,addComponentPlugins:M},mixins:{editorAPIMixin:x},styleManager:w,designManager:R,premiumServicesAPI:E}});
//# sourceMappingURL=core.min.js.map